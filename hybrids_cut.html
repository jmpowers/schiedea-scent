<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="John Powers" />

<<<<<<< HEAD
<meta name="date" content="2024-12-04" />
=======
<meta name="date" content="2025-04-23" />
>>>>>>> 27b13227da49979dfa7b2b0cafc285e7cc4f0a95

<title>Floral scent of Schiedea kaalae x hookeri hybrids</title>

<script src="libs/header-attrs-2.26/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/navigation-1.1/codefolding.js"></script>
<link href="libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Floral scent of <em>Schiedea kaalae x
hookeri</em> hybrids</h1>
<h4 class="author"><a href="http://sites.uci.edu/powers/">John
Powers</a></h4>
<<<<<<< HEAD
<h4 class="date">2024-12-04</h4>
=======
<h4 class="date">2025-04-23</h4>
>>>>>>> 27b13227da49979dfa7b2b0cafc285e7cc4f0a95

</div>


<style type="text/css">
.main-container { max-width: 1600px; margin-left: 0; margin-right: auto; }
img{ max-width:200%; height: auto; }
td, th { padding : 6px }
</style>
<pre class="r"><code>figs &lt;- list.files(&quot;./hybrids_cut_plots&quot;, pattern=&quot;.svg&quot;)
<<<<<<< HEAD
walk(figs, ~system(paste0(&quot;inkscape --export-dpi 150 -o ./hybrids_cut_plots/png/&quot;, str_replace(.x, &quot;.svg&quot;,&quot;.png&quot;), &quot; ./hybrids_cut_plots/&quot;, .x)))</code></pre>
=======
walk(figs, ~system(paste0(&quot;inkscape --export-dpi 150 -o ./hybrids_cut_plots/png/&quot;, str_replace(.x, &quot;.svg&quot;,&quot;.png&quot;), &quot; ./hybrids_cut_plots/&quot;, .x)))
walk(figs, ~system(paste0(&quot;inkscape -o ./hybrids_cut_plots/eps/&quot;, str_replace(.x, &quot;.svg&quot;,&quot;.eps&quot;), &quot; ./hybrids_cut_plots/&quot;, .x)))</code></pre>
>>>>>>> 27b13227da49979dfa7b2b0cafc285e7cc4f0a95
<pre class="r"><code>greenhouse &lt;- matrix(c(-117.8475746, 33.6472914), nrow=1) #latlong of UCI greenhouse

s &lt;- read_tsv(&quot;data/UCI_GCMS/Schiedea Volatiles Sampling - Samples.tsv&quot;) %&gt;% 
  drop_na(Start, Stop) %&gt;% #2 bad samples with no Start, 1 missing Stop in 2019
  nest(.by=SampleDate) %&gt;% #sunset function is slow, run on unique dates
  mutate(sunset = map_vec(SampleDate, 
                          ~maptools::sunriset(dateTime=ymd_hms(paste(.x, &quot;13:00:00&quot;)),
                                              direction=&quot;sunset&quot;, crds=greenhouse, POSIXct.out=T)$time),
         solarnoon = map_vec(SampleDate, 
                          ~maptools::solarnoon(dateTime=ymd_hms(paste(.x, &quot;13:00:00&quot;)),
                                              crds=greenhouse, POSIXct.out=T)$time)) %&gt;% unnest(data) %&gt;% 
  mutate(StartSunset = difftime(ymd_hms(paste(SampleDate, Start)), sunset, units=&quot;hours&quot;),
         StopSunset =  difftime(ymd_hms(paste(SampleDate, Stop)), sunset, units=&quot;hours&quot;),
         StartNoon =   difftime(ymd_hms(paste(SampleDate, Start)), solarnoon, units=&quot;hours&quot;))

CASsubs &lt;- read_tsv(&quot;data/UCI_GCMS/CASsubs3.csv&quot;) %&gt;% select(CAS, newCAS) %&gt;% deframe()

data &lt;- read_tsv(&quot;data/UCI_GCMS/svhyb_ambient_blanks.csv&quot;) %&gt;% 
  distinct() %&gt;% #generated some reports twice
  select(FileName:`Base Peak`, Weighted, Reverse) %&gt;% 
  rename(Path = FileName, Fraction = Amount, Match = Weighted) %&gt;% 
  mutate(Path = str_sub(Path, 52, -5), #remove base directory and file extension
         SampleDate = str_extract(Path, &quot;\\\\(.*)&quot;, group=1), #file name after folder
         Sample = if_else(str_sub(SampleDate, 1, 5)==&quot;BLANK&quot;, SampleDate, 
          str_extract(SampleDate, &quot;(.*?)_.*&quot;, group=1) %&gt;% #drop GC index
            #pad sample number to 3 digits with zeros
            str_replace(&quot;(\\d+)&quot;, function(x) formatC(as.integer(x), width=3, format=&quot;d&quot;, flag=&quot;0&quot;)) %&gt;% 
            str_replace(&quot;^KAHO&quot;, &quot;SKAHO&quot;)),
         CAS = str_replace(CAS, &quot;(\\d{2,7})(\\d{2})(\\d{1})$&quot;,&quot;\\1-\\2-\\3&quot;) %&gt;% #add dashes
           recode(!!!CASsubs),#manual identifications
         Name = str_remove(Name, &quot;^&gt;&quot;),
         across(c(SampleDate, Path, Model, Sample, Name, CAS), factor),
         across(c(Fraction, Purity, `Min. Abund.`), ~ as.numeric(str_remove(.x, &quot;%&quot;))/100)) %&gt;% 
  #AMDIS Base Peak only has the most common ion integrated
  #instead, multiply fractions by total peak areas from sum_chromatograms.R
  left_join(read_tsv(&quot;data/UCI_GCMS/svhyb_TICsums.csv&quot;) %&gt;% 
              mutate(SampleDate = str_extract(file, &quot;(.*).CDF&quot;, group=1))) %&gt;% 
  mutate(Area = Fraction * sumTIC)

chems.pc &lt;- read_tsv(&quot;data/UCI_GCMS/chemspc3.csv&quot;) %&gt;% select(CAS, IUPAC.Name) %&gt;% mutate(IUPAC.Name = str_replace(IUPAC.Name, &quot;~\\{(.*?)\\}&quot;, &quot;\\1&quot;))</code></pre>
<div id="filtering" class="section level1">
<h1>Filtering</h1>
<pre class="r"><code>#Load filtered scent data (includes octenol and hexenol) and metadata
# load(&quot;./data/UCI_GCMS/sdata3_hexoct.Rdata&quot;)
# TODO some red flags in the Notes column - possible wrong IDs
# sv$spec &lt;- spec
# save(sv, vol, file = &quot;./data/UCI_GCMS/sdata3_hexoct_svvol.Rdata&quot;)
load(&quot;./data/UCI_GCMS/sdata3_hexoct_svvol.Rdata&quot;)

#convert to nanograms per hour using standards for each compound class
vocs &lt;- colnames(vol)
chemsf &lt;- tibble(shortname = vocs) %&gt;%# two VOCs got renamed since table was made 
  bind_cols(read_tsv(&quot;data/UCI_GCMS/chemspc3_classes.csv&quot;)) %&gt;% 
  left_join(read_tsv(&quot;data/UCI_GCMS/multipliers.csv&quot;))
vol &lt;- sweep(vol, 2, chemsf$ngPerArea, FUN= `*`)</code></pre>
</div>
<div id="sample-inventory" class="section level1">
<h1>Sample inventory</h1>
<pre class="r"><code>eve &lt;- -2.5 #hours before sunset
hybcolr &lt;- c(`S. kaalae` = &quot;#31A354&quot;, `K x H` = &quot;#FD8D3C&quot;, `H x K` = &quot;#A65628&quot;, `S. hookeri` = &quot;#756BB1&quot;)
hyblabs &lt;- c(expression(italic(&quot;S. kaalae&quot;)),&quot;K x H&quot;, &quot;H x K&quot;, expression(italic(&quot;S. hookeri&quot;)))
renamepops &lt;- c(`879WKG` = &quot;879&quot;, WK = &quot;794&quot;, WK = &quot;866&quot;, WK = &quot;891&quot;, WK = &quot;899&quot;, #lump Waianae Kai populations
                `3587WP` = &quot;3587&quot;, `892WKG` = &quot;892&quot;, `904WPG` = &quot;904&quot;)
kahopops &lt;- unique(names(renamepops))
hybpopsp &lt;- c(K = &quot;3587WP&quot;, H = &quot;879WKG&quot;, K = &quot;881KHV&quot;, K = &quot;892WKG&quot;, K = &quot;904WPG&quot;,
              HH = &quot;HH&quot;, HK = &quot;HK&quot;, KH = &quot;KH&quot;, KK = &quot;KK&quot;, H = &quot;WK&quot;)

#Get maternal and paternal populations of crosses
kahomp &lt;- sv %&gt;% rownames_to_column() %&gt;% filter(Species == &quot;kaho&quot;) %&gt;% select(rowname, Plant) %&gt;% 
  separate(Plant, into = c(&quot;Maternal&quot;, &quot;Paternal&quot;), sep=&quot; x &quot;) %&gt;% 
  mutate(across(ends_with(&quot;aternal&quot;), ~str_split_i(.x, &quot;-&quot;, 1) %&gt;% 
                  fct_recode(!!!renamepops) %&gt;% fct_relevel(kahopops)))

#Add columns to metadata describing the plant
svhyb &lt;- sv %&gt;% rownames_to_column() %&gt;% left_join(kahomp) %&gt;% 
  mutate(specp = case_match(Population, &quot;KK&quot; ~ &quot;KAAL&quot;, &quot;HH&quot; ~ &quot;HOOK&quot;, .default=spec) %&gt;% 
           fct_relevel(c(&quot;HOOK&quot;,&quot;KAHO&quot;,&quot;KAAL&quot;)), #Split cross offspring (spec=KAHO) into parents and hybrids 
         Population2 = factor(if_else(Species == &quot;kaho&quot;, if_else(Maternal==Paternal, Maternal, &quot;Interpop&quot;), Population)),
         SpeciesR = if_else(specp==&quot;KAHO&quot;, Population, specp) %&gt;% 
           factor(levels=c(&quot;KAAL&quot;,&quot;KH&quot;,&quot;HK&quot;,&quot;HOOK&quot;)) %&gt;% 
           fct_recode(&quot;S. kaalae&quot;=&quot;KAAL&quot;, &quot;K x H&quot;=&quot;KH&quot;, &quot;H x K&quot;=&quot;HK&quot;, &quot;S. hookeri&quot;=&quot;HOOK&quot;),
         DN = factor(if_else(StartSunset &gt; eve, &quot;Night&quot;, &quot;Day&quot;)),
         Inflo = if_else(is.na(Inflo), as.character(1:n()), Inflo),
         Diurnal = if_else(is.na(Diurnal), as.character(1:n()), Diurnal),
         plants =          paste(Population, Plant, sep=&quot;-&quot;),
         plantsi =         paste(Population, Plant, Cutting, sep=&quot;-&quot;),
         plantsinflo =     paste(Population, Plant, Cutting, Inflo, sep=&quot;-&quot;),
         plantsinflodate = paste(Population, Plant, Cutting, Inflo, SampleDate, sep=&quot;-&quot;),
         parents = if_else(str_detect(plants, fixed(&quot; x &quot;)), as.character(1:n()), plants),
         ftot = rowSums(vol) / Flrs) %&gt;% 
  arrange(specp, Population)

svhybn &lt;- filter(svhyb, DN == &quot;Night&quot;)
#&quot;parents&quot; set the crosses to an integer sequence to force them not to group 
#TODO this unfortunately splits resamples of the sample cross plant into multiple &quot;parents&quot;
#TODO also, NMDS below implies these are different cross parents but they are really just the original plant in the parent generation that was used for cuttings</code></pre>
<pre class="r"><code>volhybn &lt;- vol[svhybn$rowname,] #emission rate, nanograms per hour
pavolhybn &lt;- decostand(volhybn, method = &quot;pa&quot;) #presence/absence
fvolhybn &lt;- volhybn / svhybn$Flrs #emission rate per flower

#first take the average for each infloresence
#Inflos are marked by a letter but those are reused arbitrarily across SampleDates
svhybn.inflo &lt;- bind_cols(svhybn, fvolhybn) %&gt;% 
 group_by(SpeciesR, Species, Population, Maternal, Paternal, plants, plantsi, Inflo, SampleDate) %&gt;% 
  summarize(across(all_of(vocs), mean), .groups = &quot;drop&quot;)
fvolhybn.inflo &lt;- svhybn.inflo[,vocs]

#now average infloresences by plant
#TODO temporarily got rid of parents since it was splitting multiple inflos on same plant
svhybn.plants &lt;- svhybn.inflo %&gt;% 
 group_by(SpeciesR, Species, Population, Maternal, Paternal, plants, plantsi) %&gt;% 
  summarize(across(all_of(vocs), mean), .groups = &quot;drop&quot;)
fvolhybn.plants &lt;- svhybn.plants[,vocs]</code></pre>
<div id="samples-by-cross" class="section level2">
<h2>Samples by cross</h2>
<p>There are also four 881KHV samples (not used to make crosses since
from the Ko’olaus), and two samples without populations (an HH and a
KH).</p>
<pre class="r"><code>inventory.cross &lt;- svhybn %&gt;% filter(Species == &quot;kaho&quot;) %&gt;%
  drop_na(Maternal, Paternal) %&gt;% #two samples where parent populations are unknown
  with(table(Maternal, Paternal)) 
inventory.all &lt;- inventory.cross + diag(table(svhybn$Population)[rownames(inventory.cross)])
kable(inventory.all, caption=&quot;evening samples of crosses and parents&quot;)</code></pre>
<table>
<caption>evening samples of crosses and parents</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">879WKG</th>
<th align="right">WK</th>
<th align="right">3587WP</th>
<th align="right">892WKG</th>
<th align="right">904WPG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">879WKG</td>
<td align="right">10</td>
<td align="right">2</td>
<td align="right">8</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">WK</td>
<td align="right">5</td>
<td align="right">18</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">3587WP</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">892WKG</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">904WPG</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<pre class="r"><code>#how many maternal and paternal parent plants?
mp &lt;- svhybn %&gt;% filter(Species ==&quot;kaho&quot;) %&gt;% select(Plant) %&gt;% mutate(Plant=as.character(Plant)) %&gt;%
  separate(Plant, sep=&quot; x &quot;, into = c(&quot;Maternal&quot;, &quot;Paternal&quot;)) %&gt;% 
  separate(Maternal, sep=&quot;-&quot;, into = c(&quot;MomPop&quot;, &quot;MomPlant&quot;), remove=F, extra=&quot;merge&quot;) %&gt;% 
  separate(Paternal, sep=&quot;-&quot;, into = c(&quot;DadPop&quot;, &quot;DadPlant&quot;), remove=F, extra=&quot;merge&quot;)
mp %&gt;% group_by(MomPop) %&gt;% summarize(moms=n_distinct(MomPlant)) %&gt;% kable(caption=&quot;maternal plants&quot;)</code></pre>
<table>
<caption>maternal plants</caption>
<thead>
<tr class="header">
<th align="left">MomPop</th>
<th align="right">moms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">3587</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">794</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">866</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">879</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">892</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">899</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">904</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<pre class="r"><code>mp %&gt;% group_by(DadPop) %&gt;% summarize(moms=n_distinct(DadPlant)) %&gt;% kable(caption=&quot;paternal plants&quot;)</code></pre>
<table>
<caption>paternal plants</caption>
<thead>
<tr class="header">
<th align="left">DadPop</th>
<th align="right">moms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">3587</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">794</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">866</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">879</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">892</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">899</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">904</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="resampled-plants" class="section level2">
<h2>Resampled plants</h2>
<pre class="r"><code>svhybn.inflo %&gt;% count(SpeciesR, plantsi) %&gt;% filter(n&gt;1) %&gt;% kable(caption = &quot;number of infloresences per plant&quot;)</code></pre>
<table>
<caption>number of infloresences per plant</caption>
<thead>
<tr class="header">
<th align="left">SpeciesR</th>
<th align="left">plantsi</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">S. kaalae</td>
<td align="left">881KHV-2-Self 8</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">S. kaalae</td>
<td align="left">892WKG-3-NA</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">S. kaalae</td>
<td align="left">KK-3587-15 x 904-3-218-4</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">S. kaalae</td>
<td align="left">KK-3587-15 x 904-3-218-5</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">S. kaalae</td>
<td align="left">KK-892-1 x 3587-7-120-1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">K x H</td>
<td align="left">KH-3587-7 x 879-10-1-189-3</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">H x K</td>
<td align="left">HK-794-4 x 892-3-81-5</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">H x K</td>
<td align="left">HK-794-4 x 904-5-85-4</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">H x K</td>
<td align="left">HK-879-10-1 x 3587-C-30-2</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">S. hookeri</td>
<td align="left">HH-866-2 x 879-2-2-89-6</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">S. hookeri</td>
<td align="left">WK-2-Clone 1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">S. hookeri</td>
<td align="left">WK-3-11–</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">S. hookeri</td>
<td align="left">WK-Loc 2-Clone 2</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
<div id="evening-plants-by-cross" class="section level2">
<h2>Evening plants by cross</h2>
<p>remember to add the 3 881KHV plants (not used to make crosses since
from the Ko’olaus)</p>
<p>there are also two plants from crosses without populations (HH and
KH) - added these to 879x879 and 892xWK in the inventory</p>
<pre class="r"><code>plants.cross &lt;- svhybn.plants %&gt;% filter(Species == &quot;kaho&quot;) %&gt;%
  drop_na(Maternal, Paternal) %&gt;% #two samples where parent populations are unknown
  with(table(Maternal, Paternal)) 
kable(plants.cross, caption=&quot;cross plants&quot;)</code></pre>
<table>
<caption>cross plants</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">879WKG</th>
<th align="right">WK</th>
<th align="right">3587WP</th>
<th align="right">892WKG</th>
<th align="right">904WPG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">879WKG</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">WK</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">3587WP</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">892WKG</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">904WPG</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<pre class="r"><code>plants.parent &lt;- diag(table(svhybn.plants$Population)[rownames(plants.cross)])
rownames(plants.parent) &lt;- rownames(plants.cross); colnames(plants.parent) &lt;- colnames(plants.cross)
kable(plants.parent, caption=&quot;parent plants&quot;)</code></pre>
<table>
<caption>parent plants</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">879WKG</th>
<th align="right">WK</th>
<th align="right">3587WP</th>
<th align="right">892WKG</th>
<th align="right">904WPG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">879WKG</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">WK</td>
<td align="right">0</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">3587WP</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">892WKG</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">904WPG</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="sampling-times" class="section level1">
<h1>Sampling times</h1>
<pre class="r"><code>print(&quot;night pumping times, hrs:&quot;)</code></pre>
<pre><code>[1] &quot;night pumping times, hrs:&quot;</code></pre>
<pre class="r"><code>summary(as.numeric(as.difftime(format.POSIXct(svhybn$SampleDateStart, tz=&quot;GMT+8&quot;, format=&quot;%H:%M&quot;),format=&quot;%H:%M&quot;))) #convert PDT to PST when needed</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  16.40   18.77   19.45   19.30   20.02   21.27 </code></pre>
<pre class="r"><code>print(&quot;night pumping times, hr since sunset:&quot;)</code></pre>
<pre><code>[1] &quot;night pumping times, hr since sunset:&quot;</code></pre>
<pre class="r"><code>summary(as.numeric(svhybn$StartSunset))</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 -2.434   1.196   1.895   1.702   2.482   4.545 </code></pre>
</div>
<div id="heatmap" class="section level1">
<h1>Heatmap</h1>
<pre class="r"><code>class_subs &lt;- c(&quot;Irregular terpene&quot;=&quot;Other terpenoid&quot;, &quot;Monoterpene&quot;=&quot;Monoterpenoid&quot;)
classcolr &lt;- c(Aliphatic=&quot;#BC0060&quot;,Benzenoid=&quot;#027B8C&quot;,Monoterpenoid=&quot;#5d9400&quot;,`Other terpenoid`=&quot;#E56E00&quot;, Sesquiterpene=&quot;#000000&quot;)

#1 dimensional NMDS for ordering samples in heatmap
set.seed(1)
mdshybn1 &lt;- metaMDS(decostand(fvolhybn.plants, method=&quot;hellinger&quot;),k=1,try=200, autotransform=F, trace=0)
srt &lt;- order(svhybn.plants$SpeciesR, -mdshybn1$points, decreasing=T)

#Include volatiles found in at least this many samples
mincount &lt;- 15

callback = function(hc, mat){
    sv = svd(t(mat))$v[,1]
    dend = reorder(as.dendrogram(hc), wts = sv)
    as.hclust(dend)
}
heat.mat &lt;- as.matrix(t(fvolhybn.plants[,colSums(pavolhybn)&gt;mincount][srt,]))^(1/3)
colnames(heat.mat) &lt;- rownames(fvolhybn.plants)[srt]
ph &lt;- pheatmap(heat.mat, 
         cluster_cols=F, show_colnames=F,
         clustering_method=&quot;mcquitty&quot;, clustering_distance_rows=&quot;correlation&quot;,
         clustering_callback = function(hc, ...){dendsort(hc, type=&quot;average&quot;)},
         scale=&quot;none&quot;, color=inferno(512),
         annotation_col = data.frame(Species=as.integer(svhybn.plants$SpeciesR)[srt], row.names=rownames(fvolhybn.plants)[srt]), 
         annotation_colors = list(Species=hybcolr, Class=classcolr), annotation_names_col = F,
         gaps_col = which(as.logical(diff(as.integer(svhybn.plants$SpeciesR)[srt]))),
         annotation_row = data.frame(Class=chemsf$Class %&gt;% str_remove(&quot;s$&quot;) %&gt;% recode(!!!class_subs) %&gt;% factor(), 
                                     row.names = chemsf$shortname), annotation_names_row = F,
   cellwidth = 3.5, cellheight = 14, fontsize = 10, border_color = NA, legend=F, legend_breaks=NA, annotation_legend=F, cutree_rows=5
)
downViewport(&quot;col_annotation.3-3-3-3&quot;)
middles &lt;- enframe(svhybn.plants$SpeciesR[srt]) %&gt;% mutate(name=(name-0.5)/max(name-0.5)) %&gt;% summarize(name=mean(name), .by=value) %&gt;% pull(name)
grid.text(rev(levels(svhyb$SpeciesR))[c(1,4)], x=middles[c(1,4)],y=0.57, gp=gpar(fontsize=10, col=&quot;white&quot;, fontface=4))
grid.text(rev(levels(svhyb$SpeciesR))[c(2,3)], x=middles[c(2,3)],y=0.57, gp=gpar(fontsize=10, col=&quot;white&quot;, fontface=2))</code></pre>
<p><img src="hybrids_cut_plots/heatmap-1.png" width="1008" /></p>
</div>
<div id="boxplots-of-each-volatile" class="section level1">
<h1>Boxplots of each volatile</h1>
<pre class="r"><code>diversity_vars &lt;- c(ftot = &quot;Total volatile emissions (ng/flr/hr)&quot;, 
                    num_compounds=&quot;Number of compounds&quot;, 
                    shannon=&quot;Shannon diversity index&quot;)
svhybn.plants$ftot &lt;- rowSums(fvolhybn.plants)
svhybn.plants$num_compounds &lt;- rowSums(decostand(fvolhybn.plants, method=&quot;pa&quot;))
svhybn.plants$shannon &lt;- diversity(fvolhybn.plants, index=&quot;shannon&quot;)

multiline &lt;- c(&quot;DMNT&quot;=&quot;(3E)-4,8-dimethylnona-1,3,7-triene&quot;,
               &quot;2,2,6-trimethylcyclohexane-\n1,4-dione&quot;=&quot;2,2,6-trimethylcyclohexane-1,4-dione&quot;,
               &quot;4-hydroxy-2,6,6-trimethyl-\n3-oxocyclohexene-\n1-carbaldehyde&quot;=
                 &quot;4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde&quot;)

minprop &lt;- 0.25 #compound must occur in greater than this proportion of evening samples
fvolhybn.top &lt;- fvolhybn.plants %&gt;% 
  select(where(~sum(.x&gt;0) &gt; length(.x) * minprop)) %&gt;% 
  bind_cols(select(svhybn.plants, Species=SpeciesR, all_of(names(diversity_vars)))) %&gt;% 
  pivot_longer(!Species, names_to=&quot;variable&quot;) %&gt;% 
  mutate(variable = fct_recode(variable, !!!multiline))

#compare mean of hybrid cross directions to mean of parent species
#compare hybrid cross directions to each other
tests.glht &lt;- fvolhybn.top %&gt;% group_by(variable) %&gt;% nest() %&gt;% 
  mutate(model = map(data, ~lm(value ~ Species, data=.x)),
         emm = map(model, ~tidy(summary(emmeans(.x, specs=&quot;Species&quot;)))),
         test.direction = map(model, ~tidy(multcomp::glht(.x, linfct = multcomp::mcp(Species=c(&quot;`K x H` - `H x K` == 0&quot;))))),
         test.parmean = map(model, ~tidy(multcomp::glht(.x, linfct = multcomp::mcp(Species=c(&quot;0.5 * `K x H` + 0.5 * `H x K` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri`== 0&quot;))))))

tests.emm &lt;- tests.glht %&gt;% mutate(maximum = map_dbl(data, ~max(.x$value))) %&gt;% 
  select(variable, emm, maximum) %&gt;% unnest(emm)
tests.index &lt;- tests.emm %&gt;% 
  select(variable, Species, maximum, estimate) %&gt;% pivot_wider(names_from=Species, values_from=estimate) %&gt;% 
  mutate(par.mean = (`S. hookeri` + `S. kaalae`)/2,
         hyb.mean = (`K x H`+`H x K`)/2,
         hyb.index = if_else(`S. kaalae`&gt; `S. hookeri`, 
                             (hyb.mean -`S. hookeri`)/ `S. kaalae`, 
                             (hyb.mean -`S. kaalae`)/ `S. hookeri`))
tests.direction &lt;- tests.glht %&gt;% select(variable, test.direction) %&gt;% unnest(test.direction) %&gt;% 
  select(variable, direction.p.value = adj.p.value)
tests.parmean &lt;- tests.glht %&gt;% select(variable, test.parmean) %&gt;% unnest(test.parmean) %&gt;% 
  select(variable, parmean.p.value = adj.p.value)
boxplot.order &lt;- tests.index %&gt;% arrange(-hyb.index) %&gt;% pull(variable)
tests.all &lt;- tests.index %&gt;% left_join(tests.direction) %&gt;% left_join(tests.parmean) %&gt;%
  mutate(variable=factor(variable, levels=boxplot.order))

tests.vols &lt;- tests.all %&gt;% filter(!variable %in% names(diversity_vars)) %&gt;% 
    mutate(across(contains(&quot;p.value&quot;), ~p.adjust(.x, method=&quot;fdr&quot;)))
tests.vols %&gt;% select(-c(maximum, hyb.index)) %&gt;% mutate(variable=str_remove_all(variable, &quot;\n&quot;)) %&gt;% 
  kable(caption = &quot;tests of total emissions and diversity&quot;, digits=3)</code></pre>
<table>
<caption>tests of total emissions and diversity</caption>
<colgroup>
<col width="40%" />
<col width="6%" />
<col width="4%" />
<col width="4%" />
<col width="7%" />
<col width="6%" />
<col width="6%" />
<col width="12%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">variable</th>
<th align="right">S. kaalae</th>
<th align="right">K x H</th>
<th align="right">H x K</th>
<th align="right">S. hookeri</th>
<th align="right">par.mean</th>
<th align="right">hyb.mean</th>
<th align="right">direction.p.value</th>
<th align="right">parmean.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">benzaldehyde</td>
<td align="right">0.079</td>
<td align="right">0.033</td>
<td align="right">0.041</td>
<td align="right">0.311</td>
<td align="right">0.195</td>
<td align="right">0.037</td>
<td align="right">0.915</td>
<td align="right">0.001</td>
</tr>
<tr class="even">
<td align="left">octan-3-one</td>
<td align="right">0.454</td>
<td align="right">0.839</td>
<td align="right">1.183</td>
<td align="right">0.709</td>
<td align="right">0.581</td>
<td align="right">1.011</td>
<td align="right">0.398</td>
<td align="right">0.084</td>
</tr>
<tr class="odd">
<td align="left">4-oxoisophorone</td>
<td align="right">0.132</td>
<td align="right">0.003</td>
<td align="right">0.009</td>
<td align="right">0.000</td>
<td align="right">0.066</td>
<td align="right">0.006</td>
<td align="right">0.884</td>
<td align="right">0.017</td>
</tr>
<tr class="even">
<td align="left">indole</td>
<td align="right">0.002</td>
<td align="right">0.031</td>
<td align="right">0.016</td>
<td align="right">0.137</td>
<td align="right">0.070</td>
<td align="right">0.024</td>
<td align="right">0.634</td>
<td align="right">0.021</td>
</tr>
<tr class="odd">
<td align="left">2-phenylacetaldehyde</td>
<td align="right">0.297</td>
<td align="right">0.006</td>
<td align="right">0.004</td>
<td align="right">0.006</td>
<td align="right">0.151</td>
<td align="right">0.005</td>
<td align="right">0.994</td>
<td align="right">0.208</td>
</tr>
<tr class="even">
<td align="left">methyl 2-aminobenzoate</td>
<td align="right">0.000</td>
<td align="right">0.020</td>
<td align="right">0.005</td>
<td align="right">0.086</td>
<td align="right">0.043</td>
<td align="right">0.012</td>
<td align="right">0.588</td>
<td align="right">0.086</td>
</tr>
<tr class="odd">
<td
align="left">4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde</td>
<td align="right">0.027</td>
<td align="right">0.001</td>
<td align="right">0.001</td>
<td align="right">0.001</td>
<td align="right">0.014</td>
<td align="right">0.001</td>
<td align="right">0.989</td>
<td align="right">0.031</td>
</tr>
<tr class="even">
<td align="left">DMNT</td>
<td align="right">0.001</td>
<td align="right">0.000</td>
<td align="right">0.006</td>
<td align="right">0.091</td>
<td align="right">0.046</td>
<td align="right">0.003</td>
<td align="right">0.856</td>
<td align="right">0.024</td>
</tr>
<tr class="odd">
<td align="left">2,2,6-trimethylcyclohexane-1,4-dione</td>
<td align="right">0.056</td>
<td align="right">0.000</td>
<td align="right">0.001</td>
<td align="right">0.000</td>
<td align="right">0.028</td>
<td align="right">0.001</td>
<td align="right">0.976</td>
<td align="right">0.006</td>
</tr>
<tr class="even">
<td align="left">propylcyclopropane</td>
<td align="right">0.022</td>
<td align="right">0.041</td>
<td align="right">0.013</td>
<td align="right">0.088</td>
<td align="right">0.055</td>
<td align="right">0.027</td>
<td align="right">0.544</td>
<td align="right">0.317</td>
</tr>
<tr class="odd">
<td align="left">3,5,5-trimethylhex-2-ene</td>
<td align="right">0.003</td>
<td align="right">0.085</td>
<td align="right">0.146</td>
<td align="right">0.190</td>
<td align="right">0.097</td>
<td align="right">0.116</td>
<td align="right">0.514</td>
<td align="right">0.738</td>
</tr>
<tr class="even">
<td align="left">unknown benzenoid</td>
<td align="right">0.003</td>
<td align="right">0.046</td>
<td align="right">0.032</td>
<td align="right">0.240</td>
<td align="right">0.121</td>
<td align="right">0.039</td>
<td align="right">0.840</td>
<td align="right">0.047</td>
</tr>
<tr class="odd">
<td align="left">oct-1-en-3-ol</td>
<td align="right">3.202</td>
<td align="right">6.101</td>
<td align="right">6.170</td>
<td align="right">3.506</td>
<td align="right">3.354</td>
<td align="right">6.135</td>
<td align="right">0.974</td>
<td align="right">0.033</td>
</tr>
<tr class="even">
<td align="left">linalool oxide (pyranoid) ketone</td>
<td align="right">4.956</td>
<td align="right">2.194</td>
<td align="right">2.972</td>
<td align="right">0.086</td>
<td align="right">2.521</td>
<td align="right">2.583</td>
<td align="right">0.452</td>
<td align="right">0.921</td>
</tr>
<tr class="odd">
<td align="left">linalool oxide (pyranoid)</td>
<td align="right">4.035</td>
<td align="right">0.288</td>
<td align="right">0.427</td>
<td align="right">0.024</td>
<td align="right">2.030</td>
<td align="right">0.358</td>
<td align="right">0.856</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">(E)-hex-3-enal</td>
<td align="right">0.000</td>
<td align="right">0.027</td>
<td align="right">0.090</td>
<td align="right">0.279</td>
<td align="right">0.140</td>
<td align="right">0.059</td>
<td align="right">0.459</td>
<td align="right">0.121</td>
</tr>
<tr class="odd">
<td align="left">linalool oxide (furanoid)</td>
<td align="right">2.134</td>
<td align="right">0.257</td>
<td align="right">0.326</td>
<td align="right">0.020</td>
<td align="right">1.077</td>
<td align="right">0.292</td>
<td align="right">0.841</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">hexanal</td>
<td align="right">0.595</td>
<td align="right">0.322</td>
<td align="right">0.489</td>
<td align="right">0.805</td>
<td align="right">0.700</td>
<td align="right">0.406</td>
<td align="right">0.428</td>
<td align="right">0.023</td>
</tr>
<tr class="odd">
<td align="left">(E)-hex-2-enal</td>
<td align="right">0.000</td>
<td align="right">0.037</td>
<td align="right">0.050</td>
<td align="right">0.355</td>
<td align="right">0.178</td>
<td align="right">0.043</td>
<td align="right">0.886</td>
<td align="right">0.014</td>
</tr>
<tr class="even">
<td align="left">linalool</td>
<td align="right">0.041</td>
<td align="right">0.001</td>
<td align="right">0.046</td>
<td align="right">0.020</td>
<td align="right">0.031</td>
<td align="right">0.024</td>
<td align="right">0.282</td>
<td align="right">0.784</td>
</tr>
<tr class="odd">
<td align="left">(Z)-hex-3-en-1-ol</td>
<td align="right">0.053</td>
<td align="right">1.238</td>
<td align="right">2.377</td>
<td align="right">5.913</td>
<td align="right">2.983</td>
<td align="right">1.807</td>
<td align="right">0.565</td>
<td align="right">0.330</td>
</tr>
<tr class="even">
<td align="left">heptane-2,3-dione</td>
<td align="right">0.003</td>
<td align="right">0.237</td>
<td align="right">0.158</td>
<td align="right">0.392</td>
<td align="right">0.198</td>
<td align="right">0.198</td>
<td align="right">0.524</td>
<td align="right">1.000</td>
</tr>
<tr class="odd">
<td align="left">α-phellandrene</td>
<td align="right">0.355</td>
<td align="right">0.033</td>
<td align="right">0.020</td>
<td align="right">0.016</td>
<td align="right">0.185</td>
<td align="right">0.027</td>
<td align="right">0.922</td>
<td align="right">0.043</td>
</tr>
<tr class="even">
<td align="left">p-cymene</td>
<td align="right">0.075</td>
<td align="right">0.002</td>
<td align="right">0.005</td>
<td align="right">0.013</td>
<td align="right">0.044</td>
<td align="right">0.004</td>
<td align="right">0.932</td>
<td align="right">0.009</td>
</tr>
</tbody>
</table>
<pre class="r"><code>emm.vols &lt;- tests.emm %&gt;% filter(!variable %in% names(diversity_vars)) 

signif.num &lt;- function(x) {
   cut(x, breaks = c(0, 0.001, 0.01, 0.05, 1), 
           labels = c(&quot;***&quot;, &quot;**&quot;, &quot;*&quot;, &quot; &quot;), include.lowest = T)
}
fvolhybn.top %&gt;% mutate(variable=factor(variable, levels=boxplot.order)) %&gt;% 
  filter(!variable %in% names(diversity_vars)) %&gt;% 
  ggplot() +  geom_boxplot(aes(x=Species, y=value, color=Species), width=0.5, outlier.size=1) + 
  geom_text(data=tests.vols, aes(label=signif.num(parmean.p.value), x=2.5, y=pmax(par.mean,hyb.mean)*1.5)) + 
  geom_point(data=emm.vols, aes(x=Species, y=pmax(estimate,0), color=Species), shape=4, size=2)+
  geom_point(data=tests.vols, aes(x=2.5, y=par.mean, shape=&quot;parmean&quot;), size=2)+
  geom_point(data=tests.vols, aes(x=2.5, y=hyb.mean, shape=&quot;hybmean&quot;), size=2)+
  scale_shape_manual(&quot;Mean&quot;,values=c(parmean=3, hybmean=5), labels=c(parmean=&quot;Species&quot;, hybmean=&quot;Hybrids&quot;))+
  facet_wrap(vars(variable), scales=&quot;free_y&quot;, ncol=4, labeller = labeller(variable = label_wrap_gen(18))) +
  scale_color_manual(&quot;&quot;, values=hybcolr, labels=hyblabs) +
  scale_y_sqrt(&quot;Emission rate (ng/flower/hr)&quot;, limits=c(0,NA)) + theme_minimal() + 
  theme(axis.text.x=element_blank(), axis.title.x=element_blank(), 
        panel.grid.major.x=element_blank(), panel.grid.minor.y=element_blank(), legend.position = &quot;top&quot;)</code></pre>
<p><img src="hybrids_cut_plots/boxplots-1.svg" width="864" /></p>
<div id="hybrid-additivity-vs.-differences-between-parents"
class="section level2">
<h2>Hybrid additivity vs. differences between parents</h2>
<pre class="r"><code>library(ggrepel)
vol_floor &lt;- 1e-5 #avoid negative estimates, 10x less than smallest positive estimate
tests.vols %&gt;%  mutate(lfc_species = log2(pmax(`S. kaalae`,vol_floor)/pmax(`S. hookeri`,vol_floor)), 
                       lfc_hybrids = log2(hyb.mean/par.mean)) %&gt;% ungroup() %&gt;% 
  left_join(chemsf %&gt;% mutate(variable=fct_recode(Name, !!!multiline))) %&gt;% 
  mutate(Class = Class %&gt;% str_remove(&quot;s$&quot;) %&gt;% recode(!!!class_subs) %&gt;% factor()) %&gt;% 
  ggplot(aes(x=lfc_species, y=lfc_hybrids, color=Class)) + 
  geom_vline(xintercept=0, color=&quot;grey40&quot;) + geom_hline(yintercept=0, color=&quot;grey40&quot;) + 
  geom_point(aes(shape = parmean.p.value &lt; 0.05), size=2.5) + scale_shape_manual(values=c(1,19), guide=&quot;none&quot;)+
  geom_text_repel(aes(label=variable), size=3.5, min.segment.length=5, show.legend = F)  +
  scale_color_manual(values=classcolr) +
  scale_x_continuous(expand=expansion(c(0.1, 0.25)))+ 
  theme_minimal() + theme(panel.grid.minor = element_blank(), legend.position = &quot;top&quot;) +
  labs(x=&quot;log2 fold change in emissions between parents (S. kaalae / S. hookeri)&quot;,
       y=&quot;log2 fold change in emissions between hybrids and mean of parents&quot;,color=&quot;&quot;)</code></pre>
<p><img src="hybrids_cut_plots/hyb_combo-1.svg" width="672" /></p>
</div>
</div>
<div id="total-emissions-and-diversity" class="section level1">
<h1>Total emissions and diversity</h1>
<pre class="r"><code>tests.diversity &lt;- tests.all %&gt;% filter(variable %in% names(diversity_vars)) %&gt;% 
    mutate(across(contains(&quot;p.value&quot;), ~p.adjust(.x, method=&quot;fdr&quot;))) 
tests.diversity %&gt;% select(-c(maximum, hyb.index)) %&gt;% kable(caption = &quot;tests of total emissions and diversity&quot;, digits=3)</code></pre>
<table>
<caption>tests of total emissions and diversity</caption>
<colgroup>
<col width="13%" />
<col width="9%" />
<col width="6%" />
<col width="6%" />
<col width="10%" />
<col width="8%" />
<col width="8%" />
<col width="17%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">variable</th>
<th align="right">S. kaalae</th>
<th align="right">K x H</th>
<th align="right">H x K</th>
<th align="right">S. hookeri</th>
<th align="right">par.mean</th>
<th align="right">hyb.mean</th>
<th align="right">direction.p.value</th>
<th align="right">parmean.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ftot</td>
<td align="right">17.036</td>
<td align="right">12.131</td>
<td align="right">15.204</td>
<td align="right">15.147</td>
<td align="right">16.091</td>
<td align="right">13.667</td>
<td align="right">0.555</td>
<td align="right">0.444</td>
</tr>
<tr class="even">
<td align="left">num_compounds</td>
<td align="right">18.250</td>
<td align="right">18.833</td>
<td align="right">19.524</td>
<td align="right">19.969</td>
<td align="right">19.109</td>
<td align="right">19.179</td>
<td align="right">0.696</td>
<td align="right">0.949</td>
</tr>
<tr class="odd">
<td align="left">shannon</td>
<td align="right">1.721</td>
<td align="right">1.638</td>
<td align="right">1.742</td>
<td align="right">2.016</td>
<td align="right">1.869</td>
<td align="right">1.690</td>
<td align="right">0.261</td>
<td align="right">0.002</td>
</tr>
</tbody>
</table>
<pre class="r"><code>emm.diversity &lt;- tests.emm %&gt;% filter(variable %in% names(diversity_vars)) 

fvolhybn.top %&gt;% filter(variable %in% names(diversity_vars)) %&gt;% 
  ggplot() +  geom_boxplot(aes(x=Species, y=value, color=Species), width=0.5, outlier.size=1) + 
  geom_text(data=tests.diversity, aes(label=signif.num(parmean.p.value), x=2.5, y=pmax(par.mean,hyb.mean)*1.1)) + 
  geom_point(data=emm.diversity, aes(x=Species, y=pmax(estimate,0), color=Species), shape=4, size=2)+
  geom_point(data=tests.diversity, aes(x=2.5, y=par.mean, shape=&quot;parmean&quot;), size=2)+
  geom_point(data=tests.diversity, aes(x=2.5, y=hyb.mean, shape=&quot;hybmean&quot;), size=2)+
  scale_shape_manual(&quot;Mean&quot;,values=c(parmean=3, hybmean=5), labels=c(parmean=&quot;Species&quot;, hybmean=&quot;Hybrids&quot;))+
  facet_wrap(vars(variable), scales=&quot;free_y&quot;, ncol=4, labeller = as_labeller(diversity_vars)) +
  scale_color_manual(&quot;&quot;, values=hybcolr, labels=hyblabs) + 
  scale_y_continuous(&quot;&quot;, limits=c(0,NA)) + theme_minimal() + 
  theme(axis.text.x=element_blank(), axis.title.x=element_blank(), 
        panel.grid.major.x=element_blank(), panel.grid.minor.y=element_blank(), legend.position = &quot;top&quot;)</code></pre>
<p><img src="hybrids_cut_plots/diversity-1.svg" width="624" /></p>
</div>
<div id="nmds-ordination" class="section level1">
<h1>NMDS ordination</h1>
<div id="each-sample-includes-resamples" class="section level2">
<h2>Each sample (includes resamples)</h2>
<pre class="r"><code>set.seed(1)
mdshybn &lt;- metaMDS(decostand(fvolhybn, method=&quot;hellinger&quot;),k=2,try=200, autotransform=F, trace=0)
mdshybn</code></pre>
<pre><code>
Call:
metaMDS(comm = decostand(fvolhybn, method = &quot;hellinger&quot;), k = 2,      try = 200, autotransform = F, trace = 0) 

global Multidimensional Scaling using monoMDS

Data:     decostand(fvolhybn, method = &quot;hellinger&quot;) 
Distance: bray 

Dimensions: 2 
Stress:     0.1208547 
Stress type 1, weak ties
Best solution was repeated 3 times in 20 tries
The best solution was from try 7 (random start)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on &#39;decostand(fvolhybn, method = &quot;hellinger&quot;)&#39; </code></pre>
<pre class="r"><code>hullcross &lt;- gg_ordiplot(mdshybn, groups = svhybn$plants, plot=F)$df_hull
hullparents &lt;- gg_ordiplot(mdshybn, groups = svhybn$parents, plot=F)$df_hull
hullplantsi &lt;- gg_ordiplot(mdshybn, groups = svhybn$plantsi, plot=F)$df_hull
hullplantsinflo &lt;- gg_ordiplot(mdshybn, groups = svhybn$plantsinflo, plot=F)$df_hull
hullplantsinflodate &lt;- gg_ordiplot(mdshybn, groups = svhybn$plantsinflodate, plot=F)$df_hull

obj &lt;- fortify(mdshybn)
obj$Sample &lt;- NA; obj$Sample[obj$score==&quot;sites&quot;] &lt;-  svhybn$Sample
obj &lt;- obj %&gt;% left_join(svhybn %&gt;% dplyr::select(c(Sample, SpeciesR, plants, parents, plantsi, plantsinflo, plantsinflodate, StartSunset))) %&gt;% mutate(StartSunset = as.numeric(StartSunset))
obj$occur &lt;- NA; obj$occur[obj$score==&quot;species&quot;] &lt;- colSums(pavolhybn)
obj$ftotal &lt;- NA; obj$ftotal[obj$score==&quot;species&quot;] &lt;- colSums(fvolhybn)
obj &lt;- obj %&gt;% arrange(NMDS2, NMDS1)

hybnplot &lt;- ggplot(obj, aes(x=-NMDS1, y=NMDS2)) + xlab(&quot;NMDS1&quot;) +
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=plants, color=&quot;cross&quot;), linewidth=1) +
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=parents, color=&quot;parents&quot;), linewidth=1) +
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=plantsi, color=&quot;plantsi&quot;), linewidth=1) +
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=plantsinflo, color=&quot;plantsinflo&quot;), linewidth=1) +
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=plantsinflodate, color=&quot;plantsinflodate&quot;), linewidth=1) +
  scale_color_manual(&quot;&quot;,breaks=c(&quot;plantsinflodate&quot;, &quot;plantsinflo&quot;, &quot;plantsi&quot;, &quot;parents&quot;, &quot;cross&quot;),
                     labels=   c(&quot;Bag&quot;,             &quot;Infloresence&quot;,&quot;Plant&quot;,   &quot;Clone&quot;,   &quot;Cross&quot;),
                     values=c(cross=&quot;grey80&quot;, parents=&quot;grey50&quot;, plantsi=&quot;grey20&quot;,
                              plantsinflo=&quot;goldenrod&quot;,plantsinflodate=&quot;#E41A1C&quot;,sites=&quot;white&quot;,species=NA)) +
<<<<<<< HEAD
      coord_fixed(xlim=range(obj$NMDS1[obj$score==&quot;sites&quot;])+c(-0.35,0.45), 
=======
      coord_fixed(xlim=range(obj$NMDS1[obj$score==&quot;sites&quot;])+c(-0.42,0.45), 
>>>>>>> 27b13227da49979dfa7b2b0cafc285e7cc4f0a95
                  ylim=range(obj$NMDS2[obj$score==&quot;sites&quot;])) + theme_pubr()+
    scale_x_continuous(expand=c(0,0)) +
    theme(legend.text = element_text(size=13)) + 
    guides(fill = guide_legend(override.aes = list(size=6)), color=guide_legend(override.aes=list(size=4)))

(hybplotn.spec &lt;- hybnplot + 
        scale_fill_manual(&quot;&quot;, values=hybcolr, labels=hyblabs,  na.translate=F) +
  geom_point(data=obj[obj$score==&quot;sites&quot;,], aes(fill=SpeciesR), shape=21, size=3, color=&quot;white&quot;) +
    geom_text(data=obj[obj$score==&quot;species&quot; &amp; obj$occur&gt;nrow(volhybn)*minprop,], aes(label=label), color=&quot;black&quot;, size=3.8, fontface=2) ) </code></pre>
<p><img src="hybrids_cut_plots/2dnmdsnight-1.svg" width="1008" /></p>
</div>
<div id="mean-of-each-plant" class="section level2">
<h2>Mean of each plant</h2>
<pre class="r"><code>set.seed(1)
mdshybn.mean &lt;- metaMDS(decostand(fvolhybn.plants, method=&quot;hellinger&quot;),k=2,try=100, autotransform=F, trace=0)
mdshybn.mean</code></pre>
<pre><code>
Call:
metaMDS(comm = decostand(fvolhybn.plants, method = &quot;hellinger&quot;),      k = 2, try = 100, autotransform = F, trace = 0) 

global Multidimensional Scaling using monoMDS

Data:     decostand(fvolhybn.plants, method = &quot;hellinger&quot;) 
Distance: bray 

Dimensions: 2 
Stress:     0.118831 
Stress type 1, weak ties
Best solution was repeated 2 times in 20 tries
The best solution was from try 0 (metric scaling or null solution)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on &#39;decostand(fvolhybn.plants, method = &quot;hellinger&quot;)&#39; </code></pre>
<pre class="r"><code>obj.mean &lt;- fortify(mdshybn.mean)
obj.mean$SpeciesR &lt;- factor(NA,levels=levels(svhybn.plants$SpeciesR)); obj.mean$SpeciesR[obj.mean$score==&quot;sites&quot;] &lt;-  svhybn.plants$SpeciesR
obj.mean$plants &lt;- factor(NA,levels=unique(svhybn.plants$plants)); obj.mean$plants[obj.mean$score==&quot;sites&quot;] &lt;-  svhybn.plants$plants
#obj.mean$parents &lt;- factor(NA,levels=levels(svhybn.plants$parents)); obj.mean$parents[obj.mean$score==&quot;sites&quot;] &lt;-  svhybn.plants$parents
obj.mean$occur &lt;- NA; obj.mean$occur[obj.mean$score==&quot;species&quot;] &lt;- colSums(pavolhybn)
obj.mean$ftotal &lt;- NA; obj.mean$ftotal[obj.mean$score==&quot;species&quot;] &lt;- colSums(fvolhybn.plants)
obj.mean &lt;- obj.mean %&gt;% arrange(NMDS2, NMDS1)

(hybplotn.mean.spec &lt;- 
    ggplot(obj.mean, aes(x=NMDS1, y=NMDS2)) + 
    coord_fixed(xlim=range(obj.mean$NMDS1[obj.mean$score==&quot;sites&quot;])+c(-0.55,0.1), 
                ylim=range(obj.mean$NMDS2[obj.mean$score==&quot;sites&quot;])) + 
    theme_pubr()+
    scale_x_continuous(expand=c(0,0))+
    theme(legend.text = element_text(size=13)) + 
    guides(fill = guide_legend(override.aes = list(size=6)), color=guide_legend(override.aes=list(size=4)))+
    scale_fill_manual(&quot;&quot;, values=hybcolr, labels=hyblabs,  na.translate=F) +
      scale_color_manual(&quot;&quot;,breaks=c(&quot;cross&quot;,&quot;parents&quot;), labels=c(&quot;Cross&quot;,&quot;Clone&quot;), values=c(cross=&quot;grey80&quot;)) +
    geom_path(data=obj.mean[obj.mean$score==&quot;sites&quot;,],aes(group=plants, color=&quot;cross&quot;), size=1) +
    #geom_path(data=obj.mean[obj.mean$score==&quot;sites&quot;,],aes(group=parents, color=&quot;parents&quot;), size=1) +
    geom_point(data=obj.mean[obj.mean$score==&quot;sites&quot;,], aes(fill=SpeciesR), shape=21, size=3, color=&quot;white&quot;) +
    geom_text(data=obj.mean[obj.mean$score==&quot;species&quot; &amp; obj.mean$occur&gt;nrow(volhybn)*minprop,], aes(label=label), color=&quot;black&quot;,  alpha=1, size=3.8, fontface=2) 
    ) </code></pre>
<p><img src="hybrids_cut_plots/2dnmdsnightmean-1.svg" width="1008" /></p>
</div>
<div id="direction-of-cross-permanova" class="section level2">
<h2>Direction of cross PERMANOVA</h2>
<pre class="r"><code>hybridf.plants &lt;- svhybn.plants$SpeciesR %in% c(&quot;K x H&quot;, &quot;H x K&quot;)
adonis2(decostand(fvolhybn.plants[hybridf.plants,], method=&quot;total&quot;)~ SpeciesR, data = svhybn[hybridf.plants,])</code></pre>
<pre><code>Permutation test for adonis under reduced model
Permutation: free
Number of permutations: 999

adonis2(formula = decostand(fvolhybn.plants[hybridf.plants, ], method = &quot;total&quot;) ~ SpeciesR, data = svhybn[hybridf.plants, ])
         Df SumOfSqs      R2     F Pr(&gt;F)
Model     2  0.03414 0.01556 0.237  0.979
Residual 30  2.16030 0.98444             
Total    32  2.19444 1.00000             </code></pre>
</div>
</div>
<div id="variation-at-different-levels" class="section level1">
<h1>Variation at different levels</h1>
<div id="variation-among-infloresences-within-plants"
class="section level2">
<h2>Variation among infloresences within plants</h2>
<p>To measure between-trap variation, two traps were inserted into one
bag, for two bags enclosing two infloresences on one plant (four traps
total). Average them to get a dataset of unique infloresences.</p>
<pre class="r"><code>bd.plantsi.inflo &lt;-  betadisper(vegdist(decostand(fvolhybn.inflo, method=&quot;hellinger&quot;), method=&quot;bray&quot;), 
                           group = svhybn.inflo$plantsi)
meandist.plantsi.inflo &lt;- bd.plantsi.inflo$group.distances %&gt;% enframe(name=&quot;plantsi&quot;, value=&quot;centroid_dist&quot;) %&gt;%
  left_join(count(svhybn, plantsi)) %&gt;% filter(n&gt;1)#plants with resamples
summary(meandist.plantsi.inflo$centroid_dist)</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1027  0.1327  0.1388  0.1581  0.1770  0.2716 </code></pre>
</div>
<div id="variation-among-plants-in-each-cross-type"
class="section level2">
<h2>Variation among plants in each cross type</h2>
<pre class="r"><code>#betadisper(vegdist(decostand(volhybn, method=&quot;hellinger&quot;), method=&quot;bray&quot;), group = specpn) #sample level
(bd.SpeciesR &lt;- betadisper(vegdist(decostand(fvolhybn.plants, method=&quot;hellinger&quot;), method=&quot;bray&quot;), 
                           group = svhybn.plants$SpeciesR))</code></pre>
<pre><code>
    Homogeneity of multivariate dispersions

Call: betadisper(d = vegdist(decostand(fvolhybn.plants, method =
&quot;hellinger&quot;), method = &quot;bray&quot;), group = svhybn.plants$SpeciesR)

No. of Positive Eigenvalues: 51
No. of Negative Eigenvalues: 45

Average distance to median:
 S. kaalae      K x H      H x K S. hookeri 
    0.2071     0.1944     0.2443     0.3252 

Eigenvalues for PCoA axes:
(Showing 8 of 96 eigenvalues)
 PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 
6.3652 2.3196 0.9928 0.8622 0.5520 0.4399 0.3716 0.3383 </code></pre>
<pre class="r"><code>anova(bd.SpeciesR)</code></pre>
<pre><code>Analysis of Variance Table

Response: Distances
          Df  Sum Sq  Mean Sq F value    Pr(&gt;F)    
Groups     3 0.27694 0.092312  14.847 5.644e-08 ***
Residuals 93 0.57825 0.006218                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>TukeyHSD(bd.SpeciesR)</code></pre>
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = distances ~ group, data = df)

$group
                            diff         lwr        upr     p adj
K x H-S. kaalae      -0.01268834 -0.08251652 0.05713984 0.9643323
H x K-S. kaalae       0.03713597 -0.02079667 0.09506861 0.3416208
S. hookeri-S. kaalae  0.11808392  0.06651239 0.16965545 0.0000002
H x K-K x H           0.04982431 -0.02482515 0.12447378 0.3060649
S. hookeri-K x H      0.13077226  0.06094408 0.20060044 0.0000238
S. hookeri-H x K      0.08094795  0.02301531 0.13888059 0.0023642</code></pre>
<pre class="r"><code>tibble(group=bd.SpeciesR$group, distance = bd.SpeciesR$distances) %&gt;% 
  bind_rows(bd.plantsi.inflo$distances %&gt;% enframe(value=&quot;distance&quot;) %&gt;% filter(distance!=0) %&gt;% mutate(group=&quot;within&quot;)) %&gt;%
  mutate(group = fct_relevel(group, c(levels(svhybn$SpeciesR), &quot;within&quot;))) %&gt;% 
  ggplot(aes(x=group, y=distance, color=group)) +
  geom_boxplot(outlier.shape = NA) + geom_jitter(width=0.15, height=0) + geom_vline(xintercept = 4.5) + 
  scale_color_manual(values=hybcolr, guide=&quot;none&quot;) + 
  scale_y_continuous(limits=c(0,NA), expand = expansion(c(0,0.05))) + scale_x_discrete(labels=c(hyblabs, &quot;Within plant&quot;)) + 
  theme_classic() + theme(axis.title.x=element_blank(), axis.ticks.x=element_blank()) + labs(y=&quot;Bray-Curtis distance to centroid&quot;) </code></pre>
<p><img src="hybrids_cut_plots/amongplant-1.svg" width="480" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
