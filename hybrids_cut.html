<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="John Powers" />

<meta name="date" content="2024-11-05" />

<title>Schiedea Hybrid Scent</title>

<script src="libs/header-attrs-2.26/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/navigation-1.1/codefolding.js"></script>
<link href="libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Schiedea Hybrid Scent</h1>
<h4 class="author"><a href="http://sites.uci.edu/powers/">John
Powers</a></h4>
<h4 class="date">2024-11-05</h4>

</div>


<style type="text/css">
.main-container { max-width: 1600px; margin-left: 0; margin-right: auto; }
img{ max-width:200%; height: auto; }
td, th { padding : 6px }
</style>
<p>S. kaalae, S. hookeri, and hybrids</p>
<p>#Sample Inventory By plant population (pure species) or type of
cross:</p>
<pre class="r"><code>eve &lt;- -2.5 #hours before sunset

specs &lt;- kaho &lt;- c(&quot;HOOK&quot;, &quot;KAAL&quot;,&quot;KAHO&quot;)
#191216 turned off excluding resamples - now averaging them with code
#TODO: some red flags in the Notes column - possible wrong IDs
#resamples &lt;- c(&quot;282&quot;,&quot;070&quot;,&quot;069&quot;,&quot;238&quot;,&quot;079&quot;,&quot;080&quot;,&quot;144&quot;,&quot;181&quot;,&quot;176&quot;,&quot;175&quot;) # see svdup_diel.ods, selected to maximize remaining variation in sunset time. does not filter out KAHO duplicates yet.
#updated with resamples excluded: cappar2 anova table, 
f &lt;- spec %in% specs #&amp; !(sv$Sample %in% resamples)
speca &lt;- replace(spec, sv$Population == &quot;KK&quot;, &quot;KAAL&quot;); speca &lt;- replace(speca, sv$Population == &quot;HH&quot;, &quot;HOOK&quot;)
specp &lt;- factor(speca[f], levels=c(&quot;HOOK&quot;,&quot;KAHO&quot;,&quot;KAAL&quot;))#REORDER
specscol &lt;- c(&quot;green&quot;,&quot;black&quot;,&quot;red&quot;)

#&quot;3587WP&quot; &quot;879WKG&quot; &quot;881KHV&quot; &quot;892WKG&quot; &quot;904WPG&quot; &quot;HH&quot;     &quot;HK&quot;     &quot;KH&quot;     &quot;KK&quot;     &quot;WK&quot;  
hybpopsp &lt;- c(&quot;K&quot;, &quot;H&quot;, &quot;K&quot;, &quot;K&quot;, &quot;K&quot;, &quot;HH&quot;, &quot;HK&quot;, &quot;KH&quot;, &quot;KK&quot;, &quot;H&quot;)
hybcol &lt;- c(&quot;red&quot;,&quot;green&quot;,&quot;red&quot;,&quot;red&quot;,&quot;red&quot;,&quot;darkgreen&quot;,&quot;blue&quot;,&quot;orange&quot;,&quot;magenta&quot;, &quot;green&quot;)

kahomp &lt;- data.frame(Plant=as.character(sv[sv$Species == &quot;kaho&quot;,&quot;Plant&quot;]), stringsAsFactors = F)
kahomp &lt;- colsplit(string=kahomp$Plant, pattern=&quot; x &quot;, names=c(&quot;Maternal&quot;, &quot;Paternal&quot;))
kahopops &lt;- c(&quot;879WKG&quot;, &quot;WK&quot;,&quot;3587WP&quot;,&quot;892WKG&quot;,&quot;904WPG&quot;)
kahomp &lt;- as.data.frame(apply(kahomp, c(1,2), function(x) strsplit(x, &quot;-&quot;)[[1]][1]))
kahomp &lt;- lapply(kahomp, mapvalues, from = c(&quot;794&quot;,&quot;866&quot;,&quot;891&quot;,&quot;899&quot;,&quot;879&quot;,&quot;892&quot;,&quot;904&quot;,&quot;3587&quot;), to = c(&quot;WK&quot;,&quot;WK&quot;,&quot;WK&quot;,&quot;WK&quot;,&quot;879WKG&quot;,&quot;892WKG&quot;,&quot;904WPG&quot;,&quot;3587WP&quot;))
kahomp &lt;- lapply(kahomp, factor, levels=kahopops)
sv$Population2 &lt;- sv$Population
sv[sv$Species == &quot;kaho&quot;,]$Population2 &lt;- ifelse(kahomp$Maternal==kahomp$Paternal, as.character(kahomp$Maternal), &quot;Interpop&quot;)
sv$Population2 &lt;- factor(sv$Population2)
sv$ftot &lt;- rowSums(vol)/sv$Flrs
sv$SpeciesR &lt;- ifelse(speca==&quot;KAHO&quot;,as.character(sv$Population),as.character(speca)) 
sv$SpeciesR &lt;- factor(sv$SpeciesR, levels=c(&quot;KAAL&quot;,&quot;KH&quot;,&quot;HK&quot;,&quot;HOOK&quot;))
levels(sv$SpeciesR) &lt;- c(&quot;S. kaalae&quot;, &quot;K x H&quot;, &quot;H x K&quot;, &quot;S. hookeri&quot;)
hybcolr &lt;- setNames(c(brewer.pal(3,&quot;Greens&quot;)[3],brewer.pal(9,&quot;Oranges&quot;)[5], brewer.pal(9,&quot;Set1&quot;)[7], brewer.pal(3,&quot;Purples&quot;)[3]),levels(sv$SpeciesR))
sv$Individual &lt;- with(sv, factor(paste(Species, Population, Plant, Cutting)))

volhyb &lt;- vol[f,]
volhyb &lt;- volhyb[order(as.integer(specp)),]
specp &lt;- sort(specp)
svhyb &lt;- sv[rownames(volhyb),]
volhyb &lt;- volhyb[order(as.integer(specp), svhyb$Population),]
volhyb &lt;- volhyb[,colSums(volhyb)&gt;0]
pavolhyb &lt;- volhyb
pavolhyb[pavolhyb&gt;0] &lt;-1
svolhyb &lt;- decostand(volhyb, &quot;total&quot;)

#new consolidated svhyb and svhybn code
svhyb &lt;- sv[rownames(volhyb),]
fvolhyb &lt;- volhyb / svhyb$Flrs
svhyb$Population &lt;- as.factor(svhyb$Population)
#svhyb$DN &lt;- factor(ifelse(svhyb$Start &gt; 59400, &quot;Night&quot;, &quot;Day&quot;))
#svhyb$DN &lt;- factor(ifelse(svhyb$Stop &gt; 55000, &quot;Night&quot;, &quot;Day&quot;))
svhyb$DN &lt;- factor(ifelse(svhyb$StartSunset &gt; eve, &quot;Night&quot;, &quot;Day&quot;))
svhyb$Inflo[is.na(svhyb$Inflo)]&lt;-1:sum(is.na(svhyb$Inflo))
svhyb$Diurnal[is.na(svhyb$Diurnal)]&lt;-1:sum(is.na(svhyb$Diurnal))
svhyb$plants  &lt;- hybplants  &lt;- paste(svhyb$Population, svhyb$Plant, sep=&quot;-&quot;)
svhyb$plantsi &lt;- hybplantsi &lt;- paste(svhyb$Population, svhyb$Plant, svhyb$Cutting, sep=&quot;-&quot;)
svhyb$parents &lt;- hybplants
svhyb$parents[grepl(&quot; x &quot;, hybplants, fixed=T)]&lt;-1:sum(grepl(&quot; x &quot;, hybplants, fixed=T))#only group by parents, set the crosses to an integer sequence to force them not to group
hybparents &lt;- svhyb$parents
svhyb$Inflo[is.na(svhyb$Inflo)]&lt;-1:sum(is.na(svhyb$Inflo))
svhyb$Diurnal[is.na(svhyb$Diurnal)]&lt;-1:sum(is.na(svhyb$Diurnal))
svhyb$plantsdn &lt;- hybplantsdn &lt;- paste(svhyb$Population, svhyb$Plant, svhyb$Cutting, svhyb$Diurnal, sep=&quot;-&quot;)
svhyb$plantsinflo &lt;- hybplantsinflo &lt;- paste(svhyb$Population, svhyb$Plant, svhyb$Cutting, svhyb$Inflo, sep=&quot;-&quot;)
svhyb$plantsinflodate &lt;- hybplantsinflodate &lt;- paste(svhyb$Population, svhyb$Plant, svhyb$Cutting, svhyb$Inflo, svhyb$SampleDate, sep=&quot;-&quot;)

volhybn &lt;- volhyb[svhyb$DN == &quot;Night&quot;,]
specpn &lt;- specp[svhyb$DN == &quot;Night&quot;]
svolhybn &lt;- decostand(volhybn, &quot;total&quot;)

svhybn &lt;- svhyb[svhyb$DN == &quot;Night&quot;,]
fvolhybn &lt;- volhybn / svhybn$Flrs
specpd &lt;- svhybn$SpeciesR
#svhybn &lt;- sv[rownames(volhybn),]
#svhybn$Population &lt;- as.factor(svhybn$Population)
#svhybn$DN &lt;- factor(ifelse(svhybn$StartSunset &gt; eve, &quot;Night&quot;, &quot;Day&quot;))
hybplantsn &lt;- svhybn$plants #paste(svhybn$Population, svhybn$Plant, sep=&quot;-&quot;)
hybplantsin &lt;- svhybn$plantsi #paste(svhybn$Population, svhybn$Plant, svhybn$Cutting, sep=&quot;-&quot;)
hybparentsn &lt;- svhybn$parents #paste(svhybn$Population, svhybn$Plant, sep=&quot;-&quot;)
#hybparentsn[nchar(hybparentsn)&gt;9]&lt;-1:sum(nchar(hybparentsn)&gt;9)
#svhybn$Inflo[is.na(svhybn$Inflo)]&lt;-1:sum(is.na(svhybn$Inflo))
#svhybn$Diurnal[is.na(svhybn$Diurnal)]&lt;-1:sum(is.na(svhybn$Diurnal))
hybplantsdnn &lt;- svhybn$plantsdn #paste(svhybn$Population, svhybn$Plant, svhybn$Cutting, svhybn$Diurnal, sep=&quot;-&quot;)
hybplantsinflon &lt;- svhybn$plantsinflo #paste(svhybn$Population, svhybn$Plant, svhybn$Cutting, svhybn$Inflo, sep=&quot;-&quot;)
hybplantsinflodaten &lt;- svhybn$plantsinflodate #paste(svhybn$Population, svhybn$Plant, svhybn$Cutting, svhybn$Inflo, svhybn$SampleDate, sep=&quot;-&quot;)</code></pre>
<pre class="r"><code>inventory &lt;- data.frame(row.names=levels(svhyb$Population), Cross=hybpopsp, Color=hybcol,Samples=as.vector(table(svhyb$Population)))[order(hybpopsp), ]
kable(inventory)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Cross</th>
<th align="left">Color</th>
<th align="right">Samples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">879WKG</td>
<td align="left">H</td>
<td align="left">green</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">WK</td>
<td align="left">H</td>
<td align="left">green</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">HH</td>
<td align="left">HH</td>
<td align="left">darkgreen</td>
<td align="right">31</td>
</tr>
<tr class="even">
<td align="left">HK</td>
<td align="left">HK</td>
<td align="left">blue</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="left">3587WP</td>
<td align="left">K</td>
<td align="left">red</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">881KHV</td>
<td align="left">K</td>
<td align="left">red</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">892WKG</td>
<td align="left">K</td>
<td align="left">red</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">904WPG</td>
<td align="left">K</td>
<td align="left">red</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">KH</td>
<td align="left">KH</td>
<td align="left">orange</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left">KK</td>
<td align="left">KK</td>
<td align="left">magenta</td>
<td align="right">29</td>
</tr>
</tbody>
</table>
<pre class="r"><code>summary(as.numeric(as.difftime(format.POSIXct(svhyb$SampleDateStart[svhyb$DN==&quot;Night&quot;], tz=&quot;GMT+8&quot;, format=&quot;%H:%M&quot;),format=&quot;%H:%M&quot;)))#convert PDT to PST when needed</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  16.40   18.77   19.45   19.30   20.02   21.27 </code></pre>
<pre class="r"><code>#TODO no svpar
# summary(as.numeric(as.difftime(format.POSIXct(svpar$SampleDateStart[svpar$DN==&quot;Night&quot;], tz=&quot;GMT+8&quot;, format=&quot;%H:%M&quot;),format=&quot;%H:%M&quot;)))

summary(as.numeric(svhyb$StartSunset[svhyb$DN==&quot;Night&quot;]))</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 -2.434   1.196   1.895   1.702   2.482   4.545 </code></pre>
<pre class="r"><code>summary(as.numeric(svhyb$StartNoon[svhyb$DN==&quot;Day&quot;]))</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.8251  0.9418  1.2513  1.2881  1.6180  1.9347 </code></pre>
<p>Just the evening crosses samples (not plants!):</p>
<pre class="r"><code>kahomp &lt;- data.frame(Plant=svhyb[svhyb$Species == &quot;kaho&quot; &amp; svhyb$StartSunset &gt; eve,&quot;Plant&quot;])#line differs from above - just evening
kahomp &lt;- reshape2::colsplit(string=kahomp$Plant, pattern=&quot; x &quot;, names=c(&quot;Maternal&quot;, &quot;Paternal&quot;))
kahopops &lt;- c(&quot;879WKG&quot;, &quot;WK&quot;,&quot;3587WP&quot;,&quot;892WKG&quot;,&quot;904WPG&quot;)
kahomp &lt;- as.data.frame(apply(kahomp, c(1,2), function(x) strsplit(x, &quot;-&quot;)[[1]][1]))
kahomp &lt;- lapply(kahomp, mapvalues, from = c(&quot;794&quot;,&quot;866&quot;,&quot;891&quot;,&quot;899&quot;,&quot;879&quot;,&quot;892&quot;,&quot;904&quot;,&quot;3587&quot;), to = c(&quot;WK&quot;,&quot;WK&quot;,&quot;WK&quot;,&quot;WK&quot;,&quot;879WKG&quot;,&quot;892WKG&quot;,&quot;904WPG&quot;,&quot;3587WP&quot;))
kahomp &lt;- lapply(kahomp, factor, levels=kahopops)
tkahomp &lt;- table(kahomp)
t(lower.tri(tkahomp)*tkahomp)+tkahomp*upper.tri(tkahomp, diag=T)</code></pre>
<pre><code>        Maternal
Paternal 879WKG WK 3587WP 892WKG 904WPG
  879WKG      9  7     11      1      7
  WK          0  6      7      6      8
  3587WP      0  0      5      4      8
  892WKG      0  0      0      3      2
  904WPG      0  0      0      0      4</code></pre>
<pre class="r"><code>mtkahomp &lt;- 6-tkahomp
mtkahomp &lt;- as.data.frame(mtkahomp)

#crosses and parent samples (not plants) added on diagonal in the evening:
(inventory.cross &lt;- tkahomp+diag(table(svhyb$Population[svhyb$StartSunset &gt; eve])[rownames(tkahomp)]))</code></pre>
<pre><code>        Paternal
Maternal 879WKG WK 3587WP 892WKG 904WPG
  879WKG     10  2      8      1      3
  WK          5 18      4      6      6
  3587WP      3  3      9      0      6
  892WKG      0  0      4      5      1
  904WPG      4  2      2      1      6</code></pre>
<pre class="r"><code>write.csv(inventory.cross, &quot;output/hybrids/inventory_cross_parents.csv&quot;)
#remember to add the 4 881KHV samples (not used to make crosses since from the Ko&#39;olaus)
#there are also two samples without populations (HH and KH)

#how many maternal and paternal parent plants?
library(dplyr)
library(tidyr)
mp &lt;- sv %&gt;% filter(Species ==&quot;kaho&quot;) %&gt;% select(Plant) %&gt;% mutate(Plant=as.character(Plant)) %&gt;%
  separate(Plant, sep=&quot; x &quot;, into = c(&quot;Maternal&quot;, &quot;Paternal&quot;)) %&gt;% 
  separate(Maternal, sep=&quot;-&quot;, into = c(&quot;MomPop&quot;, &quot;MomPlant&quot;), remove=F, extra=&quot;merge&quot;) %&gt;% 
  separate(Paternal, sep=&quot;-&quot;, into = c(&quot;DadPop&quot;, &quot;DadPlant&quot;), remove=F, extra=&quot;merge&quot;)

mp %&gt;% group_by(MomPop) %&gt;% summarize(moms=n_distinct(MomPlant))</code></pre>
<pre><code># A tibble: 8 × 2
  MomPop  moms
  &lt;chr&gt;  &lt;int&gt;
1 3587       5
2 794        2
3 866        1
4 879        4
5 892        3
6 899        1
7 904        3
8 &lt;NA&gt;       1</code></pre>
<pre class="r"><code>mp %&gt;% group_by(DadPop) %&gt;% summarize(moms=n_distinct(DadPlant))</code></pre>
<pre><code># A tibble: 8 × 2
  DadPop  moms
  &lt;chr&gt;  &lt;int&gt;
1 3587       4
2 794        2
3 866        2
4 879        4
5 892        3
6 899        1
7 904        3
8 &lt;NA&gt;       1</code></pre>
<p>Some plants were used for more than one sample - day/night or on the
same inflorescence:</p>
<pre class="r"><code>kable(cbind(Plants=table(specp[!duplicated(cbind(specp,hybplantsi))]), table(data.frame(specp,Diurnal=svhyb$DN))))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Plants</th>
<th align="right">Day</th>
<th align="right">Night</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">HOOK</td>
<td align="right">32</td>
<td align="right">8</td>
<td align="right">36</td>
</tr>
<tr class="even">
<td align="left">KAHO</td>
<td align="right">33</td>
<td align="right">1</td>
<td align="right">41</td>
</tr>
<tr class="odd">
<td align="left">KAAL</td>
<td align="right">32</td>
<td align="right">4</td>
<td align="right">38</td>
</tr>
</tbody>
</table>
<pre class="r"><code>kable(cbind(Plants=table(svhybn$SpeciesR[!duplicated(cbind(svhybn$SpeciesR,hybplantsin))]), table(data.frame(svhybn$SpeciesR,Diurnal=svhybn$DN))))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Plants</th>
<th align="right">Day</th>
<th align="right">Night</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">S. kaalae</td>
<td align="right">32</td>
<td align="right">0</td>
<td align="right">38</td>
</tr>
<tr class="even">
<td align="left">K x H</td>
<td align="right">12</td>
<td align="right">0</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="left">H x K</td>
<td align="right">21</td>
<td align="right">0</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="left">S. hookeri</td>
<td align="right">32</td>
<td align="right">0</td>
<td align="right">36</td>
</tr>
</tbody>
</table>
<pre class="r"><code>svhybn  %&gt;% group_by(Individual) %&gt;% filter(n()&gt;1) %&gt;% ungroup() %&gt;% #find duplicates
  dplyr::select(SampleDate, Individual, ftot, Leaves:Flrs) %&gt;% arrange(Individual, SampleDate)</code></pre>
<pre><code># A tibble: 31 × 10
   SampleDate Individual     ftot Leaves Inflor Mphase Fphase Closed  Buds  Flrs
   &lt;date&gt;     &lt;fct&gt;         &lt;dbl&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 2016-08-02 hookeri WK … 3.72e5     12      2      4     22     10     9    26
 2 2017-04-10 hookeri WK … 1.39e6      2      4     12     57     23    21    33
 3 2016-08-15 hookeri WK … 6.43e6      3      2      1     14     15     7    15
 4 2017-04-10 hookeri WK … 8.45e5      1      4      6     23      8    10    37
 5 2016-08-15 hookeri WK … 8.80e5      4      4      0     35      2     9    35
 6 2017-04-10 hookeri WK … 1.64e6      2      6      4     58     35    36    29
 7 2016-08-17 kaalae 881K… 9.48e5      0      2      0     39     25    25    39
 8 2017-04-10 kaalae 881K… 1.68e6      0      3      3     18      2    47    34
 9 2016-08-17 kaalae 892W… 6.00e6      0      1      0     26     39     5    26
10 2016-08-17 kaalae 892W… 5.56e6      0      1      0     26     39     5    26
# ℹ 21 more rows</code></pre>
<pre class="r"><code>svhybn %&gt;% select(Individual, Inflo, SampleDate, Notes) %&gt;% group_by(Individual) %&gt;% filter(n()&gt;1) %&gt;% arrange(Individual, SampleDate) %&gt;% distinct(Individual) %&gt;% nrow  #%&gt;% print(n=Inf)</code></pre>
<pre><code>[1] 13</code></pre>
<pre class="r"><code>table(svhyb$Population[!duplicated(cbind(specp,hybplantsi))])</code></pre>
<pre><code>
3587WP 879WKG 881KHV 892WKG 904WPG     HH     HK     KH     KK     WK 
     4      1      3      1      2     22     21     12     22      9 </code></pre>
<p>Evening crosses plants (not samples)</p>
<pre class="r"><code>svhybn.plants &lt;- svhybn %&gt;% group_by(Species, SpeciesR, Population, Plant, Cutting, Individual) %&gt;% summarize_at(vars(ftot), mean)

kahomp.plants &lt;- data.frame(Plant=svhybn.plants[svhybn.plants$Species == &quot;kaho&quot;,&quot;Plant&quot;])
kahomp.plants &lt;- colsplit(string=kahomp.plants$Plant, pattern=&quot; x &quot;, names=c(&quot;Maternal&quot;, &quot;Paternal&quot;))
kahomp.plants &lt;- as.data.frame(apply(kahomp.plants, c(1,2), function(x) strsplit(x, &quot;-&quot;)[[1]][1]))
kahomp.plants &lt;- lapply(kahomp.plants, mapvalues, from = c(&quot;794&quot;,&quot;866&quot;,&quot;891&quot;,&quot;899&quot;,&quot;879&quot;,&quot;892&quot;,&quot;904&quot;,&quot;3587&quot;), to = c(&quot;WK&quot;,&quot;WK&quot;,&quot;WK&quot;,&quot;WK&quot;,&quot;879WKG&quot;,&quot;892WKG&quot;,&quot;904WPG&quot;,&quot;3587WP&quot;))
kahomp.plants &lt;- lapply(kahomp.plants, factor, levels=kahopops)
tkahomp.plants &lt;- table(kahomp.plants)


write.csv(tkahomp.plants, &quot;output/hybrids/inventory_cross_plants.csv&quot;)
#remember to add the 3 881KHV plants (not used to make crosses since from the Ko&#39;olaus)
#add to the diagonal these parent plants:
table(svhybn.plants$Population)[rownames(tkahomp)]</code></pre>
<pre><code>
879WKG     WK 3587WP 892WKG 904WPG 
     1      9      4      1      2 </code></pre>
<pre class="r"><code>#there are also two plants from crosses without populations (HH and KH) - added these to 879x879 and 892xWK in the inventory</code></pre>
<p>#Flowers per inflorescence Biased high due to selecting large fresh
inflorescences. Includes open flowers only.</p>
<pre class="r"><code>#species
flr &lt;- with(sv, data.frame(Flrs,Closed,Buds))

#df &lt;- gather(flr, key=Filename, specpn)
#colnames(df) &lt;- c(&quot;Filename&quot;, &quot;specpn&quot;)
#ggplot(svhybn, aes(x=specpn, y=value, fill=var))

flrpca &lt;- prcomp(flr,center=T,scale=T)
library(ggbiplot)
ggbiplot(flrpca, obs.scale = 1, var.scale = 1, groups = spec, labels=sv$Sample, ellipse = TRUE)</code></pre>
<p><img src="hybrids_cut_plots/fperi-1.svg" width="672" /></p>
<pre class="r"><code>library(beanplot)
beanplot(svhybn$Closed/as.numeric(svhybn$Inflor)~specpn, main=&quot;Closed flowers per inflorescence&quot;)</code></pre>
<p><img src="hybrids_cut_plots/fperi-2.svg" width="672" /></p>
<pre class="r"><code>with(svhybn, plot(Fphase~Closed, col=specpn))</code></pre>
<p><img src="hybrids_cut_plots/fperi-3.svg" width="672" /></p>
<pre class="r"><code>#kaho
flrhyb &lt;- with(svhyb, data.frame(Mphase,Fphase,Closed,Buds))
flrhybn &lt;- flrhyb[svhyb$DN==&quot;Night&quot;,]
flrhybpca &lt;- prcomp(log(flrhybn/svhybn$Inflor+1),center=T,scale=T)
ggbiplot(flrhybpca, obs.scale = 1, var.scale = 1, groups = specpn, ellipse = T, alpha=1, varname.size=4) + ggtitle(&quot;PCA of log flower counts per inflorescence&quot;) + scale_color_manual(values=c(3,1,2))</code></pre>
<p><img src="hybrids_cut_plots/fperi-4.svg" width="672" /></p>
<pre class="r"><code>#labels=apply(flrhybn,1,paste,collapse=&quot;:&quot;)
#labels=round(svhybn$Flrs/svhybn$Inflor)
#groups=svhybn$Population

library(PerformanceAnalytics)
chart.Correlation(log(flrhybn/svhybn$Inflor+1), histogram=T, pch=19, col=specpn, lwd=2)</code></pre>
<p><img src="hybrids_cut_plots/fperi-5.svg" width="672" /></p>
<pre class="r"><code>library(&quot;GGally&quot;)
ggpairs(flrhybn)</code></pre>
<p><img src="hybrids_cut_plots/fperi-6.svg" width="672" /></p>
<pre class="r"><code>ord &lt;- order(specpn,svhybn$Population,rowSums(flrhybn))
barplot(t(as.matrix(cbind(svhybn$Mphase,svhybn$Fphase,svhybn$Closed,svhybn$Buds)[ord,])), col=rev(c(3,6,2,4)), border=NA, names.arg=paste(specpn,svhybn$Population)[ord], col.axis=&quot;black&quot;, cex.names=0.8, axes=T, las=2, ylab=&quot;All flower types per inflorescence sampled&quot;)
legend(&quot;topleft&quot;,legend=rev(c(&quot;Male phase&quot;,&quot;Female phase&quot;, &quot;Closed&quot;, &quot;Buds&quot;)), fill=c(3,6,2,4))</code></pre>
<p><img src="hybrids_cut_plots/fperi-7.svg" width="672" /></p>
<pre class="r"><code>flrcomp &lt;- metaMDS(flrhyb, autotransform=F, trace=0)
ordiplot(flrcomp, type=&quot;n&quot;)
points(flrcomp, col=specp)</code></pre>
<p><img src="hybrids_cut_plots/fperi-8.svg" width="672" /></p>
<pre class="r"><code>adonis(decostand(flrhyb, method=&quot;total&quot;)~specp, permutations=999)</code></pre>
<pre><code>$aov.tab
Permutation: free
Number of permutations: 999

Terms added sequentially (first to last)

           Df SumsOfSqs  MeanSqs F.Model      R2 Pr(&gt;F)
specp       2    0.1339 0.066969    1.48 0.02313  0.209
Residuals 125    5.6561 0.045249         0.97687       
Total     127    5.7900                  1.00000       

$call
adonis(formula = decostand(flrhyb, method = &quot;total&quot;) ~ specp, 
    permutations = 999)

$coefficients
                   Mphase      Fphase      Closed        Buds
(Intercept)  0.0438226273  0.35280414  0.32065246  0.28272077
specp1      -0.0008879081  0.03555366 -0.01905143 -0.01561433
specp2      -0.0018252751 -0.03920149  0.00828243  0.03274434

$coef.sites
                      1           2           3           4           5
(Intercept)  0.24577185  0.27573379  0.25418148  0.21286861  0.23240545
specp1      -0.03086725 -0.03010471 -0.02917115  0.01030756 -0.02576093
specp2       0.02608145  0.02320191  0.02457837 -0.00568380  0.01767165
                      6           7           8           9          10
(Intercept)  0.25984858  0.26381543  0.25984858  0.26381543  0.26618719
specp1       0.02197692  0.01761193  0.02197692  0.01761193  0.01772424
specp2      -0.03458037 -0.03037899 -0.03458037 -0.03037899 -0.01204948
                      11          12            13          14           15
(Intercept)  0.393934829  0.20639640  0.3153064679  0.28363875  0.280507041
specp1       0.020793186  0.01032917  0.0213936771  0.01856736  0.016769471
specp2      -0.009990488 -0.01621050 -0.0009458414 -0.01053381 -0.009536547
                      16          17          18          19          20
(Intercept)  0.419204945  0.40612961 0.372270910  0.20742643  0.20876312
specp1       0.019830723  0.01747831 0.019530885 -0.01016785  0.01260320
specp2      -0.008638153 -0.02895723 0.001149243  0.01136171 -0.01858778
                     21          22          23          24          25
(Intercept)  0.22113184  0.28664307  0.23554765  0.24587350  0.25036103
specp1      -0.02579351 -0.01671425 -0.00410927 -0.02680503 -0.02524986
specp2       0.01801837  0.01228319  0.00186975  0.02618377  0.02665080
                     26          27          28          29          30
(Intercept)  0.20561979  0.22113184  0.28664307  0.23554765  0.24587350
specp1      -0.01062338 -0.02579351 -0.01671425 -0.00410927 -0.02680503
specp2       0.00566758  0.01801837  0.01228319  0.00186975  0.02618377
                     31          32           33           34          35
(Intercept)  0.25036103  0.20561979  0.322678210  0.350320689  0.21315044
specp1      -0.02524986 -0.01062338  0.021401246 -0.011520173 -0.02257018
specp2       0.02665080  0.00566758 -0.003650478  0.005097509  0.01594719
                     36          37           38          39           40
(Intercept)  0.24371708  0.43107970  0.214578375  0.22481065  0.387969791
specp1      -0.02970433 -0.03821426 -0.001102495 -0.01206469 -0.003932858
specp2       0.02749519  0.03302388  0.007470070  0.01504436 -0.004128121
                     41          42          43          44          45
(Intercept)  0.20733453  0.26957426  0.26260302  0.29977567  0.21361212
specp1      -0.01778671 -0.02801972 -0.03046504 -0.02135120  0.01220631
specp2       0.01222301  0.02612175  0.02940857  0.01231564 -0.01542111
                     46          47           48          49           50
(Intercept)  0.26981756  0.23324038  0.246605724  0.35527327  0.199689167
specp1      -0.03195719 -0.02203112 -0.009426859  0.01451133 -0.003895136
specp2       0.02593976  0.01545526  0.011602566 -0.02277201 -0.000167700
                     51          52           53          54          55
(Intercept)  0.31276699  0.27613054  0.239835320  0.23847351  0.22140991
specp1       0.01743596  0.01229716 -0.014383609  0.01603182  0.01925526
specp2      -0.01123012 -0.01785527  0.007641319 -0.01159372 -0.01961655
                      56          57          58          59           60
(Intercept)  0.206011663  0.29793866  0.32574528  0.32574528  0.278420799
specp1       0.008803405  0.02172535  0.02346974  0.02346974  0.008557783
specp2      -0.007255430 -0.03655578 -0.03993882 -0.03993882 -0.012621056
                      61           62          63          64          65
(Intercept)  0.278420799  0.356729454  0.23330687  0.23793951  0.28331649
specp1       0.008557783  0.019521579  0.01592696  0.02184470  0.01935410
specp2      -0.012621056 -0.009736505 -0.02633471 -0.02206612 -0.02964544
                      66           67           68          69          70
(Intercept)  0.236828989  0.267936075  0.348684146  0.27498554  0.21344810
specp1       0.015450205 -0.009300692  0.022246666  0.02387743  0.01318602
specp2      -0.004039378  0.021605096 -0.006198225 -0.03715290 -0.00977891
                     71            72          73          74           75
(Intercept)  0.25127531  0.2866713806  0.26858472  0.23488341  0.272448156
specp1       0.02313015 -0.0009205857 -0.02912607  0.01437155 -0.015410520
specp2      -0.02827935  0.0197503210  0.02202580 -0.02239181  0.008014801
                     76          77           78          79           80
(Intercept)  0.25370542  0.30177932  0.206266669  0.21046843  0.235153461
specp1      -0.01958782  0.02170278  0.008446503  0.01475679  0.011945523
specp2       0.02319422 -0.03270028 -0.015573260 -0.01838983 -0.001839049
                     81          82          83          84           85
(Intercept)  0.27755766  0.22232653  0.22232653  0.31737902  0.394607921
specp1       0.02146273  0.01281855  0.01281855  0.02351705  0.021058021
specp2      -0.01995529 -0.02390210 -0.02390210 -0.03807410 -0.009491388
                     86           87            88            89          90
(Intercept) 0.289939612  0.277852837  0.2780301474  0.2671899675  0.27438347
specp1      0.018727340 -0.008276326  0.0208001348  0.0002414271  0.02109692
specp2      0.002955082  0.022338137 -0.0003202567 -0.0036286699 -0.01882343
                      91          92          93          94         95
(Intercept)  0.257213330  0.24200707  0.21568309  0.41293043 0.30348298
specp1       0.006505934 -0.00766406 -0.01664736  0.01712181 0.01108326
specp2      -0.008649839  0.01936225  0.01081416 -0.02795486 0.01411199
                    96          97          98           99         100
(Intercept) 0.30348298  0.30922543  0.30922543  0.230700473  0.26981756
specp1      0.01108326  0.02020688  0.02020688 -0.009443185 -0.03195719
specp2      0.01411199 -0.02667352 -0.02667352  0.009442002  0.02593976
                    101          102          103         104        105
(Intercept)  0.23593567  0.262955186  0.217289263  0.22276491 0.33516601
specp1      -0.02652957  0.017073934  0.002742235 -0.01863088 0.01461996
specp2       0.02181778 -0.005025015 -0.008304051  0.01920190 0.00974259
                    106          107          108         109          110
(Intercept) 0.246871950  0.229482244  0.243683088 0.257038577  0.273016433
specp1      0.015388136  0.014950387 -0.003273696 0.004255134  0.021129378
specp2      0.003336279 -0.007120698  0.017210910 0.014816439 -0.001035577
                     111          112         113          114         115
(Intercept)  0.224266995  0.206904049  0.22588464 0.2062539050 0.306145666
specp1       0.001231250  0.004444804 -0.02091204 0.0001423542 0.017360584
specp2      -0.002175386 -0.009357678  0.02095717 0.0034080246 0.005266064
                     116         117          118         119         120
(Intercept)  0.198819305  0.28349666  0.275267431  0.28349666  0.34405592
specp1      -0.001142911 -0.02194454  0.018136577 -0.02194454  0.01810812
specp2      -0.000280108  0.01583292 -0.001108122  0.01583292 -0.02478903
                    121         122         123         124          125
(Intercept)  0.32524127  0.26591628  0.24254406  0.26362882  0.334557087
specp1       0.01960684  0.01940308  0.01643080  0.01611876  0.020795623
specp2      -0.02515945 -0.03227915 -0.02426662 -0.01853546 -0.004844289
                    126          127         128
(Intercept)  0.24793446  0.334557087  0.24793446
specp1      -0.01510532  0.020795623 -0.01510532
specp2       0.01303343 -0.004844289  0.01303343

$f.perms
                [,1]
   [1,]  0.576757865
   [2,]  2.066544615
   [3,]  1.646445371
   [4,]  0.626666107
   [5,]  0.684710191
   [6,]  1.088306644
   [7,]  0.356838734
   [8,]  0.801703635
   [9,]  2.729568902
  [10,]  0.017838454
  [11,]  0.608976877
  [12,]  2.811876496
  [13,]  0.308668773
  [14,]  0.162751970
  [15,]  0.780833440
  [16,]  0.654160928
  [17,]  1.936415434
  [18,]  1.471384918
  [19,]  1.700436326
  [20,]  1.051468662
  [21,]  0.480804368
  [22,]  1.558692133
  [23,]  0.908980744
  [24,]  0.802667229
  [25,]  1.247204539
  [26,]  0.408191988
  [27,]  0.506838925
  [28,]  1.976444965
  [29,]  0.378510703
  [30,]  0.663886297
  [31,]  1.659038343
  [32,]  0.311093001
  [33,]  0.396672921
  [34,]  0.385112552
  [35,]  0.676248438
  [36,]  0.320784683
  [37,]  1.076465837
  [38,]  0.299990178
  [39,]  0.608141550
  [40,]  0.320957253
  [41,]  0.755633236
  [42,]  0.187757344
  [43,]  0.614409253
  [44,]  0.447580531
  [45,]  0.311945200
  [46,]  0.547380120
  [47,]  0.249900535
  [48,]  0.513089940
  [49,]  1.611095331
  [50,]  0.446604109
  [51,]  0.269486759
  [52,]  2.061844366
  [53,]  1.392088340
  [54,]  0.362251627
  [55,]  1.709886509
  [56,]  0.543900590
  [57,]  1.119258692
  [58,]  0.396209461
  [59,]  0.874052394
  [60,]  1.548943211
  [61,]  0.673205128
  [62,]  3.202752069
  [63,]  1.572718519
  [64,]  0.158074426
  [65,]  0.161705058
  [66,]  0.952362926
  [67,]  0.876821702
  [68,]  0.522325084
  [69,]  0.308712794
  [70,]  1.163421334
  [71,]  3.829614604
  [72,]  1.512703825
  [73,]  1.594085506
  [74,]  0.836872776
  [75,]  0.539798558
  [76,]  1.122298325
  [77,]  0.507453227
  [78,]  0.311592979
  [79,]  1.930278604
  [80,]  0.762206278
  [81,]  0.996221231
  [82,]  0.449716587
  [83,]  2.013935109
  [84,]  0.591176823
  [85,]  0.449423424
  [86,]  0.849833118
  [87,]  0.462127526
  [88,] -0.113360154
  [89,]  0.304088875
  [90,]  1.771007824
  [91,]  2.106069301
  [92,]  2.111677823
  [93,]  2.232112087
  [94,]  0.451486571
  [95,]  0.439537929
  [96,]  1.192116789
  [97,]  0.070568816
  [98,]  1.076380117
  [99,]  1.433692974
 [100,]  1.924535406
 [101,]  0.522637878
 [102,] -0.008062044
 [103,]  0.153829823
 [104,]  0.756541311
 [105,]  0.449604654
 [106,]  0.971845595
 [107,]  0.531893362
 [108,]  0.351239570
 [109,]  0.795538538
 [110,]  0.857236461
 [111,]  0.223723653
 [112,]  0.561298048
 [113,]  0.505840589
 [114,]  0.464495207
 [115,]  1.671451458
 [116,]  1.229394425
 [117,]  0.617201677
 [118,]  0.231579269
 [119,]  1.188881550
 [120,]  2.394725135
 [121,]  0.202352014
 [122,]  0.608918347
 [123,]  0.920829443
 [124,]  0.958582196
 [125,]  0.790052521
 [126,]  0.204086813
 [127,]  0.583760771
 [128,]  0.866033877
 [129,]  2.829543441
 [130,]  1.318917657
 [131,]  1.482624640
 [132,]  0.331035624
 [133,]  1.144618354
 [134,]  3.460429629
 [135,]  2.562283721
 [136,]  0.406248760
 [137,]  0.450126299
 [138,]  0.478840470
 [139,]  0.206456197
 [140,]  0.977129407
 [141,]  1.658199868
 [142,]  0.266223988
 [143,]  1.488097492
 [144,]  0.665633874
 [145,]  0.457566717
 [146,]  0.123814500
 [147,]  0.410668665
 [148,]  1.862728041
 [149,]  0.034190602
 [150,]  0.209334215
 [151,]  0.524022420
 [152,]  0.081290620
 [153,]  0.682909232
 [154,]  0.209722961
 [155,]  0.652216837
 [156,]  1.205869826
 [157,]  0.667275768
 [158,]  1.347872216
 [159,]  1.072553352
 [160,]  0.223656390
 [161,]  0.121132549
 [162,]  1.859154465
 [163,]  0.675734903
 [164,]  1.722474721
 [165,]  1.370125647
 [166,]  0.549626426
 [167,]  0.662157874
 [168,]  1.122135883
 [169,]  0.818146361
 [170,]  0.705471504
 [171,] -0.072553192
 [172,]  0.692728453
 [173,]  1.324765765
 [174,]  0.270362603
 [175,]  0.599216201
 [176,]  1.308217240
 [177,]  1.000871235
 [178,]  0.300292631
 [179,]  0.583332174
 [180,]  0.222265513
 [181,]  0.527847192
 [182,]  0.360710979
 [183,]  3.830488860
 [184,]  0.985396662
 [185,]  0.644473777
 [186,]  0.657520687
 [187,]  0.291449311
 [188,]  0.946933937
 [189,]  0.753178340
 [190,]  0.899082904
 [191,]  0.616934477
 [192,]  0.754707134
 [193,]  1.673391809
 [194,]  1.057098233
 [195,]  1.628425897
 [196,]  2.390531170
 [197,]  0.086685661
 [198,]  0.546682216
 [199,]  0.256399427
 [200,]  0.983432199
 [201,]  0.273016830
 [202,]  0.986112199
 [203,]  0.962406161
 [204,]  0.707330540
 [205,]  0.500862515
 [206,]  0.460045621
 [207,]  0.464873071
 [208,]  0.701236249
 [209,]  0.289077388
 [210,]  2.807436487
 [211,]  0.476957278
 [212,]  1.842508861
 [213,]  0.978880771
 [214,]  0.718119942
 [215,]  0.858306932
 [216,]  0.048203960
 [217,]  0.834735792
 [218,]  0.675042340
 [219,]  0.910155867
 [220,]  0.740928192
 [221,]  0.338136707
 [222,]  0.453848133
 [223,] -0.050708533
 [224,]  0.847387057
 [225,]  0.523257781
 [226,]  1.517104136
 [227,]  0.947072825
 [228,]  1.628789235
 [229,]  0.709770502
 [230,]  1.342461624
 [231,]  0.651142870
 [232,]  0.695929313
 [233,]  0.339249599
 [234,]  1.188113286
 [235,]  1.381510990
 [236,]  1.889423515
 [237,]  1.730577484
 [238,]  1.441662885
 [239,]  0.763285012
 [240,]  0.318548222
 [241,]  0.702918179
 [242,]  1.229952440
 [243,]  0.956539646
 [244,]  2.242967073
 [245,]  0.351586908
 [246,]  1.243631452
 [247,]  0.199091699
 [248,]  0.629612687
 [249,]  1.648927653
 [250,]  0.962025827
 [251,]  0.980956904
 [252,]  1.142132136
 [253,]  1.154111609
 [254,]  1.124061246
 [255,]  0.885086578
 [256,]  0.508636641
 [257,]  1.393321417
 [258,]  0.637123066
 [259,]  0.178956464
 [260,]  0.340359071
 [261,]  1.270801295
 [262,]  2.661344951
 [263,]  0.294322797
 [264,]  0.340628598
 [265,] -0.053151962
 [266,]  0.095519565
 [267,]  0.993087598
 [268,]  0.004946007
 [269,]  0.776866582
 [270,]  0.819334248
 [271,]  1.516898230
 [272,]  1.182148287
 [273,]  0.429109355
 [274,]  0.360049296
 [275,]  0.498268731
 [276,]  2.272546090
 [277,]  1.132158915
 [278,]  1.322045306
 [279,]  1.773531329
 [280,]  2.059573861
 [281,]  0.327257057
 [282,]  1.139470574
 [283,]  3.629368824
 [284,]  1.289380873
 [285,]  2.430471818
 [286,]  0.619836628
 [287,]  2.643808158
 [288,]  1.202015571
 [289,]  0.339121649
 [290,]  0.684694770
 [291,]  1.694806835
 [292,]  0.615470393
 [293,]  1.299946992
 [294,]  0.646004229
 [295,]  0.573103438
 [296,]  2.802696075
 [297,]  0.216315031
 [298,]  0.479873199
 [299,]  0.947163484
 [300,]  0.791092265
 [301,]  0.869508002
 [302,]  0.775653318
 [303,]  0.270595492
 [304,]  1.844494811
 [305,]  0.645821678
 [306,]  1.637171931
 [307,]  0.734865938
 [308,]  0.280216002
 [309,]  2.131170719
 [310,]  0.581615054
 [311,]  1.105628749
 [312,]  1.113147636
 [313,]  1.069919171
 [314,]  2.664929494
 [315,]  0.914491014
 [316,]  2.269025110
 [317,]  0.647654348
 [318,]  0.384266610
 [319,]  1.748526219
 [320,]  1.395737491
 [321,]  0.771425322
 [322,]  0.523128703
 [323,]  0.607110660
 [324,]  1.414333689
 [325,]  0.384877229
 [326,]  0.451542002
 [327,]  1.263298560
 [328,]  1.886989298
 [329,]  0.253127750
 [330,]  1.566340047
 [331,]  1.958583524
 [332,]  1.308955361
 [333,] -0.053192883
 [334,]  1.633106597
 [335,]  1.252149946
 [336,]  0.241850017
 [337,]  0.658941794
 [338,]  0.748715669
 [339,]  2.342321823
 [340,]  0.179262737
 [341,]  0.467769240
 [342,] -0.139208924
 [343,]  0.345813794
 [344,]  0.555239710
 [345,]  0.936980480
 [346,]  2.629570013
 [347,]  1.198322131
 [348,]  0.448369253
 [349,]  1.513371154
 [350,]  1.086681839
 [351,]  0.508842713
 [352,]  1.276491665
 [353,]  0.902462690
 [354,]  0.223951819
 [355,]  0.307621335
 [356,]  0.447446197
 [357,]  2.176336320
 [358,]  0.556362896
 [359,]  1.070291788
 [360,]  1.318522199
 [361,]  0.692515038
 [362,]  0.588748522
 [363,]  0.216360880
 [364,]  0.380743915
 [365,]  0.304038263
 [366,]  0.527542440
 [367,]  0.143933317
 [368,]  1.314306048
 [369,]  1.471485005
 [370,]  0.918097601
 [371,]  0.200812990
 [372,]  0.252556844
 [373,]  0.545458781
 [374,]  1.206526406
 [375,]  0.882147821
 [376,]  1.013799837
 [377,]  0.321589631
 [378,]  0.868181605
 [379,]  1.235299928
 [380,]  0.817854379
 [381,]  0.867816092
 [382,]  2.103526949
 [383,]  1.683617241
 [384,]  1.540969061
 [385,]  0.821410819
 [386,]  0.447853689
 [387,]  0.745381147
 [388,]  0.813520627
 [389,]  1.149300747
 [390,]  0.808567165
 [391,]  0.830419816
 [392,]  1.473758427
 [393,]  1.094083565
 [394,]  1.776734426
 [395,]  0.600108951
 [396,]  2.663197338
 [397,]  1.666672195
 [398,]  1.100371092
 [399,]  1.053980867
 [400,]  1.045556602
 [401,]  1.657891757
 [402,]  1.342681168
 [403,]  2.126881425
 [404,]  0.396833037
 [405,]  1.036786685
 [406,]  0.474535556
 [407,]  1.520865064
 [408,]  0.403930295
 [409,]  0.417884579
 [410,]  2.096333441
 [411,]  0.841628631
 [412,]  0.616404721
 [413,]  1.728560653
 [414,]  0.956865156
 [415,]  1.189426712
 [416,]  0.276449512
 [417,]  1.114421316
 [418,]  0.715809223
 [419,]  0.665446329
 [420,]  1.474103249
 [421,]  0.638725718
 [422,]  1.419292638
 [423,]  0.592015491
 [424,]  0.579078271
 [425,]  1.353701890
 [426,]  1.695406854
 [427,]  1.059738065
 [428,]  0.596996495
 [429,]  0.895971960
 [430,]  0.357206250
 [431,]  0.900627243
 [432,]  2.126520884
 [433,]  0.779333846
 [434,]  0.784086522
 [435,]  2.670245731
 [436,]  0.287228014
 [437,]  0.708842679
 [438,]  1.099321683
 [439,]  1.123871507
 [440,]  2.293566134
 [441,]  2.027668807
 [442,]  0.717740593
 [443,]  1.085452405
 [444,]  0.604091656
 [445,]  0.160981861
 [446,]  2.641632346
 [447,]  0.635460931
 [448,]  0.834425396
 [449,]  0.630371914
 [450,]  1.537625052
 [451,]  0.792080388
 [452,]  1.442274031
 [453,]  0.485809174
 [454,]  0.703368129
 [455,]  0.845654868
 [456,] -0.025966979
 [457,]  1.012610848
 [458,]  2.258366224
 [459,]  0.236093714
 [460,]  0.573318691
 [461,]  0.521214692
 [462,]  1.229601818
 [463,]  0.580381398
 [464,]  2.709440796
 [465,]  0.268958962
 [466,]  0.804782587
 [467,]  0.589947124
 [468,]  0.876423666
 [469,]  0.715507809
 [470,]  0.389323795
 [471,]  0.788519934
 [472,]  0.700872969
 [473,]  0.982462441
 [474,]  0.641879859
 [475,]  1.083752325
 [476,]  1.413976815
 [477,]  1.495607093
 [478,]  0.456594044
 [479,]  0.488438025
 [480,]  0.373176405
 [481,]  0.469221306
 [482,]  0.929311952
 [483,]  0.608799170
 [484,]  2.448862234
 [485,]  0.416726728
 [486,]  1.280205573
 [487,]  0.279557573
 [488,]  1.094291948
 [489,]  4.405092793
 [490,]  0.987146246
 [491,]  2.572143104
 [492,]  1.115904661
 [493,]  0.776188200
 [494,]  0.285085356
 [495,]  0.320509814
 [496,]  0.425322972
 [497,]  1.391904413
 [498,]  0.587812633
 [499,]  1.621671457
 [500,]  0.627335449
 [501,]  1.016015442
 [502,]  1.874862331
 [503,]  1.410852912
 [504,]  0.889643907
 [505,]  0.664484729
 [506,]  1.283344080
 [507,]  0.502917369
 [508,]  0.310060279
 [509,]  2.232703201
 [510,]  0.912700331
 [511,]  1.176182400
 [512,]  0.751061426
 [513,]  0.386721367
 [514,]  2.637923769
 [515,]  1.692814896
 [516,]  0.169579495
 [517,]  0.517180239
 [518,]  0.590259430
 [519,]  2.129726517
 [520,]  0.290787517
 [521,]  0.594960982
 [522,]  0.959931285
 [523,]  1.087197125
 [524,]  0.915948096
 [525,]  0.102443694
 [526,]  2.217283476
 [527,]  0.183159801
 [528,]  0.842681183
 [529,]  0.743804006
 [530,]  1.668223010
 [531,]  1.720413491
 [532,]  0.821752192
 [533,]  0.929781099
 [534,]  3.416573568
 [535,]  1.725996381
 [536,]  1.022691380
 [537,]  2.269641389
 [538,]  0.804309461
 [539,]  1.016248738
 [540,]  0.325691444
 [541,]  0.454561215
 [542,]  0.672623756
 [543,]  0.188252711
 [544,]  0.589082596
 [545,]  0.296761801
 [546,]  1.962117644
 [547,]  0.804612070
 [548,]  0.572849739
 [549,]  0.984652233
 [550,]  1.257555061
 [551,]  0.974282259
 [552,]  1.016793221
 [553,]  1.084564813
 [554,]  0.897106573
 [555,]  0.678069927
 [556,]  1.300547792
 [557,]  1.159193483
 [558,]  2.837685276
 [559,]  0.627422121
 [560,]  0.033898232
 [561,]  1.207258919
 [562,]  1.880011488
 [563,]  1.189130530
 [564,]  0.735743389
 [565,]  0.259954106
 [566,]  0.858783495
 [567,]  1.716938161
 [568,]  0.158276900
 [569,]  1.811195331
 [570,]  0.238716847
 [571,]  0.633368367
 [572,]  0.976183578
 [573,]  0.912355436
 [574,]  0.619794236
 [575,]  0.743944376
 [576,]  0.878925568
 [577,]  3.424658195
 [578,]  0.110405849
 [579,]  0.323764056
 [580,]  2.606740876
 [581,]  2.580684751
 [582,]  2.592702305
 [583,]  0.171957920
 [584,]  3.896308198
 [585,]  0.588423949
 [586,]  0.580791309
 [587,]  0.834625553
 [588,]  1.232147143
 [589,]  1.697161539
 [590,]  0.629899016
 [591,]  1.161961827
 [592,]  1.180779743
 [593,]  0.988108616
 [594,]  0.284543339
 [595,]  0.447570642
 [596,]  3.545816309
 [597,]  0.382144595
 [598,]  0.846061873
 [599,]  0.274066998
 [600,]  3.129668300
 [601,]  0.413906031
 [602,]  0.154142264
 [603,]  0.889100735
 [604,]  0.671020489
 [605,]  0.728600486
 [606,]  0.872429830
 [607,]  1.043244383
 [608,]  0.263498685
 [609,]  0.339128084
 [610,]  0.945123713
 [611,]  0.745782505
 [612,]  0.496827560
 [613,]  0.983364713
 [614,]  0.397317142
 [615,]  0.482768595
 [616,]  2.154358867
 [617,]  1.016047292
 [618,]  1.008429743
 [619,] -0.205826276
 [620,]  1.973749609
 [621,]  1.241991284
 [622,]  0.096072907
 [623,]  2.834608520
 [624,]  1.004786440
 [625,]  0.350593159
 [626,]  0.665043835
 [627,]  1.144801632
 [628,]  1.203574870
 [629,]  1.689752203
 [630,]  1.308800659
 [631,]  0.696811188
 [632,]  1.377668714
 [633,]  0.213367890
 [634,]  1.543377980
 [635,]  0.246244544
 [636,]  0.585854210
 [637,]  1.085898514
 [638,]  1.474618459
 [639,]  0.315994739
 [640,]  1.593361022
 [641,]  0.678612338
 [642,]  1.023030246
 [643,]  1.176753973
 [644,]  1.307068821
 [645,]  1.637786279
 [646,]  0.828022354
 [647,]  4.170797407
 [648,] -0.016594611
 [649,]  0.509660920
 [650,]  1.819644818
 [651,]  0.441560345
 [652,]  0.380646536
 [653,]  0.257374229
 [654,]  0.514204006
 [655,]  1.758879101
 [656,]  0.651444467
 [657,]  1.829038009
 [658,]  0.402855671
 [659,]  1.071367888
 [660,]  0.436881591
 [661,]  1.928426192
 [662,]  0.172344246
 [663,]  0.418862247
 [664,]  0.268059379
 [665,]  0.885546257
 [666,]  0.254070558
 [667,]  1.548367457
 [668,]  0.776263953
 [669,]  2.131289618
 [670,]  0.627372762
 [671,]  1.259987547
 [672,]  0.942502586
 [673,]  0.523219306
 [674,]  0.115987147
 [675,]  0.787072896
 [676,]  1.155327158
 [677,]  0.876539286
 [678,]  2.937925104
 [679,]  0.531843497
 [680,]  1.047870557
 [681,]  1.135873086
 [682,]  1.285926430
 [683,]  1.611233070
 [684,]  0.366155799
 [685,]  1.188009101
 [686,]  0.694655347
 [687,]  0.212213763
 [688,]  4.662427603
 [689,]  1.524124949
 [690,]  0.852429362
 [691,]  1.530588786
 [692,]  0.763748509
 [693,]  0.921329308
 [694,]  3.024271782
 [695,]  0.667682507
 [696,]  1.097826336
 [697,]  1.264807701
 [698,]  0.666039928
 [699,]  0.117945050
 [700,]  0.639164605
 [701,]  1.039477877
 [702,]  0.387317136
 [703,]  0.605576981
 [704,]  0.653018062
 [705,]  1.572290144
 [706,]  1.949026619
 [707,]  1.201528023
 [708,]  1.164245591
 [709,]  2.809653159
 [710,]  0.820362976
 [711,]  0.630860960
 [712,]  3.133223190
 [713,]  0.411980361
 [714,]  2.409208906
 [715,]  1.482480969
 [716,]  0.928274553
 [717,]  0.710460480
 [718,]  0.979605034
 [719,]  0.830134136
 [720,]  1.121961014
 [721,]  1.206136429
 [722,]  0.788543869
 [723,]  1.193113819
 [724,]  0.510933820
 [725,]  1.119519465
 [726,]  0.904218901
 [727,]  1.975819072
 [728,]  0.759008530
 [729,]  5.054901949
 [730,]  0.717554281
 [731,]  0.539428291
 [732,]  0.549461865
 [733,]  1.231561903
 [734,]  1.656787376
 [735,]  0.323050204
 [736,]  2.354670299
 [737,]  0.320785441
 [738,]  3.225715060
 [739,]  2.808320129
 [740,]  0.827872073
 [741,]  0.614400337
 [742,]  1.030280622
 [743,]  1.466717405
 [744,]  1.075269335
 [745,]  0.434749391
 [746,]  0.568212203
 [747,]  0.174864017
 [748,]  0.625380860
 [749,]  0.846081224
 [750,]  0.304179306
 [751,]  1.244658395
 [752,]  1.080392655
 [753,]  1.716080893
 [754,]  0.258651609
 [755,]  1.719923234
 [756,]  1.166516149
 [757,]  1.710855092
 [758,]  0.877445497
 [759,]  0.613412999
 [760,]  1.011360924
 [761,]  0.457626232
 [762,]  0.537844441
 [763,]  0.598207358
 [764,]  0.861752654
 [765,]  0.120819172
 [766,]  0.280909839
 [767,]  1.294146026
 [768,]  0.432650351
 [769,]  0.682447308
 [770,]  0.677290257
 [771,]  1.834471299
 [772,]  0.569397837
 [773,]  1.725567176
 [774,]  0.790340025
 [775,]  0.705869408
 [776,]  1.847085571
 [777,]  1.083350794
 [778,]  0.353621219
 [779,]  1.106100597
 [780,]  0.046568993
 [781,]  0.927664263
 [782,]  0.245393213
 [783,]  1.513533144
 [784,]  0.467898937
 [785,]  1.848605091
 [786,]  1.001258973
 [787,]  0.254687462
 [788,]  1.292756724
 [789,]  3.353110282
 [790,]  0.985898746
 [791,]  0.505296686
 [792,]  1.624261232
 [793,]  1.322806576
 [794,]  0.364883387
 [795,]  0.483740284
 [796,]  0.640930321
 [797,]  1.684937941
 [798,]  0.332924846
 [799,]  1.549849067
 [800,]  2.313189400
 [801,]  0.674213014
 [802,]  2.874255839
 [803,]  0.654073809
 [804,]  0.225192698
 [805,]  5.406957145
 [806,]  0.308376440
 [807,]  2.244245956
 [808,]  0.266065227
 [809,]  1.154163268
 [810,]  0.618780385
 [811,]  0.375117316
 [812,]  1.481802180
 [813,]  0.531420661
 [814,]  0.376326184
 [815,]  0.847019629
 [816,]  0.813413041
 [817,]  0.129792655
 [818,]  1.040679321
 [819,]  0.500998199
 [820,]  0.698841042
 [821,]  0.554696053
 [822,]  1.351962196
 [823,]  1.357824997
 [824,]  0.970722905
 [825,]  0.594275932
 [826,]  0.954626676
 [827,]  0.890884247
 [828,]  1.049423298
 [829,]  0.635388076
 [830,]  0.170862022
 [831,]  1.480775344
 [832,]  1.136939840
 [833,]  1.133429261
 [834,]  0.974021033
 [835,]  0.876420479
 [836,]  1.237246832
 [837,]  0.405390583
 [838,]  1.014896194
 [839,]  0.436871007
 [840,]  2.060120793
 [841,]  0.592912215
 [842,]  1.404698145
 [843,]  0.466699244
 [844,]  1.078778856
 [845,]  2.378744649
 [846,]  2.091626800
 [847,]  1.139052529
 [848,]  0.420631833
 [849,]  0.452599689
 [850,]  0.882676404
 [851,]  0.207426511
 [852,]  0.223924626
 [853,]  1.259117395
 [854,]  0.922564782
 [855,]  0.470387138
 [856,]  1.067144497
 [857,]  0.445092005
 [858,]  0.341433472
 [859,]  0.697543462
 [860,]  0.144048409
 [861,]  0.461331959
 [862,]  0.227492058
 [863,]  1.716348163
 [864,]  1.080641288
 [865,]  1.397242783
 [866,]  0.981470410
 [867,]  0.805012513
 [868,]  3.088031733
 [869,]  0.913370231
 [870,]  0.336591091
 [871,]  0.177072353
 [872,]  0.260482482
 [873,]  0.422015020
 [874,]  0.463646424
 [875,]  0.823888003
 [876,]  0.460171688
 [877,]  0.514237745
 [878,]  0.255745550
 [879,]  0.741765887
 [880,]  0.878922453
 [881,]  0.201499979
 [882,]  1.838919618
 [883,]  0.557402957
 [884,]  1.057536374
 [885,]  1.256168357
 [886,]  0.983850886
 [887,]  0.384637248
 [888,]  1.309188900
 [889,]  0.131939797
 [890,]  4.157760642
 [891,]  0.154098737
 [892,]  0.998418649
 [893,]  1.569511736
 [894,]  0.542783129
 [895,]  0.810466559
 [896,]  0.743784012
 [897,]  2.075745298
 [898,]  0.566858772
 [899,]  0.706764283
 [900,]  2.764053103
 [901,]  2.192560094
 [902,]  0.332175761
 [903,]  2.220141735
 [904,]  0.830111584
 [905,]  1.093175510
 [906,]  4.678668372
 [907,]  2.098807279
 [908,]  1.069788691
 [909,]  0.627286067
 [910,]  0.101925452
 [911,]  0.294287235
 [912,]  1.637016613
 [913,]  0.843986413
 [914,]  2.721799879
 [915,]  2.644490206
 [916,]  1.794976980
 [917,]  0.917556929
 [918,]  1.963424853
 [919,]  0.774127730
 [920,]  0.043026436
 [921,]  1.064392225
 [922,]  1.610140020
 [923,]  1.877159219
 [924,]  1.862970891
 [925,]  0.871048248
 [926,]  0.515489238
 [927,]  0.159566916
 [928,]  1.240872180
 [929,]  2.141006014
 [930,]  1.141901016
 [931,]  0.968279449
 [932,]  0.424282361
 [933,]  1.159887962
 [934,]  1.335281434
 [935,]  0.639056182
 [936,]  3.592927854
 [937,]  0.415552987
 [938,]  0.901100679
 [939,]  2.101406142
 [940,]  0.950292482
 [941,]  0.464045885
 [942,]  1.339711916
 [943,]  2.148543715
 [944,]  2.144364149
 [945,]  0.550722435
 [946,]  0.076111308
 [947,]  0.120895144
 [948,]  1.754381815
 [949,]  0.521951102
 [950,]  0.196657424
 [951,]  0.940702637
 [952,]  1.067572013
 [953,]  1.502460603
 [954,]  0.469607195
 [955,]  0.714163970
 [956,]  0.178101660
 [957,]  0.173309554
 [958,]  1.695728123
 [959,]  1.628721718
 [960,]  1.453027316
 [961,]  0.156190197
 [962,]  1.403229456
 [963,]  1.119644570
 [964,]  0.254235358
 [965,]  2.235294768
 [966,]  0.439349839
 [967,]  2.399326043
 [968,]  1.226966728
 [969,]  0.722196034
 [970,]  0.320869189
 [971,]  1.531897092
 [972,] -0.026837678
 [973,]  0.221340369
 [974,]  0.425717597
 [975,]  0.317626680
 [976,]  1.261939686
 [977,]  0.230700981
 [978,]  0.966010732
 [979,]  1.012606884
 [980,]  1.102264956
 [981,]  0.789449236
 [982,]  0.863683855
 [983,]  0.631668671
 [984,]  3.048393924
 [985,]  0.671288985
 [986,]  1.221874074
 [987,]  0.259520071
 [988,]  1.390797059
 [989,]  0.599783572
 [990,]  3.025021520
 [991,]  0.958166331
 [992,]  0.993020950
 [993,]  0.233279349
 [994,]  0.545162678
 [995,]  1.182964878
 [996,]  0.991137321
 [997,]  0.332200827
 [998,]  0.678439115
 [999,]  1.835718164

$model.matrix
    (Intercept) specp1 specp2
1             1      1      0
2             1      1      0
3             1      1      0
4             1      1      0
5             1      1      0
6             1      1      0
7             1      1      0
8             1      1      0
9             1      1      0
10            1      1      0
11            1      1      0
12            1      1      0
13            1      1      0
14            1      1      0
15            1      1      0
16            1      1      0
17            1      1      0
18            1      1      0
19            1      1      0
20            1      1      0
21            1      1      0
22            1      1      0
23            1      1      0
24            1      1      0
25            1      1      0
26            1      1      0
27            1      1      0
28            1      1      0
29            1      1      0
30            1      1      0
31            1      1      0
32            1      1      0
33            1      1      0
34            1      1      0
35            1      1      0
36            1      1      0
37            1      1      0
38            1      1      0
39            1      1      0
40            1      1      0
41            1      1      0
42            1      1      0
43            1      1      0
44            1      1      0
45            1      0      1
46            1      0      1
47            1      0      1
48            1      0      1
49            1      0      1
50            1      0      1
51            1      0      1
52            1      0      1
53            1      0      1
54            1      0      1
55            1      0      1
56            1      0      1
57            1      0      1
58            1      0      1
59            1      0      1
60            1      0      1
61            1      0      1
62            1      0      1
63            1      0      1
64            1      0      1
65            1      0      1
66            1      0      1
67            1      0      1
68            1      0      1
69            1      0      1
70            1      0      1
71            1      0      1
72            1      0      1
73            1      0      1
74            1      0      1
75            1      0      1
76            1      0      1
77            1      0      1
78            1      0      1
79            1      0      1
80            1      0      1
81            1      0      1
82            1      0      1
83            1      0      1
84            1      0      1
85            1      0      1
86            1      0      1
87            1     -1     -1
88            1     -1     -1
89            1     -1     -1
90            1     -1     -1
91            1     -1     -1
92            1     -1     -1
93            1     -1     -1
94            1     -1     -1
95            1     -1     -1
96            1     -1     -1
97            1     -1     -1
98            1     -1     -1
99            1     -1     -1
100           1     -1     -1
101           1     -1     -1
102           1     -1     -1
103           1     -1     -1
104           1     -1     -1
105           1     -1     -1
106           1     -1     -1
107           1     -1     -1
108           1     -1     -1
109           1     -1     -1
110           1     -1     -1
111           1     -1     -1
112           1     -1     -1
113           1     -1     -1
114           1     -1     -1
115           1     -1     -1
116           1     -1     -1
117           1     -1     -1
118           1     -1     -1
119           1     -1     -1
120           1     -1     -1
121           1     -1     -1
122           1     -1     -1
123           1     -1     -1
124           1     -1     -1
125           1     -1     -1
126           1     -1     -1
127           1     -1     -1
128           1     -1     -1

$terms
decostand(flrhyb, method = &quot;total&quot;) ~ specp
attr(,&quot;variables&quot;)
list(decostand(flrhyb, method = &quot;total&quot;), specp)
attr(,&quot;factors&quot;)
                                    specp
decostand(flrhyb, method = &quot;total&quot;)     0
specp                                   1
attr(,&quot;term.labels&quot;)
[1] &quot;specp&quot;
attr(,&quot;order&quot;)
[1] 1
attr(,&quot;intercept&quot;)
[1] 1
attr(,&quot;response&quot;)
[1] 1
attr(,&quot;.Environment&quot;)
&lt;environment: R_GlobalEnv&gt;

attr(,&quot;class&quot;)
[1] &quot;adonis&quot;</code></pre>
<pre class="r"><code>library(ade4)
par(mfrow=c(2,2))
for(i in 1:3) {
  flr.vol &lt;- mantel.rtest(vegdist(volhybn[specpn==specs[i],]), dist(flrhybn[specpn==specs[i],]), nrepet = 999)
plot(vegdist(volhybn[specpn==specs[i],])~vegdist(flrhybn[specpn==specs[i],]), main=specs[i], 
     sub=paste(&quot;Mantel R=&quot;, round(flr.vol$obs,3),&quot; p=&quot;,flr.vol$pvalue),
     xlab=&quot;Inflorescence Euclid dist&quot;, ylab=&quot;Scent Bray dist&quot;, 
     col=alpha(4-i,0.4), xlim=c(0,0.8), ylim=c(0,1))
}

library(ade4)
flr.vol &lt;- mantel.rtest(vegdist(volhyb), vegdist(flrhyb), nrepet = 999)
print(flr.vol)</code></pre>
<pre><code>Monte-Carlo test
Call: mantelnoneuclid(m1 = m1, m2 = m2, nrepet = nrepet)

Observation: 0.06461906 

Based on 999 replicates
Simulated p-value: 0.035 
Alternative hypothesis: greater 

     Std.Obs  Expectation     Variance 
 1.959445147 -0.001133391  0.001126050 </code></pre>
<pre class="r"><code>plot(flr.vol)</code></pre>
<p><img src="hybrids_cut_plots/fperi-9.svg" width="672" /></p>
<pre class="r"><code>plot(svhyb$Flrs~svhyb$Closed, col=specp)
plot(log(svhyb$Flrs/(svhyb$Closed+1)) ~ specp)
summary(lm(log(svpar$Flrs/(svpar$Closed+1)) ~ specpar))

infloagen &lt;- log10(flrhybn$Closed/flrhybn$Fphase)
with(log(flrhybn+1), plot(mdshybn$points[,2]~(Mphase/Fphase/Buds/Closed), col=specp))

fit &lt;- lm(as.matrix(volhybn) ~ as.matrix(flrhybn))
fit &lt;- lm(as.matrix(mdshybn$points) ~ as.matrix(flrhybn))
summary(fit)

flrcap &lt;- capscale(svolhybn[specpn==&quot;HOOK&quot;,]~., data=log(flrhybn[specpn==&quot;HOOK&quot;,]+1))
flrcap &lt;- vegan::rda(svolhybn[specpn==&quot;KAAL&quot;,]~., data=log(flrhybn[specpn==&quot;KAAL&quot;,]+1))
flrcap &lt;- vegan::rda(svolhybn[specpn==&quot;KAHO&quot;,]~., data=log(flrhybn[specpn==&quot;KAHO&quot;,]+1))
flrcap
anova(flrcap)

flrrda &lt;- vegan::rda(svolhybn[specpn==&quot;HOOK&quot;,]~., data=log(flrhybn[specpn==&quot;HOOK&quot;,]+1))
flrrda &lt;- vegan::rda(svolhybn[specpn==&quot;KAAL&quot;,]~., data=log(flrhybn[specpn==&quot;KAAL&quot;,]+1))
flrrda &lt;- vegan::rda(svolhybn[specpn==&quot;KAHO&quot;,]~., data=log(flrhybn[specpn==&quot;KAHO&quot;,]+1))
flrrda
anova(flrrda)

flrcca &lt;- vegan::cca(fvolhybn[specpn==&quot;HOOK&quot;,]~., data=log(flrhybn[specpn==&quot;HOOK&quot;,]+1))
flrcca &lt;- vegan::cca(fvolhybn[specpn==&quot;KAAL&quot;,]~., data=log(flrhybn[specpn==&quot;KAAL&quot;,]+1))
flrcca &lt;- vegan::cca(fvolhybn[specpn==&quot;KAHO&quot;,]~., data=log(flrhybn[specpn==&quot;KAHO&quot;,]+1))
flrcca
plot(flrcca)
vegan:::summary.cca(flrcca)
anova(flrcca)
anova(flrcca, by=&quot;term&quot;)
anova(flrcca, by=&quot;mar&quot;)
anova(flrcca, by=&quot;axis&quot;)</code></pre>
<p>#Table of volatiles</p>
<pre class="r"><code>#####    Need to use sdata3_hexoct.Rdata to make this table - includes octenol and hexenol

### from 2dnmdspar######
minsamp &lt;- 2
cutoff &lt;- 0 #400000
volhyb.cut &lt;- volhyb[,colSums(volhyb&gt;0) &gt;= minsamp]
volhyb.cut &lt;- volhyb.cut[,colSums(volhyb.cut) &gt; cutoff]

exclude &lt;-  specp == &quot;KAHO&quot;
volpar &lt;- volhyb.cut[!exclude,]; specpar &lt;- factor(specp[!exclude]); svpar &lt;- svhyb[!exclude,];
parplantsdn &lt;- paste(svpar$Population, svpar$Plant, svpar$Cutting, svpar$Diurnal, sep=&quot;-&quot;)
hybplantsdn &lt;- paste(svhyb$Population, svhyb$Plant, svhyb$Cutting, svhyb$Diurnal, sep=&quot;-&quot;)
dim(volpar)</code></pre>
<pre><code>[1] 86 76</code></pre>
<pre class="r"><code>volparn &lt;- volpar[svpar$StartSunset &gt; eve,]
svparn &lt;- svpar[svpar$StartSunset &gt; eve,]
svparn.hist &lt;- hist(as.numeric(svparn$StartSunset), breaks=3)</code></pre>
<p><img src="hybrids_cut_plots/tabsvol-1.svg" width="672" /></p>
<pre class="r"><code>svolparn &lt;- decostand(volpar[svpar$StartSunset &gt; eve,], &quot;total&quot;)
specparn &lt;- specpar[svpar$StartSunset &gt; eve]

svdup &lt;- svpar[duplicated(paste(svpar$Individual, svpar$DN)) | duplicated(paste(svpar$Individual, svpar$DN), fromLast=TRUE),]
svdup_diel &lt;- svpar[duplicated(svpar$Individual) | duplicated(svpar$Individual, fromLast=TRUE),]
#dbls &lt;- svolhyb[,is.na(match(colnames(svolhyb), chems$Name))]
#for(i in 1:ncol(dbls)) { 
#svolhyb[,substr(colnames(dbls)[i], 1, nchar(colnames(dbls)[i])-2)] &lt;- svolhyb[,substr(colnames(dbls)[i], 1, nchar(colnames(dbls)[i])-2)]  + dbls[,i] }
#svolhyb[,colnames(dbls)] &lt;- NULL

svolhyb.mean &lt;- aggregate(. ~ specp, svolhyb, mean)[,-1]
rownames(svolhyb.mean) &lt;- levels(specp)
# library(SortableHTMLTables)
# sortable.html.table(cbind(colnames(svolhyb.mean),as.data.frame(t(round(svolhyb.mean, 3)))), &quot;svolhyb3.html&quot;)
tsvolhyb.mean &lt;- as.data.frame(t(svolhyb.mean))
tsvolhyb.chems &lt;- cbind(tsvolhyb.mean, chems[match(rownames(tsvolhyb.mean), chems$Name),])
write.table(tsvolhyb.chems, file=&quot;output/hybrids/tsvolhybchems3.csv&quot;, sep=&quot;\t&quot;, row.names=F)


volhybn.mean &lt;- aggregate(. ~ specpn, volhybn, function(x) mean(x[x&gt;0]))[,-1] #nonzero only !!!
rownames(volhybn.mean) &lt;- levels(specpn)
tvolhybn.mean &lt;- as.data.frame(t(volhybn.mean))

#TODO move this to sdata3
chems.pc.class &lt;- read.table(&quot;data/UCI_GCMS/chemspc3_classes.csv&quot;, sep=&quot;\t&quot;, header=T)
multipliers &lt;- read.table(&quot;data/UCI_GCMS/multipliers.csv&quot;, header=T, sep=&quot;\t&quot;)
ngvolhyb &lt;- volhyb * multipliers$ngPerArea[match(chems.pc.class$Class,multipliers$Class)][col(volhyb)]
ngvolhybn &lt;- volhybn * multipliers$ngPerArea[match(chems.pc.class$Class,multipliers$Class)][col(volhybn)]
ngfvolhyb &lt;- ngvolhyb / svhyb$Flrs
ngfvolhybn &lt;- ngvolhybn / svhybn$Flrs
svhybn$ngftot &lt;- rowSums(ngvolhybn)/svhybn$Flrs
ngfvolhybn.mean &lt;- aggregate(. ~ specpn, ngfvolhybn, function(x) mean(x[x&gt;0]))[,-1] #nonzero only !!!
rownames(ngfvolhybn.mean) &lt;- levels(specpn)
tngfvolhybn.mean &lt;- as.data.frame(t(ngfvolhybn.mean))

volhybn.prop &lt;- aggregate(. ~ specpn, volhybn, function(x) sum(x&gt;0)/length(x))[,-1]
rownames(volhybn.prop) &lt;- levels(specpn)
tvolhybn.prop &lt;- as.data.frame(t(volhybn.prop))

tvolhybn.chems &lt;- cbind(tvolhybn.mean, tngfvolhybn.mean, tvolhybn.prop, chems.pc[match(rownames(tvolhybn.mean), chems.pc$Name),])
write.table(tvolhybn.chems, file=&quot;output/hybrids/tvolhybnchems3_evening.csv&quot;, sep=&quot;\t&quot;, row.names=T, col.names = NA)

aggregate(rowSums(ngfvolhyb), list(svhyb$SpeciesR,svhyb$DN), function(x) c(mean(x), sd(x)))</code></pre>
<pre><code>     Group.1 Group.2       x.1       x.2
1  S. kaalae     Day 13.865748 14.853709
2      K x H     Day  3.526351        NA
3 S. hookeri     Day  8.789317  7.837918
4  S. kaalae   Night 16.675858 12.497605
5      K x H   Night 11.773781  6.935510
6      H x K   Night 15.190133 15.599766
7 S. hookeri   Night 15.159495 16.309929</code></pre>
<pre class="r"><code>#for svolparn
#dbls &lt;- svolparn[,is.na(match(colnames(svolparn), chems$Name))]
#for(i in 1:ncol(dbls)) { 
#svolparn[,substr(colnames(dbls)[i], 1, nchar(colnames(dbls)[i])-2)] &lt;- svolparn[,substr(colnames(dbls)[i], 1, nchar(colnames(dbls)[i])-2)]  + dbls[,i] }
#svolparn[,colnames(dbls)] &lt;- NULL

svolparn.mean &lt;- aggregate(. ~ specparn, svolparn, mean)[,-1]
rownames(svolparn.mean) &lt;- levels(specparn)
#library(SortableHTMLTables)
#sortable.html.table(cbind(colnames(svolparn.mean),as.data.frame(t(round(svolparn.mean, 3)))), &quot;svolparn3.html&quot;)
tsvolparn.mean &lt;- as.data.frame(t(svolparn.mean))
tsvolparn.chems &lt;- cbind(tsvolparn.mean, chems[match(rownames(tsvolparn.mean), chems$Name),])
write.table(tsvolparn.chems, file=&quot;output/hybrids/tsvolparnchems3.csv&quot;, sep=&quot;\t&quot;,  row.names=F)</code></pre>
<pre class="r"><code>library(tidyverse)
#prep GC data for Dryad
ngvolpar &lt;- volpar * multipliers$ngPerArea[match(chems.pc.class$Class,multipliers$Class)][col(volpar)]

svpar %&gt;% select(Filename, SpeciesR, Population2, plantsi, Leaves, Inflor, Mphase, Fphase, Closed, Buds, Temp, StartSunset) %&gt;% dplyr::rename(Species = SpeciesR, Population = Population2, Plant = plantsi, Bracts = Leaves) %&gt;% 
  mutate(StartSunset = round(as.numeric(StartSunset), 2),
         Temp = as.integer(Temp),
         Plant=as.integer(factor(Plant)),
         Species = str_replace(as.character(Species), &quot;S.&quot;, &quot;Schiedea&quot;),
         Population = replace_na(Population, &quot;Interpop&quot;)) %&gt;%
  arrange(Species, Population, Plant, Bracts, Inflor, Mphase, Fphase, Closed, Buds) %&gt;% 
  left_join(ngvolpar %&gt;% rownames_to_column(&quot;Filename&quot;) %&gt;% mutate_if(is.numeric, round, 2)) %&gt;% #volpar has peak areas / hr (not normalized by number of flowers)
  select(-Filename) %&gt;% 
  write_csv(&quot;output/hybrids/Schiedea_GCMS.csv&quot;) %&gt;% str</code></pre>
<pre><code>&#39;data.frame&#39;:   86 obs. of  87 variables:
 $ Species                                                  : chr  &quot;Schiedea hookeri&quot; &quot;Schiedea hookeri&quot; &quot;Schiedea hookeri&quot; &quot;Schiedea hookeri&quot; ...
 $ Population                                               : Factor w/ 7 levels &quot;3587WP&quot;,&quot;879WKG&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
 $ Plant                                                    : int  5 22 22 25 26 27 27 28 28 29 ...
 $ Bracts                                                   : int  4 12 12 19 6 16 16 13 13 10 ...
 $ Inflor                                                   : int  4 4 4 4 1 3 3 7 7 4 ...
 $ Mphase                                                   : int  3 3 3 2 3 1 1 1 1 3 ...
 $ Fphase                                                   : int  62 17 17 20 13 22 22 36 36 19 ...
 $ Closed                                                   : int  33 3 3 23 34 42 42 20 20 41 ...
 $ Buds                                                     : int  21 14 14 23 11 44 44 19 19 0 ...
 $ Temp                                                     : int  22 32 22 23 21 22 22 32 22 22 ...
 $ StartSunset                                              : num  1.32 -4.95 1.2 1.14 2.72 2.15 -4.6 -5.1 1.2 0.87 ...
 $ benzonitrile                                             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ benzaldehyde                                             : num  5.93 1.6 2.38 35.5 7.05 2.47 1.78 3.07 2.67 3.19 ...
 $ anisole                                                  : num  1.37 0 0 0 0 0 0.34 0.99 2.66 0.56 ...
 $ 1,3-diphenylpropan-2-one                                 : num  0 0 0 0.65 0 0 0 0 0 0 ...
 $ N-phenylformamide                                        : num  4.91 0 0 0 0 1.87 0 0 0 0 ...
 $ octan-3-one                                              : num  9.24 9.44 0.99 14.07 7.11 ...
 $ methyl hexanoate                                         : num  0 4.6 0 1.93 0 0 0 0 0 1.36 ...
 $ but-2-ene-1,4-diol                                       : num  0 0 0 0 0 0 0 0 0 0 ...
 $ octan-2-one                                              : num  0 0.59 0 0 0 0 0 0 0 0 ...
 $ hexan-1-ol                                               : num  0 0 0 0 0 0 0 0 0 0 ...
 $ 4-oxoisophorone                                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ 2-methylbutanoic acid                                    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ indole                                                   : num  16.12 0 0.9 0.89 3.17 ...
 $ cyclopentanone                                           : num  0 0 0 0 0 0 0 0 0 0 ...
 $ 2-phenylacetaldehyde                                     : num  0.24 0.35 0.11 0 0 0 0.09 0.21 0.23 0.3 ...
 $ β-mercene                                                : num  0 0 0 0 0 0 0 0 0 0 ...
 $ ethyl hexanoate                                          : num  0 0 0 0 0 0 0 0 1.37 0 ...
 $ methyl furan-3-carboxylate                               : num  0 5.82 1.37 0.89 0 0 0 0.66 2.84 0.67 ...
 $ methyl 2-aminobenzoate                                   : num  4.94 0 1.65 1.59 0 5.08 1.91 0 2.2 1.7 ...
 $ methyl (Z)-hex-3-enoate                                  : num  0 5.74 0 10.27 6.1 ...
 $ 2-phenylacetonitrile                                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ 4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde: num  0 0 0 0 0 0 0 0 0 0 ...
 $ rosefuran                                                : num  0 0 0 0 0 0.54 0 0 0 0 ...
 $ (Z)-pent-2-en-1-ol                                       : num  0 0 0 0.78 0.49 0 0 0 0 0 ...
 $ pent-1-en-3-one                                          : num  14.7 0 0 0 0 ...
 $ 3,7-dimethylundecane                                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ 5,7-dimethylundecane                                     : num  0 0 0 0 0 0 3.54 0 0 0 ...
 $ hept-2-enal                                              : num  0 1.89 0 0 0 0 0 0 0 0 ...
 $ 2,3,5,8-tetramethyldecane                                : num  0 0 0 0 0 0 0 0 0 0 ...
 $ (3E)-4,8-dimethylnona-1,3,7-triene                       : num  8.85 0 0 0 0 0 0 0 3.06 0.98 ...
 $ 2,2,6-trimethylcyclohexane-1,4-dione                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ 4-methyloctane                                           : num  0 0 0 0 0 0 0 0 0 0 ...
 $ methyl (E)-hex-2-enoate                                  : num  0 1.63 0 0 2.66 0 0 0 0 3.39 ...
 $ propylcyclopropane                                       : num  0 13.7 0 0 0 ...
 $ tridec-1-ene                                             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ 3,5,5-trimethylhex-2-ene                                 : num  0 3.14 0 9.15 0 ...
 $ unknown benzenoid                                        : num  17.81 0 3.88 0 0 ...
 $ 3,5-dihydroxy-6-methyl-2,3-dihydropyran-4-one            : num  2.83 0 0 0 2.26 0 0 0 0 0 ...
 $ hept-1-en-3-one                                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ cyclopentane-1,2-dione                                   : num  124.6 0 0 0 86.8 ...
 $ [(Z)-hex-3-enyl] hexanoate                               : num  0 0 0 2.87 2.82 0 0 0 0 2.6 ...
 $ [(Z)-hex-3-enyl] formate                                 : num  0 0 0.61 0 0 0 0 1.74 0 0 ...
 $ oct-1-en-3-ol                                            : num  15.74 53.73 3.07 113.91 38.24 ...
 $ linalool oxide (pyranoid) ketone                         : num  1.56 0 0.56 2.66 0 1.45 0.48 2.22 2.36 2.46 ...
 $ [(Z)-hex-3-enyl] acetate                                 : num  0 0 0 0 25 ...
 $ (E)-β-ocimene                                            : num  0 0 0 0 0 0 0 0 0 0 ...
 $ linalool oxide (pyranoid)                                : num  0 0 0 0 0 0 0 0 0 0 ...
 $ (3E,5E)-octa-1,3,5-triene                                : num  0 0 0 0 0 0 0 0 0 0 ...
 $ 3,5,5-trimethylhex-1-ene                                 : num  0 0 0 0 0 0 0 0 0 0 ...
 $ furan-3-ylmethanol                                       : num  0 0 1.4 0 0 0 0 0 0 0 ...
 $ (E)-hex-3-enal                                           : num  0 26.28 0 6.82 13 ...
 $ valencene                                                : num  0 0.15 0 0 0 0 0 0 0 0 ...
 $ 1,3-dihydro-2-benzofuran                                 : num  0 0 0 28.1 43.6 ...
 $ [(E)-hex-3-enyl] butanoate                               : num  0 0 0 1.24 1.81 0 0 0 0 3.84 ...
 $ perillene                                                : num  0 0 0 0 0.38 1.47 0 0 0 0 ...
 $ 2,6,6-trimethyloctane                                    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ (E)-hept-2-ene                                           : num  0 0 0 0 1.22 0 0 0 0 0 ...
 $ 3H-pyran-2,6-dione                                       : num  18.47 0 0 0 9.76 ...
 $ linalool oxide (furanoid)                                : num  0.5 0 0 0 0 0 0 0 0 0 ...
 $ 6-methylheptan-3-one                                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ pentyl propanoate                                        : num  0 2.11 0 0 0 0 0 0 0 0 ...
 $ 4-methylpentan-1-ol                                      : num  0 0 0 0 0 0 0 0 0 0.37 ...
 $ hexanal                                                  : num  8.8 55.75 11.98 15.93 8.28 ...
 $ (E)-hex-2-enal                                           : num  0 14.21 4.24 7.73 7.38 ...
 $ 4-methyl-1,3-thiazole                                    : num  0 0 0 0 0 0 0 0 0 1.49 ...
 $ hex-4-enyl acetate                                       : num  0 0 0 0 0 0 0 0 3.26 0 ...
 $ hept-3-ene                                               : num  0 0 0 9.45 0 4.91 0 0 1.29 0 ...
 $ linalool                                                 : num  1.24 0 0 0 0 0 0 0 0 0.52 ...
 $ 2-methylnonane                                           : num  0 0 0 0 0 3.06 0 0.68 0 2.85 ...
 $ dec-1-ene                                                : num  0 0 0 1.33 0 0 0 0 0 0 ...
 $ (Z)-hex-3-en-1-ol                                        : num  29.9 74.2 0 243.7 164.3 ...
 $ heptane-2,3-dione                                        : num  7.65 0 2.37 4.49 12.43 ...
 $ methyl prop-2-enoate                                     : num  0 0 0 0 3.99 0 0 0 0 0 ...
 $ α-phellandrene                                           : num  0.88 0.26 0.69 0 0 0.24 0.86 0 0.43 0 ...
 $ p-cymene                                                 : num  1.23 0 0.89 3.32 0 0 0.78 1.3 1.47 0 ...
 $ epoxy-linalooloxide                                      : num  0 0 0 0 0 0 0 0 0 0 ...
 - attr(*, &quot;spec&quot;)=
  .. cols(
  ..   .default = col_character(),
  ..   Sample = col_character(),
  ..   Flow = col_double(),
  ..   Mass = col_double(),
  ..   Vial = col_character(),
  ..   Page = col_character(),
  ..   Filename = col_character(),
  ..   Path = col_character(),
  ..   Species = col_character(),
  ..   Population = col_character(),
  ..   Plant = col_character(),
  ..   Cutting = col_character(),
  ..   Inflo = col_character(),
  ..   Diurnal = col_character(),
  ..   Sex = col_character(),
  ..   Leaves = col_character(),
  ..   Inflor = col_character(),
  ..   Mphase = col_character(),
  ..   Fphase = col_character(),
  ..   Closed = col_character(),
  ..   Buds = col_character(),
  ..   Flrs = col_character(),
  ..   ClosedCN = col_character(),
  ..   BudsCN = col_character(),
  ..   FlrsCN = col_character(),
  ..   Bag = col_character(),
  ..   Photo = col_character(),
  ..   Room = col_character(),
  ..   FlowRate = col_character(),
  ..   Temp = col_character(),
  ..   SampleDate = col_date(format = &quot;&quot;),
  ..   Equil = col_character(),
  ..   Start = col_time(format = &quot;&quot;),
  ..   Stop = col_time(format = &quot;&quot;),
  ..   Equi = col_double(),
  ..   Duration = col_double(),
  ..   Total = col_double(),
  ..   RunDate = col_date(format = &quot;&quot;),
  ..   Method = col_character(),
  ..   Blank = col_character(),
  ..   GC = col_character(),
  ..   Results = col_character(),
  ..   Notes = col_character()
  .. )</code></pre>
<p>#Total Emissions</p>
<pre class="r"><code>#convert these to emission rate (ng/flr/hr) #done - need to run command for svhybn$ngftot
library(ggplot2)
library(ggpubr)
library(dplyr)

svhybn.plants &lt;- svhybn %&gt;% group_by(SpeciesR, Individual) %&gt;% summarize_at(vars(ngftot), mean)

(ftot.medians &lt;- svhybn.plants %&gt;% group_by(SpeciesR) %&gt;% summarize_at(&quot;ngftot&quot;, list( n=length, ngftot=median)) %&gt;% mutate (tukey=c(&quot;a&quot;,&quot;a&quot;,&quot;a&quot;,&quot;a&quot;)))# was &quot;a&quot;,&quot;b&quot;,&quot;b&quot;,&quot;b&quot; for ftot</code></pre>
<pre><code># A tibble: 4 × 4
  SpeciesR       n ngftot tukey
  &lt;fct&gt;      &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;
1 S. kaalae     32  12.8  a    
2 K x H         12  10.3  a    
3 H x K         21   9.46 a    
4 S. hookeri    32  10.9  a    </code></pre>
<pre class="r"><code>  (teplot &lt;-   ggplot(svhybn, aes(x=SpeciesR, y=ngftot, fill=SpeciesR))  +  
    #geom_hline(yintercept=exp(mean(log(ftot.means$ftot[c(1,4)]))))  + #geometric mean of arithmetic means
    #geom_violin() + 
    geom_boxplot()+
    geom_text(aes(label=tukey, y=110), data=ftot.medians)+ #for ftot was 2e7
    geom_text(aes(label=paste(&quot;n =&quot;,n), y=1), data=ftot.medians)+ #for ftot was 3e4
    scale_y_log10() + #labels=scientific_10
    theme_pubr() + 
    ylab(expression(&quot;Volatile emissions (ng/flower/hr)&quot;)) + 
    scale_fill_manual(values=hybcolr) +guides(fill=&quot;none&quot;)+
    scale_x_discrete(&quot;Species&quot;, labels=(c(expression(italic(&quot;S. kaalae&quot;)), &quot;K x H&quot;, &quot;H x K&quot;, expression(italic(&quot;S. hookeri&quot;))))))</code></pre>
<p><img src="hybrids_cut_plots/te_figure-1.svg" width="672" /></p>
<pre class="r"><code>ggsave(&quot;output/hybrids/teplot_ng_yesoct_yeshex.png&quot;, teplot, height=5, width =4, type=&quot;cairo&quot;) 
ggsave(&quot;output/hybrids/teplot_ng_yesoct_yeshex.pdf&quot;, teplot, height=5, width =4, device=cairo_pdf) </code></pre>
<pre class="r"><code>#go down and run ngftot line first
lm.ftot &lt;- lm(ngftot~SpeciesR, data=svhybn) #got rid of log10 so this is testing the arithmetic mean now
library(multcomp)
lm.ftot %&gt;% glht(linfct = mcp(SpeciesR=c(&quot;`H x K` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri`== 0&quot;,
                                         &quot;`K x H` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri`== 0&quot;))) %&gt;% 
  summary() #test if hybrids are different from arithmetic average of two species</code></pre>
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: lm(formula = ngftot ~ SpeciesR, data = svhybn)

Linear Hypotheses:
                                                      Estimate Std. Error
`H x K` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri` == 0  -0.7275     3.1407
`K x H` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri` == 0  -4.1439     4.2567
                                                      t value Pr(&gt;|t|)
`H x K` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri` == 0  -0.232    0.966
`K x H` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri` == 0  -0.973    0.548
(Adjusted p values reported -- single-step method)</code></pre>
<pre class="r"><code>lm.ftot %&gt;% glht(linfct = mcp(SpeciesR=&quot;Tukey&quot;)) %&gt;% summary #pairwise comparisons</code></pre>
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = ngftot ~ SpeciesR, data = svhybn)

Linear Hypotheses:
                            Estimate Std. Error t value Pr(&gt;|t|)
K x H - S. kaalae == 0      -4.90208    4.54779  -1.078    0.700
H x K - S. kaalae == 0      -1.48573    3.52517  -0.421    0.974
S. hookeri - S. kaalae == 0 -1.51636    3.29194  -0.461    0.967
H x K - K x H == 0           3.41635    4.75029   0.719    0.887
S. hookeri - K x H == 0      3.38571    4.57988   0.739    0.879
S. hookeri - H x K == 0     -0.03064    3.56647  -0.009    1.000
(Adjusted p values reported -- single-step method)</code></pre>
<pre class="r"><code>library(emmeans)
em.ftot &lt;- emmeans(lm.ftot, &quot;SpeciesR&quot;) %&gt;% regrid #regrid put is back on untransformed scale
pairs(em.ftot)</code></pre>
<pre><code> contrast               estimate   SE  df t.ratio p.value
 S. kaalae - K x H        4.9021 4.55 111   1.078  0.7037
 S. kaalae - H x K        1.4857 3.53 111   0.421  0.9747
 S. kaalae - S. hookeri   1.5164 3.29 111   0.461  0.9674
 K x H - H x K           -3.4164 4.75 111  -0.719  0.8893
 K x H - S. hookeri      -3.3857 4.58 111  -0.739  0.8810
 H x K - S. hookeri       0.0306 3.57 111   0.009  1.0000

P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
<pre class="r"><code>cld(em.ftot)</code></pre>
<pre><code> SpeciesR   emmean   SE  df lower.CL upper.CL .group
 K x H        11.8 3.93 111     3.99     19.6  1    
 S. hookeri   15.2 2.36 111    10.48     19.8  1    
 H x K        15.2 2.67 111     9.89     20.5  1    
 S. kaalae    16.7 2.30 111    12.13     21.2  1    

Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
<pre class="r"><code>plot(em.ftot)</code></pre>
<p><img src="hybrids_cut_plots/te_model-1.svg" width="672" /></p>
<pre class="r"><code>beanplot(log10(rowSums(vol[f,]))~specp, main=&quot;Log Total Emissions&quot;)</code></pre>
<p><img src="hybrids_cut_plots/te_misc-1.svg" width="672" /></p>
<pre class="r"><code>beanplot(log10(rowSums(volhybn)/svhybn$Flrs)~specpn, main=&quot;Log Emissions per Flower&quot;, log=&quot;&quot;)</code></pre>
<p><img src="hybrids_cut_plots/te_misc-2.svg" width="672" /></p>
<pre class="r"><code>beanplot(log10(ftot)~SpeciesR, data=svhybn, main=&quot;Log Emissions per Flower&quot;, log=&quot;&quot;)</code></pre>
<p><img src="hybrids_cut_plots/te_misc-3.svg" width="672" /></p>
<pre class="r"><code>#library(ggbeeswarm) #geom_beeswarm(cex=2.8, size=2) +
  
plot(log10(rowSums(volhybn)/svhybn$Flrs)~specpn, main=&quot;Log Emissions per Flower&quot;)</code></pre>
<p><img src="hybrids_cut_plots/te_misc-4.svg" width="672" /></p>
<pre class="r"><code>tapply((rowSums(volparn)/svparn$Flrs), specparn, mean)</code></pre>
<pre><code>   HOOK    KAAL 
1758566 3821282 </code></pre>
<pre class="r"><code>plot(log10(rowSums(volparn)/svparn$Flrs)~specparn)</code></pre>
<p><img src="hybrids_cut_plots/te_misc-5.svg" width="672" /></p>
<pre class="r"><code>wilcox.test((rowSums(volparn)/svparn$Flrs)~specparn)</code></pre>
<pre><code>
    Wilcoxon rank sum exact test

data:  (rowSums(volparn)/svparn$Flrs) by specparn
W = 291, p-value = 1.098e-05
alternative hypothesis: true location shift is not equal to 0</code></pre>
<pre class="r"><code>tapply(log10(rowSums(volparn)/svparn$Flrs),specparn,mean)</code></pre>
<pre><code>    HOOK     KAAL 
6.094444 6.483771 </code></pre>
<pre class="r"><code>plot((log10(rowSums(volparn))~specparn))</code></pre>
<p><img src="hybrids_cut_plots/te_misc-6.svg" width="672" /></p>
<pre class="r"><code>wilcox.test((rowSums(volparn))~specparn)</code></pre>
<pre><code>
    Wilcoxon rank sum exact test

data:  (rowSums(volparn)) by specparn
W = 109, p-value = 5.131e-12
alternative hypothesis: true location shift is not equal to 0</code></pre>
<pre class="r"><code>tapply(rowSums(volparn),specparn,mean)</code></pre>
<pre><code>     HOOK      KAAL 
 36374472 128582847 </code></pre>
<pre class="r"><code>#for manuscript
wilcox.test((rowSums(volparn[,colnames(volparn) !=&quot;(Z)-hex-3-en-1-ol&quot;]/svparn$Flrs))~specparn)</code></pre>
<pre><code>
    Wilcoxon rank sum exact test

data:  (rowSums(volparn[, colnames(volparn) != &quot;(Z)-hex-3-en-1-ol&quot;]/svparn$Flrs)) by specparn
W = 179, p-value = 4.791e-09
alternative hypothesis: true location shift is not equal to 0</code></pre>
<pre class="r"><code>aov.te &lt;- aov(rowSums(volhybn)/svhybn$Flrs~specpn)
aov.te &lt;- aov(rowSums(fvol[f,])~specp)
anova(aov.te)</code></pre>
<pre><code>Analysis of Variance Table

Response: rowSums(fvol[f, ])
           Df     Sum Sq    Mean Sq F value Pr(&gt;F)
specp       2 6.2354e+12 3.1177e+12  0.6857 0.5056
Residuals 125 5.6836e+14 4.5469e+12               </code></pre>
<pre class="r"><code>TukeyHSD(aov.te, ordered=TRUE)</code></pre>
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level
    factor levels have been ordered

Fit: aov(formula = rowSums(fvol[f, ]) ~ specp)

$specp
              diff       lwr     upr     p adj
KAAL-KAHO 197124.1 -906588.3 1300836 0.9058980
HOOK-KAHO 531786.9 -559311.2 1622885 0.4816686
HOOK-KAAL 334662.8 -756435.3 1425761 0.7476558</code></pre>
<pre class="r"><code>#Ratio of night and day
aggregate((rowSums(volpar)/svpar$Flrs), list(svpar$SpeciesR,svpar$DN), mean)</code></pre>
<pre><code>     Group.1 Group.2         x
1  S. kaalae     Day 2093259.2
2 S. hookeri     Day  810955.5
3  S. kaalae   Night 3821281.8
4 S. hookeri   Night 1758566.2</code></pre>
<pre class="r"><code>plot(rowSums(vol[f,])~sv$Flrs[f], col=specscol[specp], ylab=&quot;Total Emissions&quot;,xlab=&quot;Number of Flowers&quot;, main=&quot;Emissions ~ Flowers&quot;)
legend(&quot;topright&quot;,legend=levels(specp), fill=specscol)</code></pre>
<p><img src="hybrids_cut_plots/eperf-1.svg" width="672" /></p>
<pre class="r"><code>summary(lm(rowSums(vol[f,])~specp+sv$Flrs[f]))</code></pre>
<pre><code>
Call:
lm(formula = rowSums(vol[f, ]) ~ specp + sv$Flrs[f])

Residuals:
       Min         1Q     Median         3Q        Max 
-114505821  -41300143  -18909127   23551466  285945974 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 32888464   13813506   2.381   0.0188 *  
specpKAHO   -3987854   13418946  -0.297   0.7668    
specpKAAL   -5162681   13370406  -0.386   0.7001    
sv$Flrs[f]   1302037     305190   4.266 3.91e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 61920000 on 124 degrees of freedom
Multiple R-squared:  0.1313,    Adjusted R-squared:  0.1102 
F-statistic: 6.245 on 3 and 124 DF,  p-value: 0.0005532</code></pre>
<pre class="r"><code>qplot(sv$Flrs[f],rowSums(vol[f,]), col=specp, ylab=&quot;Total Emissions&quot;,xlab=&quot;Number of Flowers&quot;, main=&quot;Emissions ~ Flowers&quot;) +geom_smooth(se=F)</code></pre>
<p><img src="hybrids_cut_plots/eperf-2.svg" width="672" /></p>
<div id="rarity-abundance" class="section level1">
<h1>Rarity-abundance</h1>
<pre class="r"><code>#write.table(data.frame(index=1:ncol(fvolhybn), max=log10(apply(fvolhybn,2,max)), mean=log10(apply(fvolhybn,2,function(x){mean(x[x&gt;0])}))),&quot;rarity.csv&quot;, sep=&quot;\t&quot;, row.names=T)
ccol.g &lt;- as.character(read.delim(&quot;data/UCI_GCMS/rarity.csv&quot;)$color)#convert to CAS!
ccol.g[ccol.g==&quot;&quot;] &lt;- &quot;#888888&quot;
ccol.g &lt;- &quot;#888888&quot;##REVERT
set.seed(2)
ccolhyb &lt;- sample(rainbow(length(volhyb)))
  
rarity &lt;- function(choice, makeplot=TRUE) {
fvolhybn1 &lt;- fvolhybn[specpn==choice, ]
pavolhybn1 &lt;- volhybn[specpn==choice, ]
pavolhybn1[pavolhybn1&gt;0] &lt;-1

x &lt;- colSums(pavolhybn1/nrow(pavolhybn1))
y &lt;- apply(fvolhybn1,2,max)
size &lt;- apply(fvolhybn1,2,function(x){mean(x[x&gt;0])})
if(makeplot) {
plot(log10(y)~x, cex=ifelse(log10(size)&gt;2, (log10(size)-1.9)*3, 0.3), col=alpha(ccol.g,0.7), pch=19, main=paste(&quot;Maximum abundance vs. occurence for &quot;,choice),sub=&quot;Circles sized by log mean nonzero abundance per flower&quot;,xlab=&quot;Fraction of samples&quot;,ylab=&quot;log maximum abundance per flower&quot;)
labels &lt;- sapply(colnames(volhyb), function(y) paste(strwrap(y, 60), collapse = &quot;\n&quot;))
text(x,log10(y),labels=ifelse(sqrt(x^2+5*log10(y)^2)&gt;7,labels, NA), xpd=T, cex=0.6)
}
return(data.frame(species = choice, prop = x, max = y, avg = size))
}
png(&quot;output/hybrids/rarity_KAAL3.png&quot;, height=2000, width=2000)
par(cex=3.5)
rarity(&quot;KAAL&quot;)</code></pre>
<pre><code>                                                          species       prop
benzonitrile                                                 KAAL 0.15789474
benzaldehyde                                                 KAAL 1.00000000
anisole                                                      KAAL 0.02631579
1,3-diphenylpropan-2-one                                     KAAL 0.13157895
N-phenylformamide                                            KAAL 0.00000000
octan-3-one                                                  KAAL 0.89473684
methyl hexanoate                                             KAAL 0.00000000
but-2-ene-1,4-diol                                           KAAL 0.02631579
octan-2-one                                                  KAAL 0.21052632
hexan-1-ol                                                   KAAL 0.13157895
4-oxoisophorone                                              KAAL 1.00000000
2-methylbutanoic acid                                        KAAL 0.02631579
indole                                                       KAAL 0.13157895
cyclopentanone                                               KAAL 0.02631579
2-phenylacetaldehyde                                         KAAL 0.94736842
β-mercene                                                    KAAL 0.47368421
ethyl hexanoate                                              KAAL 0.02631579
methyl furan-3-carboxylate                                   KAAL 0.00000000
methyl 2-aminobenzoate                                       KAAL 0.05263158
methyl (Z)-hex-3-enoate                                      KAAL 0.00000000
2-phenylacetonitrile                                         KAAL 0.10526316
4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde    KAAL 0.71052632
rosefuran                                                    KAAL 0.02631579
(Z)-pent-2-en-1-ol                                           KAAL 0.00000000
pent-1-en-3-one                                              KAAL 0.07894737
3,7-dimethylundecane                                         KAAL 0.02631579
5,7-dimethylundecane                                         KAAL 0.07894737
hept-2-enal                                                  KAAL 0.36842105
2,3,5,8-tetramethyldecane                                    KAAL 0.00000000
(3E)-4,8-dimethylnona-1,3,7-triene                           KAAL 0.02631579
2,2,6-trimethylcyclohexane-1,4-dione                         KAAL 0.84210526
4-methyloctane                                               KAAL 0.21052632
methyl (E)-hex-2-enoate                                      KAAL 0.00000000
propylcyclopropane                                           KAAL 0.31578947
tridec-1-ene                                                 KAAL 0.05263158
3,5,5-trimethylhex-2-ene                                     KAAL 0.05263158
unknown benzenoid                                            KAAL 0.10526316
3,5-dihydroxy-6-methyl-2,3-dihydropyran-4-one                KAAL 0.15789474
hept-1-en-3-one                                              KAAL 0.15789474
cyclopentane-1,2-dione                                       KAAL 0.21052632
[(Z)-hex-3-enyl] hexanoate                                   KAAL 0.00000000
[(Z)-hex-3-enyl] formate                                     KAAL 0.05263158
oct-1-en-3-ol                                                KAAL 1.00000000
linalool oxide (pyranoid) ketone                             KAAL 1.00000000
[(Z)-hex-3-enyl] acetate                                     KAAL 0.00000000
(E)-β-ocimene                                                KAAL 0.26315789
linalool oxide (pyranoid)                                    KAAL 1.00000000
(3E,5E)-octa-1,3,5-triene                                    KAAL 0.00000000
3,5,5-trimethylhex-1-ene                                     KAAL 0.05263158
furan-3-ylmethanol                                           KAAL 0.07894737
(E)-hex-3-enal                                               KAAL 0.00000000
valencene                                                    KAAL 0.00000000
1,3-dihydro-2-benzofuran                                     KAAL 0.00000000
[(E)-hex-3-enyl] butanoate                                   KAAL 0.00000000
perillene                                                    KAAL 0.15789474
2,6,6-trimethyloctane                                        KAAL 0.00000000
(E)-hept-2-ene                                               KAAL 0.02631579
3H-pyran-2,6-dione                                           KAAL 0.18421053
linalool oxide (furanoid)                                    KAAL 1.00000000
6-methylheptan-3-one                                         KAAL 0.13157895
pentyl propanoate                                            KAAL 0.10526316
4-methylpentan-1-ol                                          KAAL 0.02631579
hexanal                                                      KAAL 1.00000000
(E)-hex-2-enal                                               KAAL 0.00000000
4-methyl-1,3-thiazole                                        KAAL 0.00000000
hex-4-enyl acetate                                           KAAL 0.00000000
hept-3-ene                                                   KAAL 0.05263158
linalool                                                     KAAL 0.34210526
2-methylnonane                                               KAAL 0.02631579
dec-1-ene                                                    KAAL 0.05263158
(Z)-hex-3-en-1-ol                                            KAAL 0.21052632
heptane-2,3-dione                                            KAAL 0.07894737
methyl prop-2-enoate                                         KAAL 0.05263158
α-phellandrene                                               KAAL 0.76315789
p-cymene                                                     KAAL 0.55263158
epoxy-linalooloxide                                          KAAL 0.39473684
                                                                   max
benzonitrile                                                 9130.0988
benzaldehyde                                               373446.4005
anisole                                                      2962.4203
1,3-diphenylpropan-2-one                                    14654.3844
N-phenylformamide                                               0.0000
octan-3-one                                                254042.9143
methyl hexanoate                                                0.0000
but-2-ene-1,4-diol                                           4242.2512
octan-2-one                                                  7653.6289
hexan-1-ol                                                  44077.7734
4-oxoisophorone                                            272604.3923
2-methylbutanoic acid                                        1820.9268
indole                                                      15540.3055
cyclopentanone                                                608.6744
2-phenylacetaldehyde                                      2255895.2341
β-mercene                                                   12943.0252
ethyl hexanoate                                              1290.6406
methyl furan-3-carboxylate                                      0.0000
methyl 2-aminobenzoate                                       3006.9252
methyl (Z)-hex-3-enoate                                         0.0000
2-phenylacetonitrile                                        33603.8357
4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde   58119.8416
rosefuran                                                    4614.9069
(Z)-pent-2-en-1-ol                                              0.0000
pent-1-en-3-one                                            133902.9327
3,7-dimethylundecane                                          416.4297
5,7-dimethylundecane                                         8938.5119
hept-2-enal                                                 19739.6117
2,3,5,8-tetramethyldecane                                       0.0000
(3E)-4,8-dimethylnona-1,3,7-triene                          12918.5720
2,2,6-trimethylcyclohexane-1,4-dione                       101075.3442
4-methyloctane                                               6212.3133
methyl (E)-hex-2-enoate                                         0.0000
propylcyclopropane                                          21929.5043
tridec-1-ene                                                11501.2555
3,5,5-trimethylhex-2-ene                                     5983.9989
unknown benzenoid                                           15257.3205
3,5-dihydroxy-6-methyl-2,3-dihydropyran-4-one               89342.7312
hept-1-en-3-one                                              9210.6746
cyclopentane-1,2-dione                                     187942.3231
[(Z)-hex-3-enyl] hexanoate                                      0.0000
[(Z)-hex-3-enyl] formate                                    10523.5353
oct-1-en-3-ol                                             2227377.3514
linalool oxide (pyranoid) ketone                          5777748.7452
[(Z)-hex-3-enyl] acetate                                        0.0000
(E)-β-ocimene                                                6989.9426
linalool oxide (pyranoid)                                 5715272.9799
(3E,5E)-octa-1,3,5-triene                                       0.0000
3,5,5-trimethylhex-1-ene                                     2983.2766
furan-3-ylmethanol                                          12871.7239
(E)-hex-3-enal                                                  0.0000
valencene                                                       0.0000
1,3-dihydro-2-benzofuran                                        0.0000
[(E)-hex-3-enyl] butanoate                                      0.0000
perillene                                                   11861.6670
2,6,6-trimethyloctane                                           0.0000
(E)-hept-2-ene                                                661.1755
3H-pyran-2,6-dione                                          31837.9906
linalool oxide (furanoid)                                 2285555.1180
6-methylheptan-3-one                                        35737.7709
pentyl propanoate                                            4587.2060
4-methylpentan-1-ol                                          1205.5167
hexanal                                                    269839.1500
(E)-hex-2-enal                                                  0.0000
4-methyl-1,3-thiazole                                           0.0000
hex-4-enyl acetate                                              0.0000
hept-3-ene                                                  37137.3230
linalool                                                   139191.5175
2-methylnonane                                               2809.3094
dec-1-ene                                                    4532.1156
(Z)-hex-3-en-1-ol                                           42032.4149
heptane-2,3-dione                                            5719.3547
methyl prop-2-enoate                                         9872.4755
α-phellandrene                                             760877.8584
p-cymene                                                   113276.4077
epoxy-linalooloxide                                         74955.1264
                                                                   avg
benzonitrile                                                 2069.5961
benzaldehyde                                                33272.9243
anisole                                                      2962.4203
1,3-diphenylpropan-2-one                                     9899.9423
N-phenylformamide                                                  NaN
octan-3-one                                                 41890.9409
methyl hexanoate                                                   NaN
but-2-ene-1,4-diol                                           4242.2512
octan-2-one                                                  3214.3029
hexan-1-ol                                                  17443.2582
4-oxoisophorone                                             35788.3810
2-methylbutanoic acid                                        1820.9268
indole                                                       7099.7024
cyclopentanone                                                608.6744
2-phenylacetaldehyde                                       128498.6538
β-mercene                                                    5141.4636
ethyl hexanoate                                              1290.6406
methyl furan-3-carboxylate                                         NaN
methyl 2-aminobenzoate                                       1750.9576
methyl (Z)-hex-3-enoate                                            NaN
2-phenylacetonitrile                                        12117.9722
4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde   10438.6909
rosefuran                                                    4614.9069
(Z)-pent-2-en-1-ol                                                 NaN
pent-1-en-3-one                                             93261.2285
3,7-dimethylundecane                                          416.4297
5,7-dimethylundecane                                         6198.2512
hept-2-enal                                                  5509.9938
2,3,5,8-tetramethyldecane                                          NaN
(3E)-4,8-dimethylnona-1,3,7-triene                          12918.5720
2,2,6-trimethylcyclohexane-1,4-dione                        17859.5278
4-methyloctane                                               2954.9338
methyl (E)-hex-2-enoate                                            NaN
propylcyclopropane                                           6908.7920
tridec-1-ene                                                 9372.2514
3,5,5-trimethylhex-2-ene                                     4601.6336
unknown benzenoid                                           10951.2895
3,5-dihydroxy-6-methyl-2,3-dihydropyran-4-one               38690.0763
hept-1-en-3-one                                              4310.4485
cyclopentane-1,2-dione                                      66807.9081
[(Z)-hex-3-enyl] hexanoate                                         NaN
[(Z)-hex-3-enyl] formate                                     6268.2626
oct-1-en-3-ol                                              272830.2378
linalool oxide (pyranoid) ketone                          1347729.2782
[(Z)-hex-3-enyl] acetate                                           NaN
(E)-β-ocimene                                                4283.5736
linalool oxide (pyranoid)                                 1113066.3064
(3E,5E)-octa-1,3,5-triene                                          NaN
3,5,5-trimethylhex-1-ene                                     1838.6724
furan-3-ylmethanol                                           8867.0419
(E)-hex-3-enal                                                     NaN
valencene                                                          NaN
1,3-dihydro-2-benzofuran                                           NaN
[(E)-hex-3-enyl] butanoate                                         NaN
perillene                                                    5837.6133
2,6,6-trimethyloctane                                              NaN
(E)-hept-2-ene                                                661.1755
3H-pyran-2,6-dione                                          13970.3869
linalool oxide (furanoid)                                  594890.0684
6-methylheptan-3-one                                        15570.5493
pentyl propanoate                                            2997.5551
4-methylpentan-1-ol                                          1205.5167
hexanal                                                     48242.5972
(E)-hex-2-enal                                                     NaN
4-methyl-1,3-thiazole                                              NaN
hex-4-enyl acetate                                                 NaN
hept-3-ene                                                  20623.5195
linalool                                                    31339.2648
2-methylnonane                                               2809.3094
dec-1-ene                                                    3154.2096
(Z)-hex-3-en-1-ol                                           20617.8082
heptane-2,3-dione                                            3912.6771
methyl prop-2-enoate                                         7485.4361
α-phellandrene                                             129810.7212
p-cymene                                                    34441.5773
epoxy-linalooloxide                                         12436.7566</code></pre>
<pre class="r"><code>dev.off()</code></pre>
<pre><code>devSVG 
     2 </code></pre>
<pre class="r"><code>png(&quot;output/hybrids/rarity_KAHO3.png&quot;, height=2000, width=2000)
par(cex=3.5)
rarity(&quot;KAHO&quot;)</code></pre>
<pre><code>                                                          species       prop
benzonitrile                                                 KAHO 0.02439024
benzaldehyde                                                 KAHO 0.97560976
anisole                                                      KAHO 0.07317073
1,3-diphenylpropan-2-one                                     KAHO 0.04878049
N-phenylformamide                                            KAHO 0.02439024
octan-3-one                                                  KAHO 0.97560976
methyl hexanoate                                             KAHO 0.07317073
but-2-ene-1,4-diol                                           KAHO 0.21951220
octan-2-one                                                  KAHO 0.02439024
hexan-1-ol                                                   KAHO 0.12195122
4-oxoisophorone                                              KAHO 0.58536585
2-methylbutanoic acid                                        KAHO 0.12195122
indole                                                       KAHO 0.63414634
cyclopentanone                                               KAHO 0.02439024
2-phenylacetaldehyde                                         KAHO 0.63414634
β-mercene                                                    KAHO 0.00000000
ethyl hexanoate                                              KAHO 0.09756098
methyl furan-3-carboxylate                                   KAHO 0.02439024
methyl 2-aminobenzoate                                       KAHO 0.17073171
methyl (Z)-hex-3-enoate                                      KAHO 0.04878049
2-phenylacetonitrile                                         KAHO 0.14634146
4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde    KAHO 0.12195122
rosefuran                                                    KAHO 0.09756098
(Z)-pent-2-en-1-ol                                           KAHO 0.04878049
pent-1-en-3-one                                              KAHO 0.00000000
3,7-dimethylundecane                                         KAHO 0.12195122
5,7-dimethylundecane                                         KAHO 0.07317073
hept-2-enal                                                  KAHO 0.09756098
2,3,5,8-tetramethyldecane                                    KAHO 0.04878049
(3E)-4,8-dimethylnona-1,3,7-triene                           KAHO 0.12195122
2,2,6-trimethylcyclohexane-1,4-dione                         KAHO 0.09756098
4-methyloctane                                               KAHO 0.09756098
methyl (E)-hex-2-enoate                                      KAHO 0.04878049
propylcyclopropane                                           KAHO 0.24390244
tridec-1-ene                                                 KAHO 0.19512195
3,5,5-trimethylhex-2-ene                                     KAHO 0.51219512
unknown benzenoid                                            KAHO 0.75609756
3,5-dihydroxy-6-methyl-2,3-dihydropyran-4-one                KAHO 0.07317073
hept-1-en-3-one                                              KAHO 0.02439024
cyclopentane-1,2-dione                                       KAHO 0.14634146
[(Z)-hex-3-enyl] hexanoate                                   KAHO 0.12195122
[(Z)-hex-3-enyl] formate                                     KAHO 0.00000000
oct-1-en-3-ol                                                KAHO 1.00000000
linalool oxide (pyranoid) ketone                             KAHO 1.00000000
[(Z)-hex-3-enyl] acetate                                     KAHO 0.04878049
(E)-β-ocimene                                                KAHO 0.00000000
linalool oxide (pyranoid)                                    KAHO 0.95121951
(3E,5E)-octa-1,3,5-triene                                    KAHO 0.07317073
3,5,5-trimethylhex-1-ene                                     KAHO 0.12195122
furan-3-ylmethanol                                           KAHO 0.09756098
(E)-hex-3-enal                                               KAHO 0.31707317
valencene                                                    KAHO 0.00000000
1,3-dihydro-2-benzofuran                                     KAHO 0.02439024
[(E)-hex-3-enyl] butanoate                                   KAHO 0.04878049
perillene                                                    KAHO 0.17073171
2,6,6-trimethyloctane                                        KAHO 0.02439024
(E)-hept-2-ene                                               KAHO 0.04878049
3H-pyran-2,6-dione                                           KAHO 0.04878049
linalool oxide (furanoid)                                    KAHO 0.95121951
6-methylheptan-3-one                                         KAHO 0.09756098
pentyl propanoate                                            KAHO 0.17073171
4-methylpentan-1-ol                                          KAHO 0.24390244
hexanal                                                      KAHO 1.00000000
(E)-hex-2-enal                                               KAHO 0.41463415
4-methyl-1,3-thiazole                                        KAHO 0.17073171
hex-4-enyl acetate                                           KAHO 0.12195122
hept-3-ene                                                   KAHO 0.21951220
linalool                                                     KAHO 0.12195122
2-methylnonane                                               KAHO 0.07317073
dec-1-ene                                                    KAHO 0.04878049
(Z)-hex-3-en-1-ol                                            KAHO 0.97560976
heptane-2,3-dione                                            KAHO 0.78048780
methyl prop-2-enoate                                         KAHO 0.04878049
α-phellandrene                                               KAHO 0.48780488
p-cymene                                                     KAHO 0.21951220
epoxy-linalooloxide                                          KAHO 0.12195122
                                                                   max
benzonitrile                                                  386.4179
benzaldehyde                                               100659.0284
anisole                                                      3087.1467
1,3-diphenylpropan-2-one                                     6598.1429
N-phenylformamide                                           13965.8814
octan-3-one                                                800135.1515
methyl hexanoate                                             1321.3129
but-2-ene-1,4-diol                                           9741.1612
octan-2-one                                                  8264.8250
hexan-1-ol                                                 131855.4949
4-oxoisophorone                                             48297.1139
2-methylbutanoic acid                                       94655.3720
indole                                                      75946.6114
cyclopentanone                                               1067.3561
2-phenylacetaldehyde                                         8457.0873
β-mercene                                                       0.0000
ethyl hexanoate                                             10502.5461
methyl furan-3-carboxylate                                    760.2547
methyl 2-aminobenzoate                                      78397.4324
methyl (Z)-hex-3-enoate                                      2655.2763
2-phenylacetonitrile                                         5628.4735
4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde    8598.5443
rosefuran                                                    6914.3965
(Z)-pent-2-en-1-ol                                           2602.7037
pent-1-en-3-one                                                 0.0000
3,7-dimethylundecane                                        23120.2181
5,7-dimethylundecane                                        10443.2963
hept-2-enal                                                  3638.0776
2,3,5,8-tetramethyldecane                                   23445.1983
(3E)-4,8-dimethylnona-1,3,7-triene                          15473.4058
2,2,6-trimethylcyclohexane-1,4-dione                         5892.8143
4-methyloctane                                               4068.0731
methyl (E)-hex-2-enoate                                      5860.5294
propylcyclopropane                                          17956.1892
tridec-1-ene                                                16933.2547
3,5,5-trimethylhex-2-ene                                   122676.7991
unknown benzenoid                                          110552.7125
3,5-dihydroxy-6-methyl-2,3-dihydropyran-4-one               10063.5646
hept-1-en-3-one                                             14061.3106
cyclopentane-1,2-dione                                     114694.6587
[(Z)-hex-3-enyl] hexanoate                                  11544.7290
[(Z)-hex-3-enyl] formate                                        0.0000
oct-1-en-3-ol                                             3381996.3608
linalool oxide (pyranoid) ketone                          2129256.2324
[(Z)-hex-3-enyl] acetate                                   201225.2532
(E)-β-ocimene                                                   0.0000
linalool oxide (pyranoid)                                  869067.1564
(3E,5E)-octa-1,3,5-triene                                   11190.9483
3,5,5-trimethylhex-1-ene                                    16012.0761
furan-3-ylmethanol                                          49571.2687
(E)-hex-3-enal                                              66545.5443
valencene                                                       0.0000
1,3-dihydro-2-benzofuran                                     6318.7553
[(E)-hex-3-enyl] butanoate                                  42786.8433
perillene                                                   11076.5872
2,6,6-trimethyloctane                                        3601.0111
(E)-hept-2-ene                                              33464.6619
3H-pyran-2,6-dione                                          41098.9194
linalool oxide (furanoid)                                  318497.1002
6-methylheptan-3-one                                         6879.0389
pentyl propanoate                                           12061.4682
4-methylpentan-1-ol                                         11114.7795
hexanal                                                    150565.9131
(E)-hex-2-enal                                              21887.6591
4-methyl-1,3-thiazole                                       13352.6546
hex-4-enyl acetate                                          13983.8651
hept-3-ene                                                  17344.9722
linalool                                                   270963.3217
2-methylnonane                                               4816.7187
dec-1-ene                                                    4126.2415
(Z)-hex-3-en-1-ol                                         1773959.4690
heptane-2,3-dione                                           97372.3980
methyl prop-2-enoate                                        14696.4915
α-phellandrene                                              78578.0365
p-cymene                                                    18886.9317
epoxy-linalooloxide                                         18853.0265
                                                                  avg
benzonitrile                                                 386.4179
benzaldehyde                                               19195.9323
anisole                                                     2140.9827
1,3-diphenylpropan-2-one                                    4022.5480
N-phenylformamide                                          13965.8814
octan-3-one                                                89692.6941
methyl hexanoate                                            1023.2382
but-2-ene-1,4-diol                                          4137.7942
octan-2-one                                                 8264.8250
hexan-1-ol                                                 40169.1332
4-oxoisophorone                                             5784.1334
2-methylbutanoic acid                                      30412.4125
indole                                                     14559.9116
cyclopentanone                                              1067.3561
2-phenylacetaldehyde                                        3638.9785
β-mercene                                                         NaN
ethyl hexanoate                                             4000.0254
methyl furan-3-carboxylate                                   760.2547
methyl 2-aminobenzoate                                     21781.0765
methyl (Z)-hex-3-enoate                                     1776.8209
2-phenylacetonitrile                                        2754.4144
4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde   3910.2324
rosefuran                                                   5939.8830
(Z)-pent-2-en-1-ol                                          1884.5162
pent-1-en-3-one                                                   NaN
3,7-dimethylundecane                                       12186.5613
5,7-dimethylundecane                                        6104.2003
hept-2-enal                                                 2419.9715
2,3,5,8-tetramethyldecane                                  12850.7392
(3E)-4,8-dimethylnona-1,3,7-triene                          9000.8794
2,2,6-trimethylcyclohexane-1,4-dione                        3520.1463
4-methyloctane                                              1964.5050
methyl (E)-hex-2-enoate                                     3665.6015
propylcyclopropane                                          7496.9184
tridec-1-ene                                                6559.7892
3,5,5-trimethylhex-2-ene                                   17725.1503
unknown benzenoid                                          28669.5060
3,5-dihydroxy-6-methyl-2,3-dihydropyran-4-one               7498.6047
hept-1-en-3-one                                            14061.3106
cyclopentane-1,2-dione                                     43878.2714
[(Z)-hex-3-enyl] hexanoate                                  5066.1541
[(Z)-hex-3-enyl] formate                                          NaN
oct-1-en-3-ol                                             506392.6357
linalool oxide (pyranoid) ketone                          806834.0507
[(Z)-hex-3-enyl] acetate                                  105352.9002
(E)-β-ocimene                                                     NaN
linalool oxide (pyranoid)                                 162539.8224
(3E,5E)-octa-1,3,5-triene                                   6890.5732
3,5,5-trimethylhex-1-ene                                    7337.1371
furan-3-ylmethanol                                         21020.4284
(E)-hex-3-enal                                             16098.9205
valencene                                                         NaN
1,3-dihydro-2-benzofuran                                    6318.7553
[(E)-hex-3-enyl] butanoate                                 25095.1831
perillene                                                   5297.8824
2,6,6-trimethyloctane                                       3601.0111
(E)-hept-2-ene                                             20108.1329
3H-pyran-2,6-dione                                         22225.4938
linalool oxide (furanoid)                                  98441.9973
6-methylheptan-3-one                                        4612.0979
pentyl propanoate                                           3870.4309
4-methylpentan-1-ol                                         3775.0820
hexanal                                                    37039.1365
(E)-hex-2-enal                                              8830.7328
4-methyl-1,3-thiazole                                       7290.7983
hex-4-enyl acetate                                          4715.5072
hept-3-ene                                                  8859.6785
linalool                                                   55928.7762
2-methylnonane                                              3770.6605
dec-1-ene                                                   3445.8674
(Z)-hex-3-en-1-ol                                         165950.3875
heptane-2,3-dione                                          23455.6642
methyl prop-2-enoate                                       11888.2427
α-phellandrene                                             15314.5097
p-cymene                                                    8088.2546
epoxy-linalooloxide                                        11122.0908</code></pre>
<pre class="r"><code>dev.off()</code></pre>
<pre><code>devSVG 
     2 </code></pre>
<pre class="r"><code>png(&quot;output/hybrids/rarity_HOOK3.png&quot;, height=2000, width=2000)
par(cex=3.5)
rarity(&quot;HOOK&quot;)</code></pre>
<pre><code>                                                          species       prop
benzonitrile                                                 HOOK 0.02777778
benzaldehyde                                                 HOOK 1.00000000
anisole                                                      HOOK 0.38888889
1,3-diphenylpropan-2-one                                     HOOK 0.08333333
N-phenylformamide                                            HOOK 0.25000000
octan-3-one                                                  HOOK 0.97222222
methyl hexanoate                                             HOOK 0.16666667
but-2-ene-1,4-diol                                           HOOK 0.08333333
octan-2-one                                                  HOOK 0.00000000
hexan-1-ol                                                   HOOK 0.05555556
4-oxoisophorone                                              HOOK 0.02777778
2-methylbutanoic acid                                        HOOK 0.05555556
indole                                                       HOOK 0.88888889
cyclopentanone                                               HOOK 0.02777778
2-phenylacetaldehyde                                         HOOK 0.50000000
β-mercene                                                    HOOK 0.02777778
ethyl hexanoate                                              HOOK 0.02777778
methyl furan-3-carboxylate                                   HOOK 0.33333333
methyl 2-aminobenzoate                                       HOOK 0.61111111
methyl (Z)-hex-3-enoate                                      HOOK 0.13888889
2-phenylacetonitrile                                         HOOK 0.00000000
4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde    HOOK 0.02777778
rosefuran                                                    HOOK 0.08333333
(Z)-pent-2-en-1-ol                                           HOOK 0.13888889
pent-1-en-3-one                                              HOOK 0.05555556
3,7-dimethylundecane                                         HOOK 0.05555556
5,7-dimethylundecane                                         HOOK 0.11111111
hept-2-enal                                                  HOOK 0.00000000
2,3,5,8-tetramethyldecane                                    HOOK 0.00000000
(3E)-4,8-dimethylnona-1,3,7-triene                           HOOK 0.63888889
2,2,6-trimethylcyclohexane-1,4-dione                         HOOK 0.00000000
4-methyloctane                                               HOOK 0.02777778
methyl (E)-hex-2-enoate                                      HOOK 0.19444444
propylcyclopropane                                           HOOK 0.25000000
tridec-1-ene                                                 HOOK 0.05555556
3,5,5-trimethylhex-2-ene                                     HOOK 0.47222222
unknown benzenoid                                            HOOK 0.63888889
3,5-dihydroxy-6-methyl-2,3-dihydropyran-4-one                HOOK 0.22222222
hept-1-en-3-one                                              HOOK 0.00000000
cyclopentane-1,2-dione                                       HOOK 0.22222222
[(Z)-hex-3-enyl] hexanoate                                   HOOK 0.27777778
[(Z)-hex-3-enyl] formate                                     HOOK 0.08333333
oct-1-en-3-ol                                                HOOK 1.00000000
linalool oxide (pyranoid) ketone                             HOOK 0.75000000
[(Z)-hex-3-enyl] acetate                                     HOOK 0.16666667
(E)-β-ocimene                                                HOOK 0.00000000
linalool oxide (pyranoid)                                    HOOK 0.22222222
(3E,5E)-octa-1,3,5-triene                                    HOOK 0.16666667
3,5,5-trimethylhex-1-ene                                     HOOK 0.02777778
furan-3-ylmethanol                                           HOOK 0.25000000
(E)-hex-3-enal                                               HOOK 0.50000000
valencene                                                    HOOK 0.08333333
1,3-dihydro-2-benzofuran                                     HOOK 0.19444444
[(E)-hex-3-enyl] butanoate                                   HOOK 0.27777778
perillene                                                    HOOK 0.11111111
2,6,6-trimethyloctane                                        HOOK 0.02777778
(E)-hept-2-ene                                               HOOK 0.05555556
3H-pyran-2,6-dione                                           HOOK 0.19444444
linalool oxide (furanoid)                                    HOOK 0.22222222
6-methylheptan-3-one                                         HOOK 0.05555556
pentyl propanoate                                            HOOK 0.02777778
4-methylpentan-1-ol                                          HOOK 0.13888889
hexanal                                                      HOOK 1.00000000
(E)-hex-2-enal                                               HOOK 0.80555556
4-methyl-1,3-thiazole                                        HOOK 0.05555556
hex-4-enyl acetate                                           HOOK 0.25000000
hept-3-ene                                                   HOOK 0.22222222
linalool                                                     HOOK 0.47222222
2-methylnonane                                               HOOK 0.11111111
dec-1-ene                                                    HOOK 0.08333333
(Z)-hex-3-en-1-ol                                            HOOK 0.88888889
heptane-2,3-dione                                            HOOK 0.86111111
methyl prop-2-enoate                                         HOOK 0.11111111
α-phellandrene                                               HOOK 0.41666667
p-cymene                                                     HOOK 0.22222222
epoxy-linalooloxide                                          HOOK 0.00000000
                                                                   max
benzonitrile                                                 4828.5225
benzaldehyde                                               721054.6543
anisole                                                     32070.7663
1,3-diphenylpropan-2-one                                    15173.4135
N-phenylformamide                                           81260.4252
octan-3-one                                                301491.7850
methyl hexanoate                                            31114.9479
but-2-ene-1,4-diol                                           5739.3553
octan-2-one                                                     0.0000
hexan-1-ol                                                 197671.4340
4-oxoisophorone                                              1185.6580
2-methylbutanoic acid                                       12541.0085
indole                                                     266799.2501
cyclopentanone                                               6797.7718
2-phenylacetaldehyde                                         9537.3622
β-mercene                                                    5665.7028
ethyl hexanoate                                              3191.8048
methyl furan-3-carboxylate                                   6612.6866
methyl 2-aminobenzoate                                     293264.0362
methyl (Z)-hex-3-enoate                                    136661.7322
2-phenylacetonitrile                                            0.0000
4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde   11483.1062
rosefuran                                                   12864.2060
(Z)-pent-2-en-1-ol                                          26288.3046
pent-1-en-3-one                                             47989.1004
3,7-dimethylundecane                                         5087.3420
5,7-dimethylundecane                                        17383.3163
hept-2-enal                                                     0.0000
2,3,5,8-tetramethyldecane                                       0.0000
(3E)-4,8-dimethylnona-1,3,7-triene                         200944.1037
2,2,6-trimethylcyclohexane-1,4-dione                            0.0000
4-methyloctane                                                890.0317
methyl (E)-hex-2-enoate                                     53688.5376
propylcyclopropane                                          71604.9668
tridec-1-ene                                                10192.6344
3,5,5-trimethylhex-2-ene                                   130986.3043
unknown benzenoid                                          601468.1123
3,5-dihydroxy-6-methyl-2,3-dihydropyran-4-one              119577.9192
hept-1-en-3-one                                                 0.0000
cyclopentane-1,2-dione                                     467467.9755
[(Z)-hex-3-enyl] hexanoate                                 121205.9410
[(Z)-hex-3-enyl] formate                                    12732.2079
oct-1-en-3-ol                                             1538257.9495
linalool oxide (pyranoid) ketone                            92329.7825
[(Z)-hex-3-enyl] acetate                                   134669.5308
(E)-β-ocimene                                                   0.0000
linalool oxide (pyranoid)                                  113687.3861
(3E,5E)-octa-1,3,5-triene                                   16277.1552
3,5,5-trimethylhex-1-ene                                    93741.0856
furan-3-ylmethanol                                         520870.1174
(E)-hex-3-enal                                             126736.7486
valencene                                                   16578.1825
1,3-dihydro-2-benzofuran                                  1218323.2728
[(E)-hex-3-enyl] butanoate                                 118399.4947
perillene                                                   19407.9477
2,6,6-trimethyloctane                                        7603.4337
(E)-hept-2-ene                                              13666.3653
3H-pyran-2,6-dione                                          58939.9650
linalool oxide (furanoid)                                   56128.9257
6-methylheptan-3-one                                        14762.6191
pentyl propanoate                                            4349.9999
4-methylpentan-1-ol                                          8970.1710
hexanal                                                    245544.0365
(E)-hex-2-enal                                             173267.5533
4-methyl-1,3-thiazole                                        5852.3914
hex-4-enyl acetate                                         128361.3729
hept-3-ene                                                  69967.4731
linalool                                                    86590.6679
2-methylnonane                                              11510.4971
dec-1-ene                                                    5189.0244
(Z)-hex-3-en-1-ol                                         3453149.1251
heptane-2,3-dione                                          429116.3877
methyl prop-2-enoate                                        30032.5447
α-phellandrene                                              48883.9701
p-cymene                                                    42255.8986
epoxy-linalooloxide                                             0.0000
                                                                  avg
benzonitrile                                                4828.5225
benzaldehyde                                              136014.7182
anisole                                                     9198.8605
1,3-diphenylpropan-2-one                                   10497.7214
N-phenylformamide                                          40029.8872
octan-3-one                                                61749.2779
methyl hexanoate                                            9749.3963
but-2-ene-1,4-diol                                          3923.7850
octan-2-one                                                       NaN
hexan-1-ol                                                188278.1734
4-oxoisophorone                                             1185.6580
2-methylbutanoic acid                                       8823.7137
indole                                                     73691.9953
cyclopentanone                                              6797.7718
2-phenylacetaldehyde                                        4941.8905
β-mercene                                                   5665.7028
ethyl hexanoate                                             3191.8048
methyl furan-3-carboxylate                                  2722.5178
methyl 2-aminobenzoate                                     61403.7125
methyl (Z)-hex-3-enoate                                    71985.8229
2-phenylacetonitrile                                              NaN
4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde  11483.1062
rosefuran                                                   9634.9122
(Z)-pent-2-en-1-ol                                          8654.8393
pent-1-en-3-one                                            47361.2819
3,7-dimethylundecane                                        3696.2351
5,7-dimethylundecane                                        8996.2247
hept-2-enal                                                       NaN
2,3,5,8-tetramethyldecane                                         NaN
(3E)-4,8-dimethylnona-1,3,7-triene                         41051.2370
2,2,6-trimethylcyclohexane-1,4-dione                              NaN
4-methyloctane                                               890.0317
methyl (E)-hex-2-enoate                                    15138.5913
propylcyclopropane                                         28100.8242
tridec-1-ene                                                8041.8597
3,5,5-trimethylhex-2-ene                                   34728.9856
unknown benzenoid                                         187924.2406
3,5-dihydroxy-6-methyl-2,3-dihydropyran-4-one              35923.5511
hept-1-en-3-one                                                   NaN
cyclopentane-1,2-dione                                    159719.2007
[(Z)-hex-3-enyl] hexanoate                                 22978.1372
[(Z)-hex-3-enyl] formate                                    6900.3074
oct-1-en-3-ol                                             291198.6100
linalool oxide (pyranoid) ketone                           29917.6592
[(Z)-hex-3-enyl] acetate                                   56489.2968
(E)-β-ocimene                                                     NaN
linalool oxide (pyranoid)                                  27473.4783
(3E,5E)-octa-1,3,5-triene                                   8600.6791
3,5,5-trimethylhex-1-ene                                   93741.0856
furan-3-ylmethanol                                         81422.4549
(E)-hex-3-enal                                             48364.4576
valencene                                                   7360.1711
1,3-dihydro-2-benzofuran                                  567004.4100
[(E)-hex-3-enyl] butanoate                                 24865.6255
perillene                                                  13706.6854
2,6,6-trimethyloctane                                       7603.4337
(E)-hept-2-ene                                             10127.2575
3H-pyran-2,6-dione                                         31721.5771
linalool oxide (furanoid)                                  22591.0575
6-methylheptan-3-one                                        9054.9866
pentyl propanoate                                           4349.9999
4-methylpentan-1-ol                                         4889.7118
hexanal                                                    68531.8178
(E)-hex-2-enal                                             36992.0635
4-methyl-1,3-thiazole                                       3780.4672
hex-4-enyl acetate                                         30361.0410
hept-3-ene                                                 22739.9769
linalool                                                   15217.6827
2-methylnonane                                             11093.3337
dec-1-ene                                                   3434.2542
(Z)-hex-3-en-1-ol                                         571857.1237
heptane-2,3-dione                                          46514.0603
methyl prop-2-enoate                                       16600.5805
α-phellandrene                                             10396.5610
p-cymene                                                   16632.5999
epoxy-linalooloxide                                               NaN</code></pre>
<pre class="r"><code>dev.off()</code></pre>
<pre><code>devSVG 
     2 </code></pre>
<pre class="r"><code>rarity.df &lt;- rbind(rarity(&quot;HOOK&quot;), rarity(&quot;KAAL&quot;))</code></pre>
<p><img src="hybrids_cut_plots/rarity-1.svg" width="672" /><img src="hybrids_cut_plots/rarity-2.svg" width="672" /></p>
<pre class="r"><code>rarity.df$Name &lt;- row.names(rarity.df)

ggplot(rarity.df, aes(x=Name, y=avg, fill=species)) + geom_col() + coord_flip()</code></pre>
<p><img src="hybrids_cut_plots/rarity-3.svg" width="672" /></p>
<pre class="r"><code>sv.fvolhyb &lt;- cbind(svhyb, fvolhyb)
sv.fvolhyb.long &lt;- gather(sv.fvolhyb, Name, Area, 56:ncol(sv.fvolhyb))

spectimecol &lt;- c(brewer.pal(3,&quot;Purples&quot;)[2], brewer.pal(3,&quot;Purples&quot;)[3], brewer.pal(3,&quot;Greens&quot;)[2], brewer.pal(3,&quot;Greens&quot;)[3])
(spectimeplot &lt;- ggplot(filter(sv.fvolhyb.long, 
              SpeciesR %in% c(&quot;S. hookeri&quot;, &quot;S. kaalae&quot;), 
              Name %in% names(volpar[,colSums(volpar) &gt; 4000000])), aes(Name, as.numeric(Area), color=paste(SpeciesR, DN))) + 
  geom_boxplot(position=position_dodge(width=1)) + 
  coord_flip() + scale_y_sqrt(&quot;Peak area per flower&quot;, expand=expansion(mult=c(0, 0.05))) +
  scale_color_manual(&quot;Species and Time&quot;, values=spectimecol) + 
  theme_minimal())</code></pre>
<p><img src="hybrids_cut_plots/rarity-4.svg" width="672" /></p>
<pre class="r"><code>ggsave(&quot;output/hybrids/spectime.pdf&quot;, spectimeplot, height=8, width=12, units=&quot;in&quot;, device=cairo_pdf)
       
x &lt;- sapply(1:3, function(choice) {colSums(pavolhyb[specp==specs[choice],])/table(specp)[choice]})
y &lt;- sapply(1:3, function(choice) {log10(sapply(volhyb[specp==specs[choice],], max))})
size &lt;- sapply(1:3, function(choice) {log10(sapply(volhyb[specp==specs[choice],], function(x){mean(x[x&gt;0])}))})
plot(1, type=&quot;n&quot;, ylim=c(3,9), xlim=c(0,1), ylab=&quot;Maximum Relative Amount&quot;, xlab=&quot;Proportion of Samples&quot;)
arrows(x[,1], y[,1], x[,3], y[,3], length=0.01, col=ccol, lty=2)
arrows(x[,2], y[,2], x[,3], y[,3], length=0.01, col=ccol)
p&lt;-3
points(y[,p]~x[,p], cex=ifelse(size[,p]&gt;2, (size[,p]-1.9)*3, 0.3), col=alpha(ccol,0.4), xpd=T)
text(x[,p], y[,p]-0.1, ifelse(x[,p]&gt;0.2,names(x[,p]),&quot;&quot;),xpd=T,cex=0.7)</code></pre>
<p><img src="hybrids_cut_plots/rarity-5.svg" width="672" /></p>
<pre class="r"><code>par(bg=&quot;grey20&quot;, col.axis=&quot;white&quot;, col.lab=&quot;white&quot;)
x &lt;- sapply(1:3, function(choice) {colMeans(svolhybn[specpn==specs[choice],])})
plot(c(1,1,1)~factor(levels(specp), levels=levels(specp)), type=&quot;n&quot;, ylim=c(0,0.5), xlim=c(0.9,3.1), ylab=&quot;Average relative emission rate&quot;, xlab=&quot;&quot;)
arrows(1, x[,1], 2, x[,3], length=0.01, col=ccolhyb, lwd=2)
arrows(3, x[,2], 2, x[,3], length=0.01, col=ccolhyb, lwd=2)
p&lt;-3
#points(x[,p]~2, cex=ifelse(size[,p]&gt;2, (size[,p]-1.9)*3, 0.3), col=ccol, xpd=T)
text(2, x[,p]+0.01, ifelse(x[,p]&gt;0.05,names(x[,p]),&quot;&quot;),xpd=T,cex=0.7, col=ccolhyb)
p &lt;- 1
text(1, x[,p]+0.01, ifelse(x[,p]&gt;0.05,names(x[,p]),&quot;&quot;),xpd=T,cex=0.7, col=ccolhyb)
p &lt;- 2
text(3, x[,p]+0.01, ifelse(x[,p]&gt;0.05,names(x[,p]),&quot;&quot;),xpd=T,cex=0.7, col=ccolhyb)</code></pre>
<p><img src="hybrids_cut_plots/rarity-6.svg" width="672" /></p>
<p>#Venn Diagram</p>
<pre class="r"><code>## Don&#39;t run this - changes volhyb!!!
minsamp &lt;- 3
cutoff &lt;- 2000
#volhyb &lt;- fvol[f,]
volhyb &lt;- volhyb[,colSums(volhyb&gt;0) &gt;= minsamp]
volhyb &lt;- volhyb[,colSums(volhyb) &gt; cutoff]
dim(volhyb)
pavolhyb &lt;- volhyb
pavolhyb[pavolhyb&gt;0] &lt;- 1

set.seed(2)
ccolhyb &lt;- sample(rainbow(length(volhyb)))

plot(sort(colSums(pavolhyb)/dim(pavolhyb)[1]), ylab=&quot;Occurence&quot;, main=&quot;Filtered Compound rarity&quot;)

venn &lt;- aggregate(pavolhyb, by=list(specp), FUN=max)
rownames(venn) &lt;- venn[,1]
venn[,1] &lt;- NULL
library(limma)
vennDiagram(t(as.matrix(venn)), circle.col=specscol)

##meanhyb &lt;- aggregate(volhyb, by=list(specp), FUN=mean)</code></pre>
<p>#Compounds Diversity</p>
<pre class="r"><code>library(beanplot)
library(vegan)

#Number of compounds
beanplot(rowSums(pavolhyb)~specp, las=2, log=&quot;&quot;, main=&quot;Number of compounds&quot;)</code></pre>
<p><img src="hybrids_cut_plots/diversity-1.svg" width="672" /></p>
<pre class="r"><code>anova(lm(rowSums(pavolhyb)~specp))</code></pre>
<pre><code>Analysis of Variance Table

Response: rowSums(pavolhyb)
           Df  Sum Sq Mean Sq F value Pr(&gt;F)
specp       2   61.39  30.693  2.0702 0.1305
Residuals 125 1853.23  14.826               </code></pre>
<pre class="r"><code>svhybn$num_compounds &lt;- rowSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])
(ncplot &lt;-   ggplot(svhybn, aes(x=SpeciesR, y=num_compounds, fill=SpeciesR))  +  
    geom_boxplot()+    theme_pubr() + 
    ylab(expression(&quot;Number of compounds&quot;)) + 
    scale_fill_manual(values=hybcolr) +guides(fill=&quot;none&quot;)+
    scale_x_discrete(&quot;Species&quot;, labels=(c(expression(italic(&quot;S. kaalae&quot;)), &quot;K x H&quot;, &quot;H x K&quot;, expression(italic(&quot;S. hookeri&quot;))))))</code></pre>
<p><img src="hybrids_cut_plots/diversity-2.svg" width="672" /></p>
<pre class="r"><code>#Shannon diversity
beanplot(diversity(volhybn, index=&quot;shannon&quot;)~specpn, main=&quot;Shannon diversity index&quot;)</code></pre>
<p><img src="hybrids_cut_plots/diversity-3.svg" width="672" /></p>
<pre class="r"><code>aggregate(diversity(volhybn, index=&quot;shannon&quot;), list(specpn), mean)</code></pre>
<pre><code>  Group.1        x
1    HOOK 2.111077
2    KAHO 1.694192
3    KAAL 1.575449</code></pre>
<pre class="r"><code>aggregate(diversity(volhybn, index=&quot;shannon&quot;), list(specpn), function(x) c(mean(x),sd(x)))</code></pre>
<pre><code>  Group.1       x.1       x.2
1    HOOK 2.1110774 0.3360307
2    KAHO 1.6941915 0.2261236
3    KAAL 1.5754492 0.2184687</code></pre>
<pre class="r"><code>svhybn$shannon &lt;- diversity(volhybn, index=&quot;shannon&quot;)
(shannon_plot &lt;-   ggplot(svhybn, aes(x=SpeciesR, y=shannon, fill=SpeciesR))  +  
    geom_boxplot()+    theme_pubr() + 
    ylab(expression(&quot;Shannon diversity index&quot;)) + 
    scale_fill_manual(&quot;Species&quot;, values=hybcolr) +guides(fill=&quot;none&quot;)+
    scale_x_discrete(&quot;Species&quot;, labels=(c(expression(italic(&quot;S. kaalae&quot;)), &quot;K x H&quot;, &quot;H x K&quot;, expression(italic(&quot;S. hookeri&quot;))))))</code></pre>
<p><img src="hybrids_cut_plots/diversity-4.svg" width="672" /></p>
<pre class="r"><code>library(gridExtra)
grid.arrange(teplot, ncplot, shannon_plot, nrow=1)</code></pre>
<p><img src="hybrids_cut_plots/diversity-5.svg" width="672" /></p>
<pre class="r"><code>#Big diversity plot
library(multcomp)
svhybn.long &lt;- svhybn %&gt;% dplyr::select(SpeciesR, ngftot, num_compounds, shannon) %&gt;% pivot_longer(-one_of(&quot;SpeciesR&quot;))
diversity_vars &lt;- list(&quot;ngftot&quot;, &quot;num_compounds&quot;, &quot;shannon&quot;)
tukeys &lt;- sapply(setNames(paste(diversity_vars, &#39; ~ SpeciesR&#39;), diversity_vars), 
       function(form) lm(form, data = svhybn) %&gt;% glht(linfct = mcp(SpeciesR=&quot;Tukey&quot;)) %&gt;% cld %&gt;% `$`(mcletters) %&gt;% `$`(Letters)) %&gt;% 
  as.data.frame %&gt;% tibble::rownames_to_column(&quot;SpeciesR&quot;) %&gt;% mutate(SpeciesR = factor(SpeciesR, levels=levels(svhybn$SpeciesR))) %&gt;% pivot_longer(-one_of(&quot;SpeciesR&quot;)) %&gt;% 
 left_join(svhybn.long  %&gt;%  group_by(name) %&gt;% 
  summarize(height = max(value) + .3 * sd(value)))

(diversity_plot &lt;-   ggplot(svhybn.long, aes(x=SpeciesR, y=value, fill=SpeciesR))  + 
    facet_wrap(&quot;name&quot;, scales=&quot;free_y&quot;, strip.position = &quot;left&quot;, nrow=1,
               labeller=as_labeller(c(ngftot = &quot;Volatile emissions (ng/flower/hr)&quot;, num_compounds=&quot;Number of compounds&quot;, shannon=&quot;Shannon diversity index&quot;)))+
    geom_text(aes(label=value,y=height), data=tukeys)+
    geom_boxplot()+    theme_pubr() + 
    scale_fill_manual(&quot;Species&quot;, values=hybcolr) +
    labs(y=NULL, x=NULL)+
    theme(strip.background = element_blank(), strip.placement = &quot;outside&quot;, strip.text = element_text(size=12),
          legend.position = &quot;bottom&quot;,
          axis.text.x=element_blank(), axis.ticks.x=element_blank()))</code></pre>
<p><img src="hybrids_cut_plots/diversity-6.svg" width="672" /></p>
<pre class="r"><code>ggsave(&quot;output/hybrids/diversity_yesoct_yeshex.png&quot;, diversity_plot, height=5, width =7, type=&quot;cairo&quot;) 
ggsave(&quot;output/hybrids/diversity_yesoct_yeshex.pdf&quot;, diversity_plot, height=5, width =7, device=cairo_pdf)

hchyb &lt;- hclust(vegdist(t(volhyb)), &quot;aver&quot;)
beanplot(treedive(volhyb, hchyb)~specp, main=&quot;Functional Diversity&quot;)</code></pre>
<p><img src="hybrids_cut_plots/diversity-7.svg" width="672" /></p>
<pre class="r"><code>beta &lt;- mean(vegdist(volhyb, binary=TRUE))
beta</code></pre>
<pre><code>[1] 0.4801858</code></pre>
<pre class="r"><code>raremax &lt;- min(rowSums(round(volhybn)))
rare &lt;- rarefy(round(volhybn), raremax)
#TODO:fix this. from intro to vegan ESA 2017
plot(specnumber(volhybn), rare, xlab = &quot;Observed No. of Species&quot;, ylab = &quot;Rarefied No. of Species&quot;)
abline(0,1)</code></pre>
<p><img src="hybrids_cut_plots/diversity-8.svg" width="672" /></p>
<pre class="r"><code>#rarecurve(round(volhybn), step=20, sample = raremax, col=&quot;blue&quot;, cex=0.6)</code></pre>
<p>#Heatmap</p>
<pre class="r"><code>set.seed(1)
mdshybn1 &lt;- metaMDS(decostand(ngvolhybn, method=&quot;hellinger&quot;),k=1,try=200, autotransform=F, trace=0)
mdshybn1</code></pre>
<pre><code>
Call:
metaMDS(comm = decostand(ngvolhybn, method = &quot;hellinger&quot;), k = 1,      try = 200, autotransform = F, trace = 0) 

global Multidimensional Scaling using monoMDS

Data:     decostand(ngvolhybn, method = &quot;hellinger&quot;) 
Distance: bray 

Dimensions: 1 
Stress:     0.2160703 
Stress type 1, weak ties
Best solution was not repeated after 20 tries
The best solution was from try 0 (metric scaling or null solution)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on &#39;decostand(ngvolhybn, method = &quot;hellinger&quot;)&#39; </code></pre>
<pre class="r"><code>library(seriation)
callback = function(hc, mat){
    sv = svd(t(mat))$v[,1]
    dend = reorder(as.dendrogram(hc), wts = sv)
    as.hclust(dend)
}
library(dendsort)
library(pheatmap)
library(viridis)
library(grid)
mincount &lt;- 15
srt &lt;- order(svhybn$SpeciesR, -mdshybn1$points, decreasing=T)
rn &lt;- rownames(volhyb[svhyb$DN==&quot;Night&quot;,colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])&gt;mincount])

###TODO MIGHT BE A BUG HERE see schiedea_gc.R globosa heatmap. annotations are using row.names=rn and matching them up somehow
#changed to ng/hr
#cairo_pdf(&quot;output/hybrids/hybheatmap4_4_ng.pdf&quot;, width=10.5, height=7.6)#10.5, 5.2
png(&quot;output/hybrids/hybheatmap4_4_ng.png&quot;, width=10.5, height=7.6, units=&quot;in&quot;, res=500)
ph  &lt;- pheatmap(as.matrix(t(ngfvolhyb[svhyb$DN==&quot;Night&quot;,colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])&gt;mincount][srt,]))^(1/3), 
         cluster_cols=F, show_colnames=F,
         clustering_method=&quot;mcquitty&quot;, clustering_distance_rows=&quot;correlation&quot;,
         clustering_callback = function(hc, ...){dendsort(hc, type=&quot;average&quot;)},
         scale=&quot;none&quot;, color=inferno(512),
         annotation_col = data.frame(Species=as.integer(svhyb$SpeciesR[svhyb$DN==&quot;Night&quot;])[srt], row.names=rn), 
         annotation_colors = list(Species=hybcolr), 
         gaps_col = which(as.logical(diff(as.integer(svhyb$SpeciesR[svhyb$DN==&quot;Night&quot;])[srt]))),
   cellwidth = 3.5, cellheight = 14, fontsize = 10, border_color = NA, legend=F, legend_breaks=NA, annotation_legend=F, cutree_rows=5
)
grid.text(rev(levels(svhyb$SpeciesR))[c(1,4)], x=c(0.165,0.54),y=0.964, gp=gpar(fontsize=10, col=&quot;white&quot;, fontface=4))
grid.text(rev(levels(svhyb$SpeciesR))[c(2,3)], x=c(0.317,0.417),y=0.964, gp=gpar(fontsize=10, col=&quot;white&quot;, fontface=2))
dev.off()</code></pre>
<pre><code>png 
  3 </code></pre>
<p>#Boxplots</p>
<pre class="r"><code>#changed to ng/hr
mincount &lt;- 23
mfvolhyb &lt;- ngfvolhyb[svhyb$DN==&quot;Night&quot;,colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])&gt;mincount]
mfvolhyb$Species &lt;- svhyb$SpeciesR[svhyb$DN==&quot;Night&quot;]
library(reshape2)
meltfvolhyb &lt;- melt(mfvolhyb, id.vars=c(&quot;Species&quot;))

#put chemicals in order of NMDS
set.seed(1)
mdshybn1 &lt;- metaMDS(decostand(sqrt(ngvolhybn), method=&quot;tot&quot;),k=1,try=200, autotransform=F, trace=0)
mdshybn1</code></pre>
<pre><code>
Call:
metaMDS(comm = decostand(sqrt(ngvolhybn), method = &quot;tot&quot;), k = 1,      try = 200, autotransform = F, trace = 0) 

global Multidimensional Scaling using monoMDS

Data:     decostand(sqrt(ngvolhybn), method = &quot;tot&quot;) 
Distance: bray 

Dimensions: 1 
Stress:     0.2205975 
Stress type 1, weak ties
Best solution was not repeated after 20 tries
The best solution was from try 0 (metric scaling or null solution)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on &#39;decostand(sqrt(ngvolhybn), method = &quot;tot&quot;)&#39; </code></pre>
<pre class="r"><code>meltfvolhyb$variable &lt;- reorder(meltfvolhyb$variable, -mdshybn1$species[match(meltfvolhyb$variable, row.names(mdshybn1$species))])
levels(meltfvolhyb$variable)[match(c(&quot;(3E)-4,8-dimethylnona-1,3,7-triene&quot;,
                                     &quot;2,2,6-trimethylcyclohexane-1,4-dione&quot;,
                                     &quot;4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde&quot;) , levels(meltfvolhyb$variable)) ] &lt;- c(&quot;DMNT&quot;,                       &quot;2,2,6-trimethylcyclohexane-\n1,4-dione&quot;,
                                     &quot;4-hydroxy-2,6,6-trimethyl-\n3-oxocyclohexene-\n1-carbaldehyde&quot;)

ggplot(meltfvolhyb) + geom_boxplot(aes(x=Species, y=value, color=Species),  outlier.size=1) + 
  facet_wrap(vars(variable), scales=&quot;free_y&quot;, ncol=4, labeller = labeller(variable = label_wrap_gen(18))) +
  scale_color_manual(values=hybcolr) +
  scale_y_sqrt(&quot;Emission rate (ng/flower/hr)&quot;) + theme_minimal() + #, labels=scientific_10
  theme(axis.text.x=element_blank(), axis.title.x=element_blank(), panel.grid.major.x=element_blank(), legend.position = &quot;top&quot;)</code></pre>
<p><img src="hybrids_cut_plots/boxplots-1.svg" width="672" /></p>
<pre class="r"><code>ggsave(&quot;output/hybrids/hyb_boxplots_ng.pdf&quot;, device=cairo_pdf, width=9, height=12)
ggsave(&quot;output/hybrids/hyb_boxplots_ng.png&quot;, width=9, height=12)

library(broom)
halfway &lt;- meltfvolhyb %&gt;% filter(Species %in% c(&quot;S. hookeri&quot;, &quot;S. kaalae&quot;)) %&gt;% 
  group_by(Species, variable) %&gt;% summarize(specmean = mean(value)) %&gt;% 
  group_by(variable) %&gt;% summarize(parentmean = mean(specmean))
test.halfway &lt;- meltfvolhyb %&gt;% filter(!Species %in% c(&quot;S. hookeri&quot;, &quot;S. kaalae&quot;)) %&gt;% #just hybrids
  dplyr::select(-Species) %&gt;%  group_by(variable) %&gt;% nest() %&gt;% 
  left_join(halfway) %&gt;% 
  mutate(model = map2(data, parentmean, 
                      function(dat, testagainst) tidy(t.test(pull(dat, value), mu=testagainst)))) %&gt;% 
  dplyr::select(-data) %&gt;% unnest(model)

ggplot(meltfvolhyb) +  geom_boxplot(aes(x=Species, y=value, color=Species),  outlier.size=1) + 
  facet_wrap(vars(variable), scales=&quot;free_y&quot;, ncol=4, labeller = labeller(variable = label_wrap_gen(18))) +
  geom_text(data=test.halfway, aes(x=2.5, y=0, label=if_else(p.value &lt;0.05, as.character(round(estimate, 2)), &quot;&quot;)))+
  geom_pointrange(data=test.halfway, aes(x=2.3, y=estimate, ymin=conf.low, ymax=conf.high))+
  geom_point(data=test.halfway, aes(x=2.7, y=parentmean, color=&quot;blue&quot;))+
  scale_color_manual(values=hybcolr) +
  scale_y_sqrt(&quot;Emission rate (ng/flower/hr)&quot;) + theme_minimal() + #, labels=scientific_10
  theme(axis.text.x=element_blank(), axis.title.x=element_blank(), panel.grid.major.x=element_blank(), legend.position = &quot;top&quot;)</code></pre>
<p><img src="hybrids_cut_plots/boxplots-2.svg" width="672" /></p>
<pre class="r"><code>library(RColorBrewer)
my_palette &lt;- colorRampPalette(c(&quot;white&quot;, &quot;darkblue&quot;))(n=999)
#my_palette &lt;- brewer.pal(9, &quot;YlOrRd&quot;)
heatmap(log10(as.matrix(volhyb[,colSums(volhyb)&gt;10000])+1),Rowv=specp,Colv=sort(rowSums(volhyb)), RowSideColors=hybcol[as.integer(svhyb$Population)], margins=c(18,4), scale=&quot;none&quot;, col=my_palette)</code></pre>
<p><img src="hybrids_cut_plots/heatmap_misc-1.svg" width="672" /></p>
<pre class="r"><code>hybcolg &lt;- c(&quot;red&quot;,&quot;green&quot;,&quot;red&quot;,&quot;red&quot;,&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;,&quot;red&quot;, &quot;green&quot;)
heatmap(log10(as.matrix(volhyb[,colSums(pavolhyb)&gt;10][order(specp, svhyb$Population),])+1),Rowv=NA,Colv=sort(rowSums(volhyb)), RowSideColors=hybcolg[as.integer(svhyb$Population)][order(specp, svhyb$Population)], margins=c(20,0), scale=&quot;none&quot;, col=my_palette, labRow=NA)</code></pre>
<p><img src="hybrids_cut_plots/heatmap_misc-2.svg" width="672" /></p>
<pre class="r"><code>colMax &lt;- function(data) sapply(data, max, na.rm = TRUE)

heatmap(log10(as.matrix(volhyb[svhyb$DN==&quot;Night&quot;,colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])&gt;10][order(specp[svhyb$DN==&quot;Night&quot;], svhyb$Population[svhyb$DN==&quot;Night&quot;]),])+1),Rowv=NA,Colv=sort(rowSums(volhyb[svhyb$DN==&quot;Night&quot;,])), RowSideColors=hybcolg[as.integer(svhyb$Population[svhyb$DN==&quot;Night&quot;])][order(specp[svhyb$DN==&quot;Night&quot;], svhyb$Population[svhyb$DN==&quot;Night&quot;])], margins=c(20,0), scale=&quot;none&quot;, col=my_palette, labRow=NA, distfun=vegdist)</code></pre>
<p><img src="hybrids_cut_plots/heatmap_misc-3.svg" width="672" /></p>
<pre class="r"><code># &amp; colMax(volhyb[svhyb$DN==&quot;Night&quot;,])&gt;1000

library(gplots)
my_palette2 &lt;- colorRampPalette(c(&quot;white&quot;, &quot;darkblue&quot;))
sep &lt;- diff(as.integer(as.factor(hybcolg[as.integer(svhyb$Population[svhyb$DN==&quot;Night&quot;])][order(specp[svhyb$DN==&quot;Night&quot;], svhyb$Population[svhyb$DN==&quot;Night&quot;])])))!=0

srt &lt;- order(specpn,svhybn$Population, rowSums(volhybn))
set.seed(1)
mdshybn1 &lt;- metaMDS(decostand(sqrt(volhybn), method=&quot;tot&quot;),k=1,try=200, autotransform=F, trace=0)
mdshybn1</code></pre>
<pre><code>
Call:
metaMDS(comm = decostand(sqrt(volhybn), method = &quot;tot&quot;), k = 1,      try = 200, autotransform = F, trace = 0) 

global Multidimensional Scaling using monoMDS

Data:     decostand(sqrt(volhybn), method = &quot;tot&quot;) 
Distance: bray 

Dimensions: 1 
Stress:     0.2065236 
Stress type 1, weak ties
Best solution was not repeated after 20 tries
The best solution was from try 0 (metric scaling or null solution)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on &#39;decostand(sqrt(volhybn), method = &quot;tot&quot;)&#39; </code></pre>
<pre class="r"><code>srt &lt;- order(svhybn$SpeciesR, -mdshybn1$points, decreasing=T)

library(viridisLite)
#order(specp[svhyb$DN==&quot;Night&quot;], svhyb$Population[svhyb$DN==&quot;Night&quot;])
mincount &lt;- 10
png(file = &quot;output/hybrids/hybheatmap3_4.png&quot;, bg = &quot;white&quot;, width=1600,height=2400) 
  par(lwd=6)
hybhm &lt;- heatmap.2(as.matrix(volhyb[svhyb$DN==&quot;Night&quot;,colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])&gt;mincount][srt,])^(1/3),
          RowSideColors=hybcolg[as.integer(svhyb$Population[svhyb$DN==&quot;Night&quot;])][srt], 
          Rowv=F,Colv=order(colMeans(volhyb[svhyb$DN==&quot;Night&quot;,colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])&gt;mincount])),
          margins=c(98,0), trace=&quot;none&quot;, scale=&quot;none&quot;, col=magma(512), labRow=NA, dendrogram=&quot;column&quot;, key=F,keysize=0.3,
          sepcol=&quot;white&quot;,rowsep=which(sep,T), cexCol=5,
          distfun=function(x){dist(x)}, 
          hclustfun=function(x){hclust(x, method=&quot;mcquitty&quot;)})
dev.off() #margin 54,0</code></pre>
<pre><code>devSVG 
     2 </code></pre>
<pre class="r"><code>#Colv=order(colSums(volhyb[svhyb$DN==&quot;Night&quot;,]))

png(file = &quot;output/hybrids/parheatmap4.png&quot;, bg = &quot;white&quot;, width=800,height=1200)
heatmap.2(as.matrix(svolhyb[svhyb$DN==&quot;Night&quot;,colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])&gt;10][order(specp[svhyb$DN==&quot;Night&quot;], svhyb$Population[svhyb$DN==&quot;Night&quot;]),]),
          RowSideColors=hybcolg[as.integer(svhyb$Population[svhyb$DN==&quot;Night&quot;])][order(specp[svhyb$DN==&quot;Night&quot;], svhyb$Population[svhyb$DN==&quot;Night&quot;])], 
          Rowv=F,Colv=order(colMeans(volhyb[svhyb$DN==&quot;Night&quot;,colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])&gt;10])),
          margins=c(54,0), trace=&quot;none&quot;, scale=&quot;none&quot;, col=my_palette2, labRow=NA, dendrogram=&quot;column&quot;, key=F,keysize=0.3,
          sepcol=&quot;black&quot;,rowsep=which(sep,T), cexCol=2, 
          distfun=function(x){dist(x)}, 
          hclustfun=function(x){hclust(x, method=&quot;mcquitty&quot;)})
dev.off()</code></pre>
<pre><code>devSVG 
     2 </code></pre>
<p>#NMDS scree</p>
<pre class="r"><code>NMDS.scree&lt;-function(x) { #where x is the name of the data frame variable
plot(rep(1,10),replicate(10,metaMDS(x,autotransform=F,k=1)$stress),xlim=c(1,nrow(x)/10),ylim=c(0,0.5),xlab=&quot;# of Dimensions&quot;,ylab=&quot;Stress&quot;,main=&quot;NMDS stress plot&quot;)
for (i in 1:(nrow(x)/10-2)) {
points(rep(i+1,1),replicate(1,metaMDS(x,autotransform=F,k=i+1)$stress))
}
}
NMDS.scree(wisconsin(sqrt(volhyb)))</code></pre>
<p>#NMDS plot</p>
<pre class="r"><code>set.seed(1)
mdshyb3 &lt;- metaMDS(volhyb,k=3,try=100, autotransform=T, trace=0)
mdshyb3
ordirgl(mdshyb3, col=hybcol[svhyb$Population])</code></pre>
<pre class="r"><code>set.seed(1)
mdshybn &lt;- metaMDS(decostand(volhybn, method=&quot;hellinger&quot;),k=2,try=200, autotransform=F, trace=0)
mdshybn</code></pre>
<pre><code>
Call:
metaMDS(comm = decostand(volhybn, method = &quot;hellinger&quot;), k = 2,      try = 200, autotransform = F, trace = 0) 

global Multidimensional Scaling using monoMDS

Data:     decostand(volhybn, method = &quot;hellinger&quot;) 
Distance: bray 

Dimensions: 2 
Stress:     0.1159628 
Stress type 1, weak ties
Best solution was not repeated after 20 tries
The best solution was from try 10 (random start)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on &#39;decostand(volhybn, method = &quot;hellinger&quot;)&#39; </code></pre>
<pre class="r"><code>##### Base R plot #####
#par(mar=c(0,0,0,0), bg=&quot;grey20&quot;, mfrow=c(1,1))
png(filename=&quot;output/hybrids/hybnmdsnight3_time_lumped.png&quot;, height=1200, width=1200)
par(cex=2)
ophyb &lt;- ordiplot(mdshybn, type=&quot;n&quot;, ylim=c(min(mdshybn$points[,2]),max(mdshybn$points[,2])), xlim=c(min(mdshybn$points[,1]),max(mdshybn$points[,1])+0.1))
#points(ophyb, what=&quot;species&quot;, col=&quot;grey80&quot;, select=sapply(volhybn, max)&gt;0.01, pch=4, cex=sqrt(sapply(volhybn, max))/100)
ordicross &lt;- ordihull(mdshybn, groups = as.factor(hybplantsn), col=&quot;gray80&quot;, lwd=4) #Same cross or parental genotype 
ordihybparents &lt;- ordihull(mdshybn, groups = as.factor(hybparentsn), col=&quot;gray40&quot;, lwd=4) #Same parental genotype
ordihull(mdshybn, groups = as.factor(hybplantsin), col=&quot;black&quot;, lwd=4)#same hybplantsiidual 
#ordihull(mdshybn, groups = as.factor(hybplantsdnn), col=&quot;brown&quot;, lwd=4)#same inflo day/night 
ordihull(mdshybn, groups = as.factor(hybplantsinflon), col=&quot;red&quot;, lwd=4.5)# same inflo, same time 
#points(ophyb, what=&quot;sites&quot;, col=hybcol[as.integer(svhybn$Population)], pch=ifelse(svhybn$DN == &quot;Day&quot;,17,19),cex=sqrt(rowSums(  volhybn))/300+0.5)
#hybcolg&lt;- c(&quot;red&quot;,&quot;green&quot;,&quot;red&quot;,&quot;red&quot;,&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;,&quot;red&quot;, &quot;green&quot;)
#points(ophyb, what=&quot;sites&quot;, col=hybcolg[as.integer(svhybn$Population)], pch=ifelse(svhybn$DN == &quot;Day&quot;,17,19),cex=1)
#text(ophyb, what=&quot;sites&quot;, col=hybcolg[as.integer(svhybn$Population)], labels=svhybn$Cutting, cex=0.7)
points(ophyb, what=&quot;sites&quot;, col=hybcolr[as.integer(svhybn$SpeciesR)], pch=19,cex=1)
legend(&quot;topright&quot;,legend=levels(svhybn$SpeciesR), fill=hybcolr, cex=1.5, text.col=&quot;black&quot;)
text(ophyb, what=&quot;species&quot;, select = colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])&gt;30, col=&quot;magenta&quot;, labels=rank(-colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,]), ties.method=&quot;first&quot;), cex=1.2, font=2)
#legend(&quot;topright&quot;,legend=levels(as.factor(paste(svhybn$Population,svhybn$Species))), fill=hybcol, cex=0.8, text.col=&quot;black&quot;)
dev.off()</code></pre>
<pre><code>devSVG 
     2 </code></pre>
<pre class="r"><code>##### 2dnmdsnight ggplot #####
library(ggpubr)
library(ggvegan)
library(ggordiplots)
library(ggrepel)
hullcross &lt;- gg_ordiplot(mdshybn, groups = as.factor(hybplantsn), plot=F)$df_hull
hullparents &lt;- gg_ordiplot(mdshybn, groups = as.factor(hybparentsn), plot=F)$df_hull
hullplantsi &lt;- gg_ordiplot(mdshybn, groups = as.factor(hybplantsin), plot=F)$df_hull
hullplantsinflo &lt;- gg_ordiplot(mdshybn, groups = as.factor(hybplantsinflon), plot=F)$df_hull
hullplantsinflodate &lt;- gg_ordiplot(mdshybn, groups = as.factor(hybplantsinflodaten), plot=F)$df_hull

obj &lt;- fortify(mdshybn)
obj$Sample &lt;- NA; obj$Sample[obj$score==&quot;sites&quot;] &lt;-  svhybn$Sample
obj &lt;- obj %&gt;% left_join(svhybn %&gt;% dplyr::select(c(Sample, SpeciesR, plants, parents, plantsi, plantsinflo, plantsinflodate, StartSunset))) %&gt;% mutate(StartSunset = as.numeric(StartSunset))
obj$occur &lt;- NA; obj$occur[obj$score==&quot;species&quot;] &lt;- colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])
obj$ftotal &lt;- NA; obj$ftotal[obj$score==&quot;species&quot;] &lt;- colSums(fvolhyb[svhyb$DN==&quot;Night&quot;,])
obj &lt;- obj %&gt;% arrange(NMDS2, NMDS1)

(hybnplot &lt;- ggplot(obj, aes(x=NMDS1, y=NMDS2)) + 
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=plants, color=&quot;cross&quot;), size=1) +
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=parents, color=&quot;parents&quot;), size=1) +
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=plantsi, color=&quot;plantsi&quot;), size=1) +
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=plantsinflo, color=&quot;plantsinflo&quot;), size=1) +
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=plantsinflodate, color=&quot;plantsinflodate&quot;), size=1) +
  scale_color_manual(&quot;&quot;,breaks=c(&quot;cross&quot;,&quot;parents&quot;,&quot;plantsi&quot;,&quot;plantsinflo&quot;,&quot;plantsinflodate&quot;), labels=c(&quot;Cross&quot;,&quot;Clone&quot;,&quot;Plant&quot;,&quot;Inflorescence&quot;,&quot;Bag&quot;), values=c(cross=&quot;grey90&quot;, parents=&quot;grey60&quot;, plantsi=&quot;grey30&quot;, plantsinflo=brewer.pal(6,&quot;Set1&quot;)[6],plantsinflodate=brewer.pal(6,&quot;Set1&quot;)[1],sites=&quot;white&quot;,species=NA)) +
      coord_fixed(xlim=range(obj$NMDS1[obj$score==&quot;sites&quot;])+c(-0.2,0.6), 
                  ylim=range(obj$NMDS2[obj$score==&quot;sites&quot;])) + theme_pubr()+
    #scale_x_reverse(expand=c(0,0),labels=function(x) -x, breaks=c(-1,-0.5,0,0.5,1)) +
    scale_x_continuous(expand=c(0,0))+
    theme(legend.text = element_text(size=13)) + 
    guides(fill = guide_legend(override.aes = list(size=6)), color=guide_legend(override.aes=list(size=3))))</code></pre>
<p><img src="hybrids_cut_plots/2dnmdsnight-1.svg" width="960" /></p>
<pre class="r"><code>(hybplotn.spec &lt;- hybnplot + 
        scale_fill_manual(&quot;&quot;, values=hybcolr, labels=c(expression(italic(&quot;S. kaalae&quot;)),&quot;K x H&quot;, &quot;H x K&quot;, expression(italic(&quot;S. hookeri&quot;))),  na.translate=F) +
  geom_point(data=obj[obj$score==&quot;sites&quot;,], aes(fill=SpeciesR), shape=21, size=3, color=&quot;white&quot;) +
    geom_text(data=obj[obj$score==&quot;species&quot; &amp; obj$ftotal&gt;1.5e4 &amp; obj$occur&gt;nrow(volhybn)*0.20,], aes(label=label), color=&quot;black&quot;, size=3.8) ) </code></pre>
<p><img src="hybrids_cut_plots/2dnmdsnight-2.svg" width="960" /></p>
<pre class="r"><code>ggsave(&quot;output/hybrids/hybnmdsnight3.pdf&quot;, hybplotn.spec, height=8, width=10, device=cairo_pdf)
ggsave(&quot;output/hybrids/hybnmdsnight3.png&quot;, hybplotn.spec, height=8, width=10)


(hybnplot.time &lt;- hybnplot + scale_fill_viridis_c(&quot;Time after sunset (h)&quot;, direction=-1) + 
  geom_point(data= obj[obj$score==&quot;sites&quot;,], aes(fill=StartSunset), shape=21, size=3, color=&quot;white&quot;))</code></pre>
<p><img src="hybrids_cut_plots/2dnmdsnight-3.svg" width="960" /></p>
<pre class="r"><code>(hybnplot.points &lt;- ggplot(obj, aes(x=-NMDS1, y=NMDS2)) + 
  scale_fill_manual(&quot;&quot;, values=hybcolr, labels=c(expression(italic(&quot;S. kaalae&quot;)),&quot;K x H&quot;, &quot;H x K&quot;, expression(italic(&quot;S. hookeri&quot;))),  na.translate=F) +
  geom_point(data=obj[obj$score==&quot;sites&quot;,], aes(fill=SpeciesR), shape=21, size=4, color=&quot;white&quot;)+
     theme_pubr()+theme(legend.text = element_text(size=20)) + xlab(&quot;NMDS1&quot;)+
    guides(fill = guide_legend(override.aes = list(size=10))))</code></pre>
<p><img src="hybrids_cut_plots/2dnmdsnight-4.svg" width="960" /></p>
<pre class="r"><code>ggsave(&quot;output/hybrids/hybnmdsnight3nolines.png&quot;, hybnplot.points, height=8, width=10)

(hybnplot &lt;- ggplot(obj, aes(x=NMDS1, y=NMDS2)) + 
  geom_path(data=hullplantsi, aes(x=x,y=y, group=Group, col=&quot;plantsi&quot;), size=1.5, inherit.aes = F) +
  geom_path(data=hullplantsinflo, aes(x=x,y=y, group=Group, col=&quot;plantsinflo&quot;), size=1.5, inherit.aes = F) +
  geom_path(data=hullplantsinflodate, aes(x=x,y=y, group=Group, col=&quot;plantsinflodate&quot;), size=1.5, inherit.aes = F) +
  scale_color_manual(&quot;&quot;,breaks=c(&quot;cross&quot;,&quot;parents&quot;,&quot;plantsi&quot;,&quot;plantsinflo&quot;,&quot;plantsinflodate&quot;), labels=c(&quot;Cross&quot;,&quot;Clone&quot;,&quot;Plant&quot;,&quot;Inflorescence&quot;,&quot;Bag&quot;), values=c(cross=&quot;grey90&quot;, parents=&quot;grey70&quot;, plantsi=&quot;grey70&quot;, plantsinflo=&quot;grey40&quot;,plantsinflodate=&quot;grey10&quot;,sites=&quot;white&quot;,species=NA)) +
      coord_fixed(xlim=range(obj$NMDS1[obj$score==&quot;sites&quot;])+c(-0.1,0.5), ylim=range(obj$NMDS2[obj$score==&quot;sites&quot;])) + theme_pubr()+
    scale_x_reverse(expand=c(0,0),labels=function(x) -x, breaks=c(-1,-0.5,0,0.5,1)) +
    theme(legend.text = element_text(size=13)) + 
    guides(fill = guide_legend(override.aes = list(size=6)), color=guide_legend(override.aes=list(size=3))))</code></pre>
<p><img src="hybrids_cut_plots/2dnmdsnight-5.svg" width="960" /></p>
<pre class="r"><code>(hybplotn.spec.notext &lt;- hybnplot + scale_fill_manual(&quot;&quot;, values=hybcolr, na.translate=F) +
  geom_point(data=obj[obj$score==&quot;sites&quot;,], aes(fill=SpeciesR), shape=21, size=4, color=&quot;white&quot;) ) </code></pre>
<p><img src="hybrids_cut_plots/2dnmdsnight-6.svg" width="960" /></p>
<pre class="r"><code>ggsave(&quot;output/hybrids/hybnmdsnight3notext.png&quot;, hybplotn.spec.notext, height=7, width=9)


#ophyb &lt;- ordiplot(mdshyb, type=&quot;n&quot;, xlim=c(min(mdshyb$points[,1]),max(mdshyb$points[,1])),ylim=c(min(mdshyb$points[,2]),max(mdshyb$points[,2])))
#text(ophyb, what=&quot;species&quot;, col=&quot;white&quot;, select=sapply(volhyb, max)&gt;0.01, cex=sapply(volhyb, max)/100000)
#text(ophyb, what=&quot;sites&quot;, labels=hybplants, col=hybcol[as.integer(svhyb$Population)], cex=0.7)
#points(ophyb, what=&quot;sites&quot;, col=hybcol[as.integer(svhyb$Population)], pch=ifelse(svhyb$Start &lt; 55000,1,19),cex=1.5)
#ordihull(mdshyb, groups = svhyb$Population, col=hybcol, lwd=2)# same population
#text(ophyb, what=&quot;sites&quot;, labels=svhyb$Sample, cex=0.7)</code></pre>
<p>#Bar chart</p>
<pre class="r"><code>mvolhyb &lt;- volhyb
mvolhyb$specp &lt;- specp
library(reshape2)
meltvolhyb &lt;- melt(mvolhyb, id.vars=c(&quot;specp&quot;))
par(mar=c(15,2,1,0))
plot(log10(meltvolhyb$value+1)~meltvolhyb$variable, border=&quot;white&quot;, las=2, cex.axis=0.5, cex.lab=0.1, main=&quot;log compound amount per flower&quot;)
points(log10(meltvolhyb$value+1)~meltvolhyb$variable, col=meltvolhyb$specp)</code></pre>
<p><img src="hybrids_cut_plots/barchart-1.svg" width="672" /></p>
<pre class="r"><code>par(mar=c(5,0,0,0), mfrow=c(2,1))
srt &lt;- order(specp, svhyb$Population, rowSums(volhyb))
bp &lt;- barplot(t(as.matrix(volhyb[srt,])), col=ccolhyb, border=NA, names.arg=paste(specp,svhyb$Population)[srt], col.axis=&quot;black&quot;, cex.names=0.8, axes=FALSE, las=2)


srt &lt;- order(svhyb$StartSunset)
# srt &lt;- srt[specp[srt]==&quot;HOOK&quot;]
# srt &lt;- srt[specp[srt]==&quot;KAAL&quot;]
bp &lt;- barplot(t(as.matrix(volhyb[srt,])), col=ccolhyb, border=NA, names.arg=paste(specp,signif(svhyb$StartSunset,2))[srt], col.axis=&quot;black&quot;, cex.names=0.8, axes=FALSE, las=2)

points(x=bp, y=rep(-10000, length(bp)), xpd=T, pch=ifelse(svhyb$DN == &quot;Day&quot;,1,19)[srt])
svhyb$DTN &lt;- svhyb$DN
levels(svhyb$DTN) &lt;- c(&quot;Day&quot;,&quot;Night&quot;,&quot;Afternoon&quot;)
svhyb$DTN[svhyb$DN ==&quot;Day&quot; &amp; svhyb$Start &gt;3600*16] &lt;- &quot;Afternoon&quot;

points(x=bp, y=rep(-1000000, length(bp)), xpd=T, pch=as.integer(svhyb$DTN)[srt])</code></pre>
<p><img src="hybrids_cut_plots/barchart-2.svg" width="672" /></p>
<pre class="r"><code>set.seed(1)
mdshybn1 &lt;- metaMDS(decostand(sqrt(volhybn), method=&quot;tot&quot;),k=1,try=200, autotransform=F, trace=0)
mdshybn1</code></pre>
<pre><code>
Call:
metaMDS(comm = decostand(sqrt(volhybn), method = &quot;tot&quot;), k = 1,      try = 200, autotransform = F, trace = 0) 

global Multidimensional Scaling using monoMDS

Data:     decostand(sqrt(volhybn), method = &quot;tot&quot;) 
Distance: bray 

Dimensions: 1 
Stress:     0.2065236 
Stress type 1, weak ties
Best solution was not repeated after 20 tries
The best solution was from try 0 (metric scaling or null solution)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on &#39;decostand(sqrt(volhybn), method = &quot;tot&quot;)&#39; </code></pre>
<pre class="r"><code>srt &lt;- order(specpn,svhybn$Population, rowSums(volhybn))
srt &lt;- order(specpn, mdshybn1$points)
srt &lt;- order(mdshybn$points[,1])
srt &lt;- order(atan(mdshybn$points[,1]/(mdshybn$points[,2]+0.2)))
par(mar=c(2,0,1,0))

png(file = &quot;output/hybrids/barplot3.png&quot;, bg = &quot;white&quot;, width=1600,height=1200)
barplot(t(as.matrix(svolhybn[srt,])), col=ccolhyb, border=NA, col.axis=&quot;black&quot;, axisnames=T, axes=FALSE, las=2, names.arg=specpn[srt])
dev.off()</code></pre>
<pre><code>devSVG 
     2 </code></pre>
<pre class="r"><code>par(mfrow=c(1,1))
plot.new()
topn &lt;- names(head(sort(colSums(volhyb), decreasing=T), n=10))
legend(&quot;center&quot;, topn, fill=ccolhyb[order(colSums(volhyb), decreasing=T)], xpd=T, cex=70/max(nchar(topn)))</code></pre>
<p><img src="hybrids_cut_plots/barchart-3.svg" width="672" /></p>
<pre class="r"><code>#TODO:  lumping with hybparentsn doesn&#39;t work!!!
#take the centroid for each plant (lump plant, inflorescence, bag, but not clones)
obj.lump.sites &lt;- obj %&gt;% 
  filter(score==&quot;sites&quot;) %&gt;% 
  mutate(hybparentsn=hybparentsn, hybplantsn=hybplantsn, hybplantsin=hybplantsin) %&gt;% 
  mutate_if(is.character, as.factor) %&gt;%
  group_by(score, label, SpeciesR, hybplantsn, hybparentsn, hybplantsin) %&gt;% 
  summarize_if(is.numeric, mean)

obj.lump &lt;- bind_rows(obj.lump.sites, obj %&gt;% filter(score!=&quot;sites&quot;))

(hybnplot &lt;- ggplot(obj.lump, aes(x=NMDS1, y=NMDS2)) + 
    coord_fixed(xlim=range(obj.lump$NMDS1[obj$score==&quot;sites&quot;])+c(-0.1,0.5), ylim=range(obj.lump$NMDS2[obj.lump$score==&quot;sites&quot;])) + 
    theme_pubr()+
    scale_x_continuous(expand=c(0,0),breaks=c(-1,-0.5,0,0.5,1))+
    #scale_x_reverse(expand=c(0,0),labels=function(x) -x, breaks=c(-1,-0.5,0,0.5,1)) +
    theme(legend.text = element_text(size=13)) + 
    guides(fill = guide_legend(override.aes = list(size=5)), color=guide_legend(override.aes=list(size=3))))</code></pre>
<p><img src="hybrids_cut_plots/2dnmdsnightcentroid-1.svg" width="672" /></p>
<pre class="r"><code>library(ggrepel)
(hybplotn.spec &lt;- hybnplot + 
    scale_fill_manual(&quot;&quot;, values=hybcolr, labels=c(expression(italic(&quot;S. kaalae&quot;)),&quot;K x H&quot;, &quot;H x K&quot;, expression(italic(&quot;S. hookeri&quot;))),  na.translate=F) +
      scale_color_manual(&quot;&quot;,breaks=c(&quot;cross&quot;,&quot;parents&quot;), labels=c(&quot;Cross&quot;,&quot;Clone&quot;), values=c(cross=&quot;grey90&quot;, parents=&quot;grey40&quot;)) +
    geom_path(data=obj.lump[obj.lump$score==&quot;sites&quot;,],aes(group=hybplantsn, color=&quot;cross&quot;), size=1) +
    geom_path(data=obj.lump[obj.lump$score==&quot;sites&quot;,],aes(group=hybparentsn, color=&quot;parents&quot;), size=1) +
    geom_point(data=obj.lump[obj.lump$score==&quot;sites&quot;,], aes(fill=SpeciesR), shape=21, size=2.5, color=&quot;white&quot;) +
    geom_text_repel(data=obj.lump[obj.lump$score==&quot;species&quot; &amp; obj.lump$ftotal&gt;1.5e4 &amp; obj.lump$occur&gt;nrow(volhybn)*0.20,], aes(label=label), color=&quot;black&quot;, fontface=&quot;bold&quot;, alpha=0.5, point.padding=0, box.padding=0, seed=0) ) </code></pre>
<p><img src="hybrids_cut_plots/2dnmdsnightcentroid-2.svg" width="672" /></p>
<pre class="r"><code>ggsave(&quot;output/hybrids/hybnmdsnight3_lump_plant.png&quot;, hybplotn.spec, height=8, width=10)
ggsave(&quot;output/hybrids/hybnmdsnight3_lump_plant.pdf&quot;, hybplotn.spec, height=8, width=10, device=cairo_pdf)</code></pre>
<pre class="r"><code>svhybn$Individual</code></pre>
<pre><code>  [1] hookeri 879WKG N-5 -              kaho HH NA NA                    
  [3] kaho HH 866-2 x 879-G-2 91-8      kaho HH 866-2 x 794-4 93-6       
  [5] kaho HH 794-4 x 866-2 79-21       kaho HH 879-2-2 x 879-G-2 1-15   
  [7] kaho HH 879-10-1 x 899-2E- 1 22-4 kaho HH 866-2 x 879-2-2 89-6     
  [9] kaho HH 866-2 x 879-2-2 89-2      kaho HH 866-2 x 794-4 93-20      
 [11] kaho HH 879-N-5 x 879-G-2 47-1    kaho HH 879-2-2 x 879-G-2 1-13   
 [13] kaho HH 879-G-2 x 879-10-1 32-1   kaho HH 879-2-2 x 879-N-5 3-9    
 [15] kaho HH 879-2-2 x 794-2 4-18      kaho HH 879-2-2 x 879-N-5 3-7    
 [17] kaho HH 866-2 x 879-2-2 89-6      kaho HH 879-2-2 x 879-10-1 2-13  
 [19] kaho HH 879-2-2 x 879-N-5 3-15    kaho HH 879-10-1 x 879-N-5 18-1  
 [21] kaho HH 794-2 x 794-4 63-11       kaho HH 794-2 x 794-4 63-10      
 [23] kaho HH 794-4 x 879-10-1 75-14    kaho HH 794-4 x 866-2 79-3       
 [25] hookeri WK 2 Cutting 2            hookeri WK 2E-1 NA               
 [27] hookeri WK Loc 2 Clone 1          hookeri WK 2 Clone 1             
 [29] hookeri WK Loc 2 Clone 2          hookeri WK 3-11 -                
 [31] hookeri WK 4 NA                   hookeri WK 3-3 Cutting ?         
 [33] hookeri WK Loc 2 Clone 2          hookeri WK 3-11 -                
 [35] hookeri WK 2 Clone 1              hookeri WK Loc 2 -               
 [37] kaho HK 794-4 x 904-2 84-2        kaho HK 899-2E- 1 x 904-5 105-12 
 [39] kaho HK 866-2 x 904-5 98-17       kaho HK 866-2 x 892-4 95-2       
 [41] kaho HK 899-2E- 1 x 3587-14 106-1 kaho HK 879-2-2 x 904-2 10-4     
 [43] kaho HK 794-4 x 892-3 81-5        kaho HK 866-2 x 3587-14 100-1    
 [45] kaho HK 879-10-1 x 3587-15 29-8   kaho HK 879-10-1 x 892-4 24-6    
 [47] kaho HK 794-4 x 904-5 85-4        kaho HK 879-G-2 x 904-5 39-5     
 [49] kaho HK 879-10-1 x 3587-15 29-8C  kaho HK 879-10-1 x 3587-C 30-2   
 [51] kaho HK 879-10-1 x 3587-C 30-2    kaho HK 879-10-1 x 3587-C 30-2   
 [53] kaho HK 879-10-1 x 3587-C 30-2    kaho HK 866-2 x 892-1 94-10      
 [55] kaho HK 794-4 x 904-5 85-4        kaho HK 794-2 x 892-1 66-14      
 [57] kaho HK 794-4 x 892-3 81-5        kaho HK 879-10-1 x 3587-C 30-2   
 [59] kaho HK 879-10-1 x 3587-C 30-2    kaho HK 794-2 x 3587-7 71-3      
 [61] kaho HK 899-2E- 1 x 3587-14 106-7 kaho HK 879-G-2 x 904-5 39-1     
 [63] kaho HK 866-2 x 904-5 98-2        kaho HK 866-2 x 892-1 94-6       
 [65] kaho KH 3587-14 x 866-2 c1 221-1  kaho KH NA 121-3                 
 [67] kaho KH 3587-7 x 879-10-1 189-3   kaho KH 3587-7 x 879-N-5 191-3   
 [69] kaho KH 904-2 x 879-G-2 149-5     kaho KH 3587-7 x 879-10-1 189-3  
 [71] kaho KH 904-5 x 879-10-1 172-2    kaho KH 3587-7 x 794-4 192-2     
 [73] kaho KH 904-5 x 794-2 175-3       kaho KH 3587-7 x 794-4 192-1     
 [75] kaho KH 904-3 x 899-2E- 1 165-1   kaho KH 904-2 x 879-2-2 147-3    
 [77] kaho KH 904-2 x 879-G-2 149-6     kaalae 3587WP 3 Clone 1          
 [79] kaalae 3587WP 10 -                kaalae 3587WP 7 -                
 [81] kaalae 3587WP 3 -                 kaalae 881KHV 2 Self 5           
 [83] kaalae 881KHV 2 Self 4            kaalae 881KHV 2 Self 8           
 [85] kaalae 881KHV 2 Self 8            kaalae 892WKG 3 NA               
 [87] kaalae 892WKG 3 NA                kaalae 904WPG 5-A -              
 [89] kaalae 904WPG 2 -                 kaho KK 892-1 x 3587-7 120-1     
 [91] kaho KK 3587-15 x 904-3 218-4     kaho KK 892-1 x 892-4 115-2      
 [93] kaho KK 892-5 x 3587-14 143-4     kaho KK 3587-C x 904-5 235-4     
 [95] kaho KK 904-5 x 904-3 184-5       kaho KK 904-3 x 3587-14 170-2    
 [97] kaho KK 3587-7 x 3587-14 198-16   kaho KK 892-1 x 3587-7 120-1     
 [99] kaho KK 3587-15 x 904-3 218-5     kaho KK 892-5 x 3587-14 143-1    
[101] kaho KK 3587-A x 3587-14 229-1    kaho KK 3587-A x 3587-14 229-3   
[103] kaho KK 3587-15 x 3587-C 221-2    kaho KK 3587-15 x 904-3 218-4    
[105] kaho KK 892-2 x 904-5 121-5       kaho KK 3587-15 x 904-3 218-5    
[107] kaho KK 3587-15 x 904-3 218-4     kaho KK 892-5 x 892-4 140-6      
[109] kaho KK 904-3 x 3587-14 170-3     kaho KK 892-1 x 892-1 108-5      
[111] kaho KK 3587-7 x 3587-14 198-9    kaho KK 904-5 x 904-3 184-18     
[113] kaho KK 904-3 x 904-5 169-16      kaho KK 904-3 x 904-2 168-11     
[115] kaho KK 904-2 x 892-1 155-7      
97 Levels: hookeri 879WKG N-5 - hookeri WK 2 Clone 1 ... kaho KK 904-5 x 904-3 184-5</code></pre>
<pre class="r"><code>volhybn.mean &lt;- volhybn %&gt;% mutate(Sample = svhybn$Sample) %&gt;% 
  left_join(dplyr::select(svhybn, c(Sample, SpeciesR, plants, parents, plantsi))) %&gt;% 
  mutate_if(is.character, as.factor) %&gt;% 
 group_by(SpeciesR, plants, parents, plantsi) %&gt;% summarize_if(is.numeric, mean)

volhybn.mean.vols &lt;- volhybn.mean %&gt;% ungroup %&gt;% select_if(is.numeric)
set.seed(1)
mdshybn.mean &lt;- metaMDS(decostand(volhybn.mean.vols, method=&quot;hellinger&quot;),k=2,try=100, autotransform=F, trace=0)
mdshybn.mean</code></pre>
<pre><code>
Call:
metaMDS(comm = decostand(volhybn.mean.vols, method = &quot;hellinger&quot;),      k = 2, try = 100, autotransform = F, trace = 0) 

global Multidimensional Scaling using monoMDS

Data:     decostand(volhybn.mean.vols, method = &quot;hellinger&quot;) 
Distance: bray 

Dimensions: 2 
Stress:     0.113306 
Stress type 1, weak ties
Best solution was repeated 2 times in 20 tries
The best solution was from try 13 (random start)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on &#39;decostand(volhybn.mean.vols, method = &quot;hellinger&quot;)&#39; </code></pre>
<pre class="r"><code>library(ggpubr)
library(ggvegan)

obj.mean &lt;- fortify(mdshybn.mean)
obj.mean$SpeciesR &lt;- factor(NA,levels=levels(volhybn.mean$SpeciesR)); obj.mean$SpeciesR[obj.mean$score==&quot;sites&quot;] &lt;-  volhybn.mean$SpeciesR
obj.mean$plants &lt;- factor(NA,levels=levels(volhybn.mean$plants)); obj.mean$plants[obj.mean$score==&quot;sites&quot;] &lt;-  volhybn.mean$plants
obj.mean$parents &lt;- factor(NA,levels=levels(volhybn.mean$parents)); obj.mean$parents[obj.mean$score==&quot;sites&quot;] &lt;-  volhybn.mean$parents
obj.mean$occur &lt;- NA; obj.mean$occur[obj.mean$score==&quot;species&quot;] &lt;- colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])
obj.mean$ftotal &lt;- NA; obj.mean$ftotal[obj.mean$score==&quot;species&quot;] &lt;- colSums(fvolhyb[svhyb$DN==&quot;Night&quot;,])
obj.mean &lt;- obj.mean %&gt;% arrange(NMDS2, NMDS1)

(hybplotn.mean.spec &lt;- 
    ggplot(obj.mean, aes(x=NMDS1, y=NMDS2)) + 
    coord_fixed(xlim=range(obj.mean$NMDS1[obj.mean$score==&quot;sites&quot;])+c(-0.55,0.1), 
                ylim=range(obj.mean$NMDS2[obj.mean$score==&quot;sites&quot;])) + 
    theme_pubr()+
    scale_x_continuous(expand=c(0,0))+
    theme(legend.text = element_text(size=13)) + 
    guides(fill = guide_legend(override.aes = list(size=5)), color=guide_legend(override.aes=list(size=3)))+
    scale_fill_manual(&quot;&quot;, values=hybcolr, labels=c(expression(italic(&quot;S. kaalae&quot;)),&quot;K x H&quot;, &quot;H x K&quot;, expression(italic(&quot;S. hookeri&quot;))),  na.translate=F) +
      scale_color_manual(&quot;&quot;,breaks=c(&quot;cross&quot;,&quot;parents&quot;), labels=c(&quot;Cross&quot;,&quot;Clone&quot;), values=c(cross=&quot;grey90&quot;, parents=&quot;grey60&quot;)) +
    geom_path(data=obj.mean[obj.mean$score==&quot;sites&quot;,],aes(group=plants, color=&quot;cross&quot;), size=1) +
    geom_path(data=obj.mean[obj.mean$score==&quot;sites&quot;,],aes(group=parents, color=&quot;parents&quot;), size=1) +
    geom_point(data=obj.mean[obj.mean$score==&quot;sites&quot;,], aes(fill=SpeciesR), shape=21, size=2.5, color=&quot;white&quot;) +
    geom_text(data=obj.mean[obj.mean$score==&quot;species&quot; &amp; obj.mean$ftotal&gt;1.5e4 &amp; obj.mean$occur&gt;nrow(volhybn)*0.20,], aes(label=label), color=&quot;black&quot;,  alpha=1, size=3.8) 
    ) </code></pre>
<p><img src="hybrids_cut_plots/2dnmdsnightmean-1.svg" width="672" /></p>
<pre class="r"><code>ggsave(&quot;output/hybrids/hybnmdsnight3_mean_plant.png&quot;, hybplotn.mean.spec, height=8, width=10)
ggsave(&quot;output/hybrids/hybnmdsnight3_mean_plant.pdf&quot;, hybplotn.mean.spec, height=8, width=10, device=cairo_pdf)</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
