<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="John Powers" />

<meta name="date" content="2024-11-19" />

<title>Floral scent of Schiedea kaalae x hookeri hybrids</title>

<script src="libs/header-attrs-2.26/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/navigation-1.1/codefolding.js"></script>
<link href="libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Floral scent of <em>Schiedea kaalae x
hookeri</em> hybrids</h1>
<h4 class="author"><a href="http://sites.uci.edu/powers/">John
Powers</a></h4>
<h4 class="date">2024-11-19</h4>

</div>


<style type="text/css">
.main-container { max-width: 1600px; margin-left: 0; margin-right: auto; }
img{ max-width:200%; height: auto; }
td, th { padding : 6px }
</style>
<div id="sample-inventory" class="section level1">
<h1>Sample inventory</h1>
<pre class="r"><code>#Load filtered scent data (includes octenol and hexenol) and metadata
load(&quot;./data/UCI_GCMS/sdata3_hexoct.Rdata&quot;) 
#TODO: some red flags in the Notes column - possible wrong IDs</code></pre>
<pre class="r"><code>eve &lt;- -2.5 #hours before sunset

specs &lt;- kaho &lt;- c(&quot;HOOK&quot;, &quot;KAAL&quot;,&quot;KAHO&quot;)
f &lt;- spec %in% specs 
speca &lt;- replace(spec, sv$Population == &quot;KK&quot;, &quot;KAAL&quot;); speca &lt;- replace(speca, sv$Population == &quot;HH&quot;, &quot;HOOK&quot;)
specp &lt;- factor(speca[f], levels=c(&quot;HOOK&quot;,&quot;KAHO&quot;,&quot;KAAL&quot;))#REORDER

kahomp &lt;- data.frame(Plant=as.character(sv[sv$Species == &quot;kaho&quot;,&quot;Plant&quot;]), stringsAsFactors = F)
kahomp &lt;- reshape2::colsplit(string=kahomp$Plant, pattern=&quot; x &quot;, names=c(&quot;Maternal&quot;, &quot;Paternal&quot;))
kahopops &lt;- c(&quot;879WKG&quot;, &quot;WK&quot;,&quot;3587WP&quot;,&quot;892WKG&quot;,&quot;904WPG&quot;)
kahomp &lt;- as.data.frame(apply(kahomp, c(1,2), function(x) strsplit(x, &quot;-&quot;)[[1]][1]))
kahomp &lt;- lapply(kahomp, plyr::mapvalues, from = c(&quot;794&quot;,&quot;866&quot;,&quot;891&quot;,&quot;899&quot;,&quot;879&quot;,&quot;892&quot;,&quot;904&quot;,&quot;3587&quot;), to = c(&quot;WK&quot;,&quot;WK&quot;,&quot;WK&quot;,&quot;WK&quot;,&quot;879WKG&quot;,&quot;892WKG&quot;,&quot;904WPG&quot;,&quot;3587WP&quot;))
kahomp &lt;- lapply(kahomp, factor, levels=kahopops)

sv$Population2 &lt;- sv$Population
sv[sv$Species == &quot;kaho&quot;,]$Population2 &lt;- ifelse(kahomp$Maternal==kahomp$Paternal, as.character(kahomp$Maternal), &quot;Interpop&quot;)
sv$Population2 &lt;- factor(sv$Population2)
sv$ftot &lt;- rowSums(vol)/sv$Flrs
sv$SpeciesR &lt;- ifelse(speca==&quot;KAHO&quot;,as.character(sv$Population),as.character(speca)) 
sv$SpeciesR &lt;- factor(sv$SpeciesR, levels=c(&quot;KAAL&quot;,&quot;KH&quot;,&quot;HK&quot;,&quot;HOOK&quot;))
levels(sv$SpeciesR) &lt;- c(&quot;S. kaalae&quot;, &quot;K x H&quot;, &quot;H x K&quot;, &quot;S. hookeri&quot;)
sv$Individual &lt;- with(sv, factor(paste(Species, Population, Plant, Cutting)))

volhyb &lt;- vol[f,]
volhyb &lt;- volhyb[order(as.integer(specp)),]
specp &lt;- sort(specp)
svhyb &lt;- sv[rownames(volhyb),]
volhyb &lt;- volhyb[order(as.integer(specp), svhyb$Population),]
volhyb &lt;- volhyb[,colSums(volhyb)&gt;0]
pavolhyb &lt;- volhyb
pavolhyb[pavolhyb&gt;0] &lt;-1
svolhyb &lt;- decostand(volhyb, &quot;total&quot;)

fvolhyb &lt;- volhyb / svhyb$Flrs

svhyb$Population &lt;- as.factor(svhyb$Population)
svhyb$DN &lt;- factor(ifelse(svhyb$StartSunset &gt; eve, &quot;Night&quot;, &quot;Day&quot;))
svhyb$Inflo[is.na(svhyb$Inflo)]&lt;-1:sum(is.na(svhyb$Inflo))
svhyb$Diurnal[is.na(svhyb$Diurnal)]&lt;-1:sum(is.na(svhyb$Diurnal))
svhyb$plants  &lt;- hybplants  &lt;- paste(svhyb$Population, svhyb$Plant, sep=&quot;-&quot;)
svhyb$plantsi &lt;- hybplantsi &lt;- paste(svhyb$Population, svhyb$Plant, svhyb$Cutting, sep=&quot;-&quot;)
svhyb$parents &lt;- hybplants
svhyb$parents[grepl(&quot; x &quot;, hybplants, fixed=T)]&lt;-1:sum(grepl(&quot; x &quot;, hybplants, fixed=T))#only group by parents, set the crosses to an integer sequence to force them not to group 
#TODO this splits resamples of the sample cross plant into multiple &quot;parents&quot;
#TODO also, NMDS below implies these are different cross parents but they are really just the original plant in the parent generation that was used for cuttings
hybparents &lt;- svhyb$parents
svhyb$Inflo[is.na(svhyb$Inflo)]&lt;-1:sum(is.na(svhyb$Inflo))
svhyb$Diurnal[is.na(svhyb$Diurnal)]&lt;-1:sum(is.na(svhyb$Diurnal))
svhyb$plantsdn &lt;- hybplantsdn &lt;- paste(svhyb$Population, svhyb$Plant, svhyb$Cutting, svhyb$Diurnal, sep=&quot;-&quot;)
svhyb$plantsinflo &lt;- hybplantsinflo &lt;- paste(svhyb$Population, svhyb$Plant, svhyb$Cutting, svhyb$Inflo, sep=&quot;-&quot;)
svhyb$plantsinflodate &lt;- hybplantsinflodate &lt;- paste(svhyb$Population, svhyb$Plant, svhyb$Cutting, svhyb$Inflo, svhyb$SampleDate, sep=&quot;-&quot;)

volhybn &lt;- volhyb[svhyb$DN == &quot;Night&quot;,]
specpn &lt;- specp[svhyb$DN == &quot;Night&quot;]
svolhybn &lt;- decostand(volhybn, &quot;total&quot;)
svhybn &lt;- svhyb[svhyb$DN == &quot;Night&quot;,]
fvolhybn &lt;- volhybn / svhybn$Flrs
specpd &lt;- svhybn$SpeciesR

hybplantsn &lt;- svhybn$plants
hybplantsin &lt;- svhybn$plantsi 
hybparentsn &lt;- svhybn$parents
hybplantsdnn &lt;- svhybn$plantsdn
hybplantsinflon &lt;- svhybn$plantsinflo 
hybplantsinflodaten &lt;- svhybn$plantsinflodate

#hybpops &lt;- c(&quot;3587WP&quot;, &quot;879WKG&quot;, &quot;881KHV&quot;, &quot;892WKG&quot;, &quot;904WPG&quot;, &quot;HH&quot;,    &quot;HK&quot;,     &quot;KH&quot; ,    &quot;KK&quot;  ,   &quot;WK&quot;)
hybpopsp &lt;- c(&quot;K&quot;, &quot;H&quot;, &quot;K&quot;, &quot;K&quot;, &quot;K&quot;, &quot;HH&quot;, &quot;HK&quot;, &quot;KH&quot;, &quot;KK&quot;, &quot;H&quot;)
hybcolr &lt;- setNames(c(brewer.pal(3,&quot;Greens&quot;)[3],brewer.pal(9,&quot;Oranges&quot;)[5], brewer.pal(9,&quot;Set1&quot;)[7], brewer.pal(3,&quot;Purples&quot;)[3]),levels(sv$SpeciesR))
hyblabs &lt;- c(expression(italic(&quot;S. kaalae&quot;)),&quot;K x H&quot;, &quot;H x K&quot;, expression(italic(&quot;S. hookeri&quot;)))</code></pre>
<div id="samples-by-plant-population-or-type-of-hybrid-cross"
class="section level2">
<h2>Samples by plant population or type of hybrid cross</h2>
<pre class="r"><code>inventory &lt;- data.frame(row.names=levels(svhyb$Population), Cross=hybpopsp, 
                        Samples=as.vector(table(svhyb$Population)))[order(hybpopsp), ]
kable(inventory, caption=&quot;samples of each cross and parents&quot;)</code></pre>
<table>
<caption>samples of each cross and parents</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Cross</th>
<th align="right">Samples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">879WKG</td>
<td align="left">H</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">WK</td>
<td align="left">H</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">HH</td>
<td align="left">HH</td>
<td align="right">31</td>
</tr>
<tr class="even">
<td align="left">HK</td>
<td align="left">HK</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="left">3587WP</td>
<td align="left">K</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">881KHV</td>
<td align="left">K</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">892WKG</td>
<td align="left">K</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">904WPG</td>
<td align="left">K</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">KH</td>
<td align="left">KH</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left">KK</td>
<td align="left">KK</td>
<td align="right">29</td>
</tr>
</tbody>
</table>
</div>
<div id="evening-samples-by-cross" class="section level2">
<h2>Evening samples by cross</h2>
<p>crosses and parent samples added on diagonal in the evening</p>
<p>remember to add the 4 881KHV samples (not used to make crosses since
from the Ko’olaus)</p>
<p>there are also two samples without populations (HH and KH)</p>
<pre class="r"><code>kahomp &lt;- data.frame(Plant=svhyb[svhyb$Species == &quot;kaho&quot; &amp; svhyb$StartSunset &gt; eve,&quot;Plant&quot;])#line differs from above - just evening
kahomp &lt;- reshape2::colsplit(string=kahomp$Plant, pattern=&quot; x &quot;, names=c(&quot;Maternal&quot;, &quot;Paternal&quot;))
kahopops &lt;- c(&quot;879WKG&quot;, &quot;WK&quot;,&quot;3587WP&quot;,&quot;892WKG&quot;,&quot;904WPG&quot;)
kahomp &lt;- as.data.frame(apply(kahomp, c(1,2), function(x) strsplit(x, &quot;-&quot;)[[1]][1]))
kahomp &lt;- lapply(kahomp, plyr::mapvalues, from = c(&quot;794&quot;,&quot;866&quot;,&quot;891&quot;,&quot;899&quot;,&quot;879&quot;,&quot;892&quot;,&quot;904&quot;,&quot;3587&quot;), to = c(&quot;WK&quot;,&quot;WK&quot;,&quot;WK&quot;,&quot;WK&quot;,&quot;879WKG&quot;,&quot;892WKG&quot;,&quot;904WPG&quot;,&quot;3587WP&quot;))
kahomp &lt;- lapply(kahomp, factor, levels=kahopops)
tkahomp &lt;- table(kahomp)
(t(lower.tri(tkahomp)*tkahomp)+tkahomp*upper.tri(tkahomp, diag=T))%&gt;%
  kable(caption=&quot;crosses moved to upper triangle&quot;)</code></pre>
<table>
<caption>crosses moved to upper triangle</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">879WKG</th>
<th align="right">WK</th>
<th align="right">3587WP</th>
<th align="right">892WKG</th>
<th align="right">904WPG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">879WKG</td>
<td align="right">9</td>
<td align="right">7</td>
<td align="right">11</td>
<td align="right">1</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">WK</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">7</td>
<td align="right">6</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">3587WP</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">892WKG</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">904WPG</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<pre class="r"><code>mtkahomp &lt;- 6-tkahomp
mtkahomp &lt;- as.data.frame(mtkahomp)

inventory.cross &lt;- tkahomp+diag(table(svhyb$Population[svhyb$StartSunset &gt; eve])[rownames(tkahomp)])
kable(inventory.cross, caption=&quot;samples by population cross&quot;)</code></pre>
<table>
<caption>samples by population cross</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">879WKG</th>
<th align="right">WK</th>
<th align="right">3587WP</th>
<th align="right">892WKG</th>
<th align="right">904WPG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">879WKG</td>
<td align="right">10</td>
<td align="right">2</td>
<td align="right">8</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">WK</td>
<td align="right">5</td>
<td align="right">18</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">3587WP</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">892WKG</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">904WPG</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<pre class="r"><code>write.csv(inventory.cross, &quot;output/hybrids/inventory_cross_parents.csv&quot;)

#how many maternal and paternal parent plants?
mp &lt;- sv %&gt;% filter(Species ==&quot;kaho&quot;) %&gt;% select(Plant) %&gt;% mutate(Plant=as.character(Plant)) %&gt;%
  separate(Plant, sep=&quot; x &quot;, into = c(&quot;Maternal&quot;, &quot;Paternal&quot;)) %&gt;% 
  separate(Maternal, sep=&quot;-&quot;, into = c(&quot;MomPop&quot;, &quot;MomPlant&quot;), remove=F, extra=&quot;merge&quot;) %&gt;% 
  separate(Paternal, sep=&quot;-&quot;, into = c(&quot;DadPop&quot;, &quot;DadPlant&quot;), remove=F, extra=&quot;merge&quot;)

mp %&gt;% group_by(MomPop) %&gt;% summarize(moms=n_distinct(MomPlant)) %&gt;% kable(caption=&quot;maternal plants&quot;)</code></pre>
<table>
<caption>maternal plants</caption>
<thead>
<tr class="header">
<th align="left">MomPop</th>
<th align="right">moms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">3587</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">794</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">866</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">879</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">892</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">899</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">904</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<pre class="r"><code>mp %&gt;% group_by(DadPop) %&gt;% summarize(moms=n_distinct(DadPlant)) %&gt;% kable(caption=&quot;paternal plants&quot;)</code></pre>
<table>
<caption>paternal plants</caption>
<thead>
<tr class="header">
<th align="left">DadPop</th>
<th align="right">moms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">3587</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">794</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">866</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">879</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">892</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">899</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">904</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="resampled-plants" class="section level2">
<h2>Resampled plants</h2>
<p>Some plants were used for more than one sample - day/night or on the
same inflorescence:</p>
<pre class="r"><code>kable(cbind(Plants=table(specp[!duplicated(cbind(specp,hybplantsi))]), 
            table(data.frame(specp,Diurnal=svhyb$DN))), caption=&quot;Plants sampled by type and time&quot;)</code></pre>
<table>
<caption>Plants sampled by type and time</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Plants</th>
<th align="right">Day</th>
<th align="right">Night</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">HOOK</td>
<td align="right">32</td>
<td align="right">8</td>
<td align="right">36</td>
</tr>
<tr class="even">
<td align="left">KAHO</td>
<td align="right">33</td>
<td align="right">1</td>
<td align="right">41</td>
</tr>
<tr class="odd">
<td align="left">KAAL</td>
<td align="right">32</td>
<td align="right">4</td>
<td align="right">38</td>
</tr>
</tbody>
</table>
<pre class="r"><code>kable(cbind(Plants=table(svhybn$SpeciesR[!duplicated(cbind(svhybn$SpeciesR,hybplantsin))]),
            table(data.frame(svhybn$SpeciesR,Diurnal=svhybn$DN))), caption=&quot;Plants sampled at night by type&quot;)</code></pre>
<table>
<caption>Plants sampled at night by type</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Plants</th>
<th align="right">Day</th>
<th align="right">Night</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">S. kaalae</td>
<td align="right">32</td>
<td align="right">0</td>
<td align="right">38</td>
</tr>
<tr class="even">
<td align="left">K x H</td>
<td align="right">12</td>
<td align="right">0</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="left">H x K</td>
<td align="right">21</td>
<td align="right">0</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="left">S. hookeri</td>
<td align="right">32</td>
<td align="right">0</td>
<td align="right">36</td>
</tr>
</tbody>
</table>
<pre class="r"><code># svhybn  %&gt;% group_by(Individual) %&gt;% filter(n()&gt;1) %&gt;% ungroup() %&gt;% #find duplicates
#   dplyr::select(SampleDate, Individual, ftot, Leaves:Flrs) %&gt;% arrange(Individual, SampleDate) %&gt;% 
#   kable(caption=&quot;Multiple samples of same plant&quot;)

print(&quot;Plants that have multiple samples:&quot;)</code></pre>
<pre><code>[1] &quot;Plants that have multiple samples:&quot;</code></pre>
<pre class="r"><code>svhybn %&gt;% select(Individual, Inflo, SampleDate, Notes) %&gt;% group_by(Individual) %&gt;% filter(n()&gt;1) %&gt;%
  arrange(Individual, SampleDate) %&gt;% distinct(Individual) %&gt;% nrow  #%&gt;% print(n=Inf)</code></pre>
<pre><code>[1] 13</code></pre>
<pre class="r"><code>count(svhyb[!duplicated(cbind(specp,hybplantsi)),], Population) %&gt;% kable(caption=&quot;Number of plants by population&quot;)</code></pre>
<table>
<caption>Number of plants by population</caption>
<thead>
<tr class="header">
<th align="left">Population</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">3587WP</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">879WKG</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">881KHV</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">892WKG</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">904WPG</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">HH</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="left">HK</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="left">KH</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">KK</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="left">WK</td>
<td align="right">9</td>
</tr>
</tbody>
</table>
</div>
<div id="evening-plants-by-cross" class="section level2">
<h2>Evening plants by cross</h2>
<p>remember to add the 3 881KHV plants (not used to make crosses since
from the Ko’olaus)</p>
<p>there are also two plants from crosses without populations (HH and
KH) - added these to 879x879 and 892xWK in the inventory</p>
<pre class="r"><code>svhybn.plants &lt;- svhybn %&gt;% group_by(Species, SpeciesR, Population, Plant, Cutting, Individual) %&gt;% summarize_at(vars(ftot), mean)

kahomp.plants &lt;- data.frame(Plant=svhybn.plants[svhybn.plants$Species == &quot;kaho&quot;,&quot;Plant&quot;])
kahomp.plants &lt;- reshape2::colsplit(string=kahomp.plants$Plant, pattern=&quot; x &quot;, names=c(&quot;Maternal&quot;, &quot;Paternal&quot;))
kahomp.plants &lt;- as.data.frame(apply(kahomp.plants, c(1,2), function(x) strsplit(x, &quot;-&quot;)[[1]][1]))
kahomp.plants &lt;- lapply(kahomp.plants, plyr::mapvalues, from = c(&quot;794&quot;,&quot;866&quot;,&quot;891&quot;,&quot;899&quot;,&quot;879&quot;,&quot;892&quot;,&quot;904&quot;,&quot;3587&quot;), to = c(&quot;WK&quot;,&quot;WK&quot;,&quot;WK&quot;,&quot;WK&quot;,&quot;879WKG&quot;,&quot;892WKG&quot;,&quot;904WPG&quot;,&quot;3587WP&quot;))
kahomp.plants &lt;- lapply(kahomp.plants, factor, levels=kahopops)
tkahomp.plants &lt;- table(kahomp.plants)
kable(tkahomp.plants, caption = &quot;Number of plant sampled in the evening, by cross&quot;)</code></pre>
<table>
<caption>Number of plant sampled in the evening, by cross</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">879WKG</th>
<th align="right">WK</th>
<th align="right">3587WP</th>
<th align="right">892WKG</th>
<th align="right">904WPG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">879WKG</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">WK</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">3587WP</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">892WKG</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">904WPG</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<pre class="r"><code>write.csv(tkahomp.plants, &quot;output/hybrids/inventory_cross_plants.csv&quot;)

table(svhybn.plants$Population)[rownames(tkahomp)] %&gt;% kable(caption = &quot;add these parent plants to the diagonal&quot;)</code></pre>
<table>
<caption>add these parent plants to the diagonal</caption>
<thead>
<tr class="header">
<th align="left">Var1</th>
<th align="right">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">879WKG</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">WK</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">3587WP</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">892WKG</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">904WPG</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="sampling-times" class="section level1">
<h1>Sampling times</h1>
<pre class="r"><code>print(&quot;night pumping times, hrs:&quot;)</code></pre>
<pre><code>[1] &quot;night pumping times, hrs:&quot;</code></pre>
<pre class="r"><code>summary(as.numeric(as.difftime(format.POSIXct(svhyb$SampleDateStart[svhyb$DN==&quot;Night&quot;], tz=&quot;GMT+8&quot;, format=&quot;%H:%M&quot;),format=&quot;%H:%M&quot;))) #convert PDT to PST when needed</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  16.40   18.77   19.45   19.30   20.02   21.27 </code></pre>
<pre class="r"><code>print(&quot;night pumping times, hr since sunset:&quot;)</code></pre>
<pre><code>[1] &quot;night pumping times, hr since sunset:&quot;</code></pre>
<pre class="r"><code>summary(as.numeric(svhyb$StartSunset[svhyb$DN==&quot;Night&quot;]))</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 -2.434   1.196   1.895   1.702   2.482   4.545 </code></pre>
</div>
<div id="tables-of-volatiles" class="section level1">
<h1>Tables of volatiles</h1>
<pre class="r"><code>minsamp &lt;- 2
volhyb.cut &lt;- volhyb[,colSums(volhyb&gt;0) &gt;= minsamp]

#tables for parent species only
exclude &lt;-  specp == &quot;KAHO&quot;
volpar &lt;- volhyb.cut[!exclude,]; specpar &lt;- factor(specp[!exclude]); svpar &lt;- svhyb[!exclude,];
parplantsdn &lt;- paste(svpar$Population, svpar$Plant, svpar$Cutting, svpar$Diurnal, sep=&quot;-&quot;)
hybplantsdn &lt;- paste(svhyb$Population, svhyb$Plant, svhyb$Cutting, svhyb$Diurnal, sep=&quot;-&quot;)
volparn &lt;- volpar[svpar$StartSunset &gt; eve,]
svparn &lt;- svpar[svpar$StartSunset &gt; eve,]
svolparn &lt;- decostand(volpar[svpar$StartSunset &gt; eve,], &quot;total&quot;)
specparn &lt;- specpar[svpar$StartSunset &gt; eve]

svdup &lt;- svpar[duplicated(paste(svpar$Individual, svpar$DN)) | duplicated(paste(svpar$Individual, svpar$DN), fromLast=TRUE),]
svdup_diel &lt;- svpar[duplicated(svpar$Individual) | duplicated(svpar$Individual, fromLast=TRUE),]

#mean proportion of peak area (not converted to ng - not very meaningful)
svolhyb.mean &lt;- aggregate(. ~ specp, svolhyb, mean)[,-1]
rownames(svolhyb.mean) &lt;- levels(specp)
tsvolhyb.mean &lt;- as.data.frame(t(svolhyb.mean))
tsvolhyb.chems &lt;- cbind(tsvolhyb.mean, chems[match(rownames(tsvolhyb.mean), chems$Name),])
write.table(tsvolhyb.chems, file=&quot;output/hybrids/tsvolhybchems3.csv&quot;, sep=&quot;\t&quot;, row.names=F)

#mean of nonzero emissions (not very meaningful)
volhybn.mean &lt;- aggregate(. ~ specpn, volhybn, function(x) mean(x[x&gt;0]))[,-1] 
rownames(volhybn.mean) &lt;- levels(specpn)
tvolhybn.mean &lt;- as.data.frame(t(volhybn.mean))

#convert to nanograms using standards for each compound class
#TODO move this to sdata3
chems.pc.class &lt;- read.table(&quot;data/UCI_GCMS/chemspc3_classes.csv&quot;, sep=&quot;\t&quot;, header=T)
multipliers &lt;- read.table(&quot;data/UCI_GCMS/multipliers.csv&quot;, header=T, sep=&quot;\t&quot;)
ngvolhyb &lt;- volhyb * multipliers$ngPerArea[match(chems.pc.class$Class,multipliers$Class)][col(volhyb)]
ngvolhybn &lt;- volhybn * multipliers$ngPerArea[match(chems.pc.class$Class,multipliers$Class)][col(volhybn)]
ngfvolhyb &lt;- ngvolhyb / svhyb$Flrs
ngfvolhybn &lt;- ngvolhybn / svhybn$Flrs
svhybn$ngftot &lt;- rowSums(ngvolhybn)/svhybn$Flrs
ngfvolhybn.mean &lt;- aggregate(. ~ specpn, ngfvolhybn, function(x) mean(x[x&gt;0]))[,-1] #nonzero only !!!
rownames(ngfvolhybn.mean) &lt;- levels(specpn)
tngfvolhybn.mean &lt;- as.data.frame(t(ngfvolhybn.mean))

#proportion of peak areas (not converted to ng - not very meaningful)
volhybn.prop &lt;- aggregate(. ~ specpn, volhybn, function(x) sum(x&gt;0)/length(x))[,-1]
rownames(volhybn.prop) &lt;- levels(specpn)
tvolhybn.prop &lt;- as.data.frame(t(volhybn.prop))

#combine tables for the mean nonzero emissions, nanograms per flower, and proportion of peak areas
tvolhybn.chems &lt;- cbind(tvolhybn.mean, tngfvolhybn.mean, tvolhybn.prop, chems.pc[match(rownames(tvolhybn.mean), chems.pc$Name),])
write.table(tvolhybn.chems, file=&quot;output/hybrids/tvolhybnchems3_evening.csv&quot;, sep=&quot;\t&quot;, row.names=T, col.names = NA)

#mean and SD of total nanograms per flower per hr
(aggregate(rowSums(ngfvolhyb), list(svhyb$SpeciesR,svhyb$DN), function(x) c(mean(x), sd(x))))</code></pre>
<pre><code>     Group.1 Group.2       x.1       x.2
1  S. kaalae     Day  6.284171  4.428269
2      K x H     Day  1.531748        NA
3 S. hookeri     Day 12.533482 12.953003
4  S. kaalae   Night 17.695927 14.051407
5      K x H   Night 20.668768 30.310340
6      H x K   Night 18.206762 19.954865
7 S. hookeri   Night 12.347758 10.056920</code></pre>
<pre class="r"><code>#proportion of evening peak area for both parents
svolparn.mean &lt;- aggregate(. ~ specparn, svolparn, mean)[,-1]
rownames(svolparn.mean) &lt;- levels(specparn)
tsvolparn.mean &lt;- as.data.frame(t(svolparn.mean))
tsvolparn.chems &lt;- cbind(tsvolparn.mean, chems[match(rownames(tsvolparn.mean), chems$Name),])
write.table(tsvolparn.chems, file=&quot;output/hybrids/tsvolparnchems3.csv&quot;, sep=&quot;\t&quot;,  row.names=F)</code></pre>
<pre class="r"><code>#prep GC data for Dryad
ngvolpar &lt;- volpar * multipliers$ngPerArea[match(chems.pc.class$Class,multipliers$Class)][col(volpar)]

svpar %&gt;% select(Filename, SpeciesR, Population2, plantsi, Leaves, Inflor, Mphase, Fphase, Closed, Buds, Temp, StartSunset) %&gt;% dplyr::rename(Species = SpeciesR, Population = Population2, Plant = plantsi, Bracts = Leaves) %&gt;% 
  mutate(StartSunset = round(as.numeric(StartSunset), 2),
         Temp = as.integer(Temp),
         Plant=as.integer(factor(Plant)),
         Species = str_replace(as.character(Species), &quot;S.&quot;, &quot;Schiedea&quot;),
         Population = replace_na(Population, &quot;Interpop&quot;)) %&gt;%
  arrange(Species, Population, Plant, Bracts, Inflor, Mphase, Fphase, Closed, Buds) %&gt;% 
  left_join(ngvolpar %&gt;% rownames_to_column(&quot;Filename&quot;) %&gt;% mutate_if(is.numeric, round, 2)) %&gt;% #volpar has peak areas / hr (not normalized by number of flowers)
  select(-Filename) %&gt;% 
  write_csv(&quot;output/hybrids/Schiedea_GCMS.csv&quot;)</code></pre>
</div>
<div id="total-emissions-and-compound-diversity" class="section level1">
<h1>Total emissions and compound diversity</h1>
<pre class="r"><code>svhybn.plants &lt;- svhybn %&gt;% group_by(SpeciesR, Individual) %&gt;% summarize_at(vars(ngftot), mean)
ftot.medians &lt;- svhybn.plants %&gt;% group_by(SpeciesR) %&gt;% summarize_at(&quot;ngftot&quot;, list( n=length, ngftot=median)) %&gt;% kable(caption=&quot;median emmisions per flower per hour&quot;)

lm.ftot &lt;- lm(ngftot~SpeciesR, data=svhybn) 
print(&quot;test if hybrids are different from arithmetic average of two species:&quot;)</code></pre>
<pre><code>[1] &quot;test if hybrids are different from arithmetic average of two species:&quot;</code></pre>
<pre class="r"><code>lm.ftot %&gt;% multcomp::glht(linfct = multcomp::mcp(SpeciesR=c(&quot;`H x K` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri`== 0&quot;,
                                         &quot;`K x H` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri`== 0&quot;))) %&gt;% 
  summary()</code></pre>
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: User-defined Contrasts


Fit: lm(formula = ngftot ~ SpeciesR, data = svhybn)

Linear Hypotheses:
                                                      Estimate Std. Error
`H x K` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri` == 0    3.185      3.804
`K x H` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri` == 0    5.647      5.156
                                                      t value Pr(&gt;|t|)
`H x K` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri` == 0   0.837    0.639
`K x H` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri` == 0   1.095    0.470
(Adjusted p values reported -- single-step method)</code></pre>
<pre class="r"><code>print(&quot;test if hybrids are different from arithmetic average of two species&quot;)</code></pre>
<pre><code>[1] &quot;test if hybrids are different from arithmetic average of two species&quot;</code></pre>
<pre class="r"><code>lm.ftot %&gt;% multcomp::glht(linfct = multcomp::mcp(SpeciesR=&quot;Tukey&quot;)) %&gt;% summary </code></pre>
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = ngftot ~ SpeciesR, data = svhybn)

Linear Hypotheses:
                            Estimate Std. Error t value Pr(&gt;|t|)
K x H - S. kaalae == 0        2.9728     5.5082   0.540    0.948
H x K - S. kaalae == 0        0.5108     4.2696   0.120    0.999
S. hookeri - S. kaalae == 0  -5.3482     3.9871  -1.341    0.534
H x K - K x H == 0           -2.4620     5.7535  -0.428    0.973
S. hookeri - K x H == 0      -8.3210     5.5471  -1.500    0.436
S. hookeri - H x K == 0      -5.8590     4.3196  -1.356    0.524
(Adjusted p values reported -- single-step method)</code></pre>
</div>
<div id="heatmap" class="section level1">
<h1>Heatmap</h1>
<pre class="r"><code>#1 dimensional NMDS for ordering samples in heatmap
set.seed(1)
mdshybn1 &lt;- metaMDS(decostand(ngvolhybn, method=&quot;hellinger&quot;),k=1,try=200, autotransform=F, trace=0)
srt &lt;- order(svhybn$SpeciesR, -mdshybn1$points, decreasing=T)

#Include volatiles found in at least this many samples
mincount &lt;- 15

callback = function(hc, mat){
    sv = svd(t(mat))$v[,1]
    dend = reorder(as.dendrogram(hc), wts = sv)
    as.hclust(dend)
}
pheatmap(as.matrix(t(ngfvolhybn[,colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])&gt;mincount][srt,]))^(1/3), 
         cluster_cols=F, show_colnames=F,
         clustering_method=&quot;mcquitty&quot;, clustering_distance_rows=&quot;correlation&quot;,
         clustering_callback = function(hc, ...){dendsort(hc, type=&quot;average&quot;)},
         scale=&quot;none&quot;, color=inferno(512),
         annotation_col = data.frame(Species=as.integer(svhybn$SpeciesR)[srt], row.names=rownames(ngfvolhybn)[srt]), 
         annotation_colors = list(Species=hybcolr), 
         gaps_col = which(as.logical(diff(as.integer(svhybn$SpeciesR)[srt]))),
   cellwidth = 3.5, cellheight = 14, fontsize = 10, border_color = NA, legend=F, legend_breaks=NA, annotation_legend=F, cutree_rows=5
)
grid.text(rev(levels(svhyb$SpeciesR))[c(1,4)], x=c(0.165,0.54),y=0.964, gp=gpar(fontsize=10, col=&quot;white&quot;, fontface=4))
grid.text(rev(levels(svhyb$SpeciesR))[c(2,3)], x=c(0.317,0.417),y=0.964, gp=gpar(fontsize=10, col=&quot;white&quot;, fontface=2))</code></pre>
<p><img src="hybrids_cut_plots/heatmap-1.png" width="1008" /></p>
</div>
<div id="boxplots-of-each-volatile" class="section level1">
<h1>Boxplots of each volatile</h1>
<pre class="r"><code>diversity_vars &lt;- c(ngftot = &quot;Total volatile emissions (ng/flr/hr)&quot;, 
                    num_compounds=&quot;Number of compounds&quot;, 
                    shannon=&quot;Shannon diversity index&quot;)
svhybn$num_compounds &lt;- rowSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])
svhybn$shannon &lt;- diversity(volhybn, index=&quot;shannon&quot;)

multiline &lt;- c(&quot;DMNT&quot;=&quot;(3E)-4,8-dimethylnona-1,3,7-triene&quot;,
               &quot;2,2,6-trimethylcyclohexane-\n1,4-dione&quot;=&quot;2,2,6-trimethylcyclohexane-1,4-dione&quot;,
               &quot;4-hydroxy-2,6,6-trimethyl-\n3-oxocyclohexene-\n1-carbaldehyde&quot;=
                 &quot;4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde&quot;)

minprop &lt;- 0.2 #compound must occur in greater than this proportion of evening samples
ngfvolhybn.top &lt;- ngfvolhybn %&gt;% 
  select(where(~sum(.x&gt;0) &gt; length(.x) * minprop)) %&gt;% 
  bind_cols(select(svhybn, Species=SpeciesR, all_of(names(diversity_vars)))) %&gt;% 
  pivot_longer(!Species, names_to=&quot;variable&quot;) %&gt;% 
  mutate(variable = fct_recode(variable, !!!multiline))

#compare mean of hybrid cross directions to mean of parent species
#compare hybrid cross directions to each other
tests.glht &lt;- ngfvolhybn.top %&gt;% group_by(variable) %&gt;% nest() %&gt;% 
  mutate(model = map(data, ~lm(value ~ Species, data=.x)),
         emm = map(model, ~tidy(summary(emmeans(.x, specs=&quot;Species&quot;)))),
         test.direction = map(model, ~tidy(multcomp::glht(.x, linfct = multcomp::mcp(Species=c(&quot;`K x H` - `H x K` == 0&quot;))))),
         test.parmean = map(model, ~tidy(multcomp::glht(.x, linfct = multcomp::mcp(Species=c(&quot;0.5 * `K x H` + 0.5 * `H x K` - 0.5 * `S. kaalae` - 0.5 * `S. hookeri`== 0&quot;))))))

tests.emm &lt;- tests.glht %&gt;% mutate(maximum = map_dbl(data, ~max(.x$value))) %&gt;% 
  select(variable, emm, maximum) %&gt;% unnest(emm)
tests.index &lt;- tests.emm %&gt;% 
  select(variable, Species, maximum, estimate) %&gt;% pivot_wider(names_from=Species, values_from=estimate) %&gt;% 
  mutate(par.mean = (`S. hookeri` + `S. kaalae`)/2,
         hyb.mean = (`K x H`+`H x K`)/2,
         hyb.index = if_else(`S. kaalae`&gt; `S. hookeri`, 
                             (hyb.mean -`S. hookeri`)/ `S. kaalae`, 
                             (hyb.mean -`S. kaalae`)/ `S. hookeri`))
tests.direction &lt;- tests.glht %&gt;% select(variable, test.direction) %&gt;% unnest(test.direction) %&gt;% 
  select(variable, direction.p.value = adj.p.value)
tests.parmean &lt;- tests.glht %&gt;% select(variable, test.parmean) %&gt;% unnest(test.parmean) %&gt;% 
  select(variable, parmean.p.value = adj.p.value)
boxplot.order &lt;- tests.index %&gt;% arrange(-hyb.index) %&gt;% pull(variable)
tests.all &lt;- tests.index %&gt;% left_join(tests.direction) %&gt;% left_join(tests.parmean) %&gt;%
  mutate(variable=factor(variable, levels=boxplot.order))

tests.vols &lt;- tests.all %&gt;% filter(!variable %in% names(diversity_vars)) %&gt;% 
    mutate(across(contains(&quot;p.value&quot;), ~p.adjust(.x, method=&quot;fdr&quot;)))
tests.vols %&gt;% select(-c(maximum, hyb.index)) %&gt;% mutate(variable=str_remove_all(variable, &quot;\n&quot;)) %&gt;% 
  kable(caption = &quot;tests of total emissions and diversity&quot;, digits=3)</code></pre>
<table>
<caption>tests of total emissions and diversity</caption>
<colgroup>
<col width="40%" />
<col width="6%" />
<col width="4%" />
<col width="4%" />
<col width="7%" />
<col width="6%" />
<col width="6%" />
<col width="12%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">variable</th>
<th align="right">S. kaalae</th>
<th align="right">K x H</th>
<th align="right">H x K</th>
<th align="right">S. hookeri</th>
<th align="right">par.mean</th>
<th align="right">hyb.mean</th>
<th align="right">direction.p.value</th>
<th align="right">parmean.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">benzaldehyde</td>
<td align="right">0.076</td>
<td align="right">0.033</td>
<td align="right">0.053</td>
<td align="right">0.227</td>
<td align="right">0.151</td>
<td align="right">0.043</td>
<td align="right">0.671</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">octan-3-one</td>
<td align="right">0.630</td>
<td align="right">1.717</td>
<td align="right">1.433</td>
<td align="right">0.797</td>
<td align="right">0.713</td>
<td align="right">1.575</td>
<td align="right">0.648</td>
<td align="right">0.024</td>
</tr>
<tr class="odd">
<td align="left">4-oxoisophorone</td>
<td align="right">0.130</td>
<td align="right">0.003</td>
<td align="right">0.028</td>
<td align="right">0.000</td>
<td align="right">0.065</td>
<td align="right">0.016</td>
<td align="right">0.494</td>
<td align="right">0.031</td>
</tr>
<tr class="even">
<td align="left">indole</td>
<td align="right">0.002</td>
<td align="right">0.022</td>
<td align="right">0.057</td>
<td align="right">0.122</td>
<td align="right">0.062</td>
<td align="right">0.040</td>
<td align="right">0.456</td>
<td align="right">0.438</td>
</tr>
<tr class="odd">
<td align="left">2-phenylacetaldehyde</td>
<td align="right">0.282</td>
<td align="right">0.002</td>
<td align="right">0.009</td>
<td align="right">0.007</td>
<td align="right">0.145</td>
<td align="right">0.005</td>
<td align="right">0.969</td>
<td align="right">0.161</td>
</tr>
<tr class="even">
<td align="left">methyl 2-aminobenzoate</td>
<td align="right">0.001</td>
<td align="right">0.011</td>
<td align="right">0.011</td>
<td align="right">0.071</td>
<td align="right">0.036</td>
<td align="right">0.011</td>
<td align="right">0.997</td>
<td align="right">0.060</td>
</tr>
<tr class="odd">
<td
align="left">4-hydroxy-2,6,6-trimethyl-3-oxocyclohexene-1-carbaldehyde</td>
<td align="right">0.031</td>
<td align="right">0.000</td>
<td align="right">0.003</td>
<td align="right">0.001</td>
<td align="right">0.016</td>
<td align="right">0.001</td>
<td align="right">0.783</td>
<td align="right">0.016</td>
</tr>
<tr class="even">
<td align="left">DMNT</td>
<td align="right">0.001</td>
<td align="right">0.000</td>
<td align="right">0.010</td>
<td align="right">0.121</td>
<td align="right">0.061</td>
<td align="right">0.005</td>
<td align="right">0.864</td>
<td align="right">0.093</td>
</tr>
<tr class="odd">
<td align="left">2,2,6-trimethylcyclohexane-1,4-dione</td>
<td align="right">0.057</td>
<td align="right">0.000</td>
<td align="right">0.004</td>
<td align="right">0.000</td>
<td align="right">0.028</td>
<td align="right">0.002</td>
<td align="right">0.806</td>
<td align="right">0.007</td>
</tr>
<tr class="even">
<td align="left">propylcyclopropane</td>
<td align="right">0.021</td>
<td align="right">0.001</td>
<td align="right">0.047</td>
<td align="right">0.071</td>
<td align="right">0.046</td>
<td align="right">0.024</td>
<td align="right">0.239</td>
<td align="right">0.350</td>
</tr>
<tr class="odd">
<td align="left">3,5,5-trimethylhex-2-ene</td>
<td align="right">0.003</td>
<td align="right">0.241</td>
<td align="right">0.079</td>
<td align="right">0.153</td>
<td align="right">0.078</td>
<td align="right">0.160</td>
<td align="right">0.059</td>
<td align="right">0.116</td>
</tr>
<tr class="even">
<td align="left">unknown benzenoid</td>
<td align="right">0.003</td>
<td align="right">0.052</td>
<td align="right">0.071</td>
<td align="right">0.273</td>
<td align="right">0.138</td>
<td align="right">0.061</td>
<td align="right">0.807</td>
<td align="right">0.115</td>
</tr>
<tr class="odd">
<td align="left">oct-1-en-3-ol</td>
<td align="right">4.092</td>
<td align="right">8.515</td>
<td align="right">7.897</td>
<td align="right">3.097</td>
<td align="right">3.594</td>
<td align="right">8.206</td>
<td align="right">0.831</td>
<td align="right">0.010</td>
</tr>
<tr class="even">
<td align="left">linalool oxide (pyranoid) ketone</td>
<td align="right">4.528</td>
<td align="right">2.991</td>
<td align="right">3.730</td>
<td align="right">0.110</td>
<td align="right">2.319</td>
<td align="right">3.360</td>
<td align="right">0.437</td>
<td align="right">0.073</td>
</tr>
<tr class="odd">
<td align="left">linalool oxide (pyranoid)</td>
<td align="right">4.054</td>
<td align="right">0.459</td>
<td align="right">0.578</td>
<td align="right">0.008</td>
<td align="right">2.031</td>
<td align="right">0.519</td>
<td align="right">0.875</td>
<td align="right">0.001</td>
</tr>
<tr class="even">
<td align="left">(E)-hex-3-enal</td>
<td align="right">0.000</td>
<td align="right">0.089</td>
<td align="right">0.071</td>
<td align="right">0.354</td>
<td align="right">0.177</td>
<td align="right">0.080</td>
<td align="right">0.835</td>
<td align="right">0.060</td>
</tr>
<tr class="odd">
<td align="left">linalool oxide (furanoid)</td>
<td align="right">2.105</td>
<td align="right">0.286</td>
<td align="right">0.364</td>
<td align="right">0.022</td>
<td align="right">1.064</td>
<td align="right">0.325</td>
<td align="right">0.812</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">hexanal</td>
<td align="right">0.586</td>
<td align="right">0.567</td>
<td align="right">0.591</td>
<td align="right">1.013</td>
<td align="right">0.800</td>
<td align="right">0.579</td>
<td align="right">0.920</td>
<td align="right">0.142</td>
</tr>
<tr class="odd">
<td align="left">(E)-hex-2-enal</td>
<td align="right">0.000</td>
<td align="right">0.038</td>
<td align="right">0.063</td>
<td align="right">0.284</td>
<td align="right">0.142</td>
<td align="right">0.051</td>
<td align="right">0.625</td>
<td align="right">0.003</td>
</tr>
<tr class="even">
<td align="left">linalool</td>
<td align="right">0.031</td>
<td align="right">0.022</td>
<td align="right">0.001</td>
<td align="right">0.021</td>
<td align="right">0.026</td>
<td align="right">0.011</td>
<td align="right">0.271</td>
<td align="right">0.206</td>
</tr>
<tr class="odd">
<td align="left">(Z)-hex-3-en-1-ol</td>
<td align="right">0.047</td>
<td align="right">4.303</td>
<td align="right">2.163</td>
<td align="right">3.779</td>
<td align="right">1.913</td>
<td align="right">3.233</td>
<td align="right">0.141</td>
<td align="right">0.136</td>
</tr>
<tr class="even">
<td align="left">heptane-2,3-dione</td>
<td align="right">0.004</td>
<td align="right">0.145</td>
<td align="right">0.308</td>
<td align="right">0.312</td>
<td align="right">0.158</td>
<td align="right">0.227</td>
<td align="right">0.181</td>
<td align="right">0.352</td>
</tr>
<tr class="odd">
<td align="left">α-phellandrene</td>
<td align="right">0.369</td>
<td align="right">0.051</td>
<td align="right">0.018</td>
<td align="right">0.028</td>
<td align="right">0.198</td>
<td align="right">0.035</td>
<td align="right">0.775</td>
<td align="right">0.022</td>
</tr>
<tr class="even">
<td align="left">p-cymene</td>
<td align="right">0.094</td>
<td align="right">0.007</td>
<td align="right">0.006</td>
<td align="right">0.025</td>
<td align="right">0.060</td>
<td align="right">0.007</td>
<td align="right">0.969</td>
<td align="right">0.018</td>
</tr>
</tbody>
</table>
<pre class="r"><code>emm.vols &lt;- tests.emm %&gt;% filter(!variable %in% names(diversity_vars)) 

signif.num &lt;- function(x) {
   cut(x, breaks = c(0, 0.001, 0.01, 0.05, 1), 
           labels = c(&quot;***&quot;, &quot;**&quot;, &quot;*&quot;, &quot; &quot;), include.lowest = T)
}
ngfvolhybn.top %&gt;% mutate(variable=factor(variable, levels=boxplot.order)) %&gt;% 
  filter(!variable %in% names(diversity_vars)) %&gt;% 
  ggplot() +  geom_boxplot(aes(x=Species, y=value, color=Species), width=0.5, outlier.size=1) + 
  geom_text(data=tests.vols, aes(label=signif.num(parmean.p.value), x=2.5, y=pmax(par.mean,hyb.mean)*1.5)) + 
  geom_point(data=emm.vols, aes(x=Species, y=pmax(estimate,0), color=Species), shape=4, size=2)+
  geom_point(data=tests.vols, aes(x=2.5, y=par.mean, shape=&quot;parmean&quot;), size=2)+
  geom_point(data=tests.vols, aes(x=2.5, y=hyb.mean, shape=&quot;hybmean&quot;), size=2)+
  scale_shape_manual(&quot;Mean&quot;,values=c(parmean=3, hybmean=5), labels=c(parmean=&quot;Species&quot;, hybmean=&quot;Hybrids&quot;))+
  facet_wrap(vars(variable), scales=&quot;free_y&quot;, ncol=4, labeller = labeller(variable = label_wrap_gen(18))) +
  scale_color_manual(&quot;&quot;, values=hybcolr, labels=hyblabs) +
  scale_y_sqrt(&quot;Emission rate (ng/flower/hr)&quot;, limits=c(0,NA)) + theme_minimal() + 
  theme(axis.text.x=element_blank(), axis.title.x=element_blank(), 
        panel.grid.major.x=element_blank(), panel.grid.minor.y=element_blank(), legend.position = &quot;top&quot;)</code></pre>
<p><img src="hybrids_cut_plots/boxplots-1.svg" width="864" /></p>
</div>
<div id="total-emissions-and-diversity" class="section level1">
<h1>Total emissions and diversity</h1>
<pre class="r"><code>tests.diversity &lt;- tests.all %&gt;% filter(variable %in% names(diversity_vars)) %&gt;% 
    mutate(across(contains(&quot;p.value&quot;), ~p.adjust(.x, method=&quot;fdr&quot;))) 
tests.diversity %&gt;% select(-c(maximum, hyb.index)) %&gt;% kable(caption = &quot;tests of total emissions and diversity&quot;, digits=3)</code></pre>
<table>
<caption>tests of total emissions and diversity</caption>
<colgroup>
<col width="13%" />
<col width="9%" />
<col width="6%" />
<col width="6%" />
<col width="10%" />
<col width="8%" />
<col width="8%" />
<col width="17%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">variable</th>
<th align="right">S. kaalae</th>
<th align="right">K x H</th>
<th align="right">H x K</th>
<th align="right">S. hookeri</th>
<th align="right">par.mean</th>
<th align="right">hyb.mean</th>
<th align="right">direction.p.value</th>
<th align="right">parmean.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ngftot</td>
<td align="right">17.696</td>
<td align="right">20.669</td>
<td align="right">18.207</td>
<td align="right">12.348</td>
<td align="right">15.022</td>
<td align="right">19.438</td>
<td align="right">0.670</td>
<td align="right">0.210</td>
</tr>
<tr class="even">
<td align="left">num_compounds</td>
<td align="right">17.474</td>
<td align="right">16.615</td>
<td align="right">19.250</td>
<td align="right">18.917</td>
<td align="right">18.195</td>
<td align="right">17.933</td>
<td align="right">0.025</td>
<td align="right">0.710</td>
</tr>
<tr class="odd">
<td align="left">shannon</td>
<td align="right">1.574</td>
<td align="right">1.645</td>
<td align="right">1.697</td>
<td align="right">2.084</td>
<td align="right">1.829</td>
<td align="right">1.671</td>
<td align="right">0.560</td>
<td align="right">0.005</td>
</tr>
</tbody>
</table>
<pre class="r"><code>emm.diversity &lt;- tests.emm %&gt;% filter(variable %in% names(diversity_vars)) 

ngfvolhybn.top %&gt;% filter(variable %in% names(diversity_vars)) %&gt;% 
  ggplot() +  geom_boxplot(aes(x=Species, y=value, color=Species), width=0.5, outlier.size=1) + 
  geom_text(data=tests.diversity, aes(label=signif.num(parmean.p.value), x=2.5, y=pmax(par.mean,hyb.mean)*1.1)) + 
  geom_point(data=emm.diversity, aes(x=Species, y=pmax(estimate,0), color=Species), shape=4, size=2)+
  geom_point(data=tests.diversity, aes(x=2.5, y=par.mean, shape=&quot;parmean&quot;), size=2)+
  geom_point(data=tests.diversity, aes(x=2.5, y=hyb.mean, shape=&quot;hybmean&quot;), size=2)+
  scale_shape_manual(&quot;Mean&quot;,values=c(parmean=3, hybmean=5), labels=c(parmean=&quot;Species&quot;, hybmean=&quot;Hybrids&quot;))+
  facet_wrap(vars(variable), scales=&quot;free_y&quot;, ncol=4, labeller = as_labeller(diversity_vars)) +
  scale_color_manual(&quot;&quot;, values=hybcolr, labels=hyblabs) + 
  scale_y_continuous(&quot;&quot;, limits=c(0,NA)) + theme_minimal() + 
  theme(axis.text.x=element_blank(), axis.title.x=element_blank(), 
        panel.grid.major.x=element_blank(), panel.grid.minor.y=element_blank(), legend.position = &quot;top&quot;)</code></pre>
<p><img src="hybrids_cut_plots/diversity-1.svg" width="624" /></p>
</div>
<div id="nmds-ordination" class="section level1">
<h1>NMDS ordination</h1>
<div id="each-sample-includes-resamples" class="section level2">
<h2>Each sample (includes resamples)</h2>
<pre class="r"><code>set.seed(1)
mdshybn &lt;- metaMDS(decostand(volhybn, method=&quot;hellinger&quot;),k=2,try=200, autotransform=F, trace=0)
mdshybn</code></pre>
<pre><code>
Call:
metaMDS(comm = decostand(volhybn, method = &quot;hellinger&quot;), k = 2,      try = 200, autotransform = F, trace = 0) 

global Multidimensional Scaling using monoMDS

Data:     decostand(volhybn, method = &quot;hellinger&quot;) 
Distance: bray 

Dimensions: 2 
Stress:     0.1235848 
Stress type 1, weak ties
Best solution was not repeated after 20 tries
The best solution was from try 0 (metric scaling or null solution)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on &#39;decostand(volhybn, method = &quot;hellinger&quot;)&#39; </code></pre>
<pre class="r"><code>hullcross &lt;- gg_ordiplot(mdshybn, groups = as.factor(hybplantsn), plot=F)$df_hull
hullparents &lt;- gg_ordiplot(mdshybn, groups = as.factor(hybparentsn), plot=F)$df_hull
hullplantsi &lt;- gg_ordiplot(mdshybn, groups = as.factor(hybplantsin), plot=F)$df_hull
hullplantsinflo &lt;- gg_ordiplot(mdshybn, groups = as.factor(hybplantsinflon), plot=F)$df_hull
hullplantsinflodate &lt;- gg_ordiplot(mdshybn, groups = as.factor(hybplantsinflodaten), plot=F)$df_hull

obj &lt;- fortify(mdshybn)
obj$Sample &lt;- NA; obj$Sample[obj$score==&quot;sites&quot;] &lt;-  svhybn$Sample
obj &lt;- obj %&gt;% left_join(svhybn %&gt;% dplyr::select(c(Sample, SpeciesR, plants, parents, plantsi, plantsinflo, plantsinflodate, StartSunset))) %&gt;% mutate(StartSunset = as.numeric(StartSunset))
obj$occur &lt;- NA; obj$occur[obj$score==&quot;species&quot;] &lt;- colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])
obj$ftotal &lt;- NA; obj$ftotal[obj$score==&quot;species&quot;] &lt;- colSums(fvolhyb[svhyb$DN==&quot;Night&quot;,])
obj &lt;- obj %&gt;% arrange(NMDS2, NMDS1)

hybnplot &lt;- ggplot(obj, aes(x=-NMDS1, y=NMDS2)) + 
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=plants, color=&quot;cross&quot;), linewidth=1) +
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=parents, color=&quot;parents&quot;), linewidth=1) +
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=plantsi, color=&quot;plantsi&quot;), linewidth=1) +
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=plantsinflo, color=&quot;plantsinflo&quot;), linewidth=1) +
    geom_path(data=filter(obj, score==&quot;sites&quot;),aes(group=plantsinflodate, color=&quot;plantsinflodate&quot;), linewidth=1) +
  scale_color_manual(&quot;&quot;,breaks=c(&quot;cross&quot;,&quot;parents&quot;,&quot;plantsi&quot;,&quot;plantsinflo&quot;,&quot;plantsinflodate&quot;), labels=c(&quot;Cross&quot;,&quot;Clone&quot;,&quot;Plant&quot;,&quot;Inflorescence&quot;,&quot;Bag&quot;), values=c(cross=&quot;grey90&quot;, parents=&quot;grey60&quot;, plantsi=&quot;grey30&quot;, plantsinflo=brewer.pal(6,&quot;Set1&quot;)[6],plantsinflodate=brewer.pal(6,&quot;Set1&quot;)[1],sites=&quot;white&quot;,species=NA)) +
      coord_fixed(xlim=range(obj$NMDS1[obj$score==&quot;sites&quot;])+c(-0.35,0.45), 
                  ylim=range(obj$NMDS2[obj$score==&quot;sites&quot;])) + theme_pubr()+
    scale_x_continuous(expand=c(0,0)) +
    theme(legend.text = element_text(size=13)) + 
    guides(fill = guide_legend(override.aes = list(size=6)), color=guide_legend(override.aes=list(size=3)))

(hybplotn.spec &lt;- hybnplot + 
        scale_fill_manual(&quot;&quot;, values=hybcolr, labels=hyblabs,  na.translate=F) +
  geom_point(data=obj[obj$score==&quot;sites&quot;,], aes(fill=SpeciesR), shape=21, size=3, color=&quot;white&quot;) +
    geom_text(data=obj[obj$score==&quot;species&quot; &amp; obj$ftotal&gt;1.5e4 &amp; obj$occur&gt;nrow(volhybn)*0.20,], aes(label=label), color=&quot;black&quot;, size=3.8) ) </code></pre>
<p><img src="hybrids_cut_plots/2dnmdsnight-1.svg" width="1008" /></p>
</div>
<div id="mean-of-each-plant" class="section level2">
<h2>Mean of each plant</h2>
<pre class="r"><code>volhybn.mean &lt;- volhybn %&gt;% mutate(Sample = svhybn$Sample) %&gt;% 
  left_join(dplyr::select(svhybn, c(Sample, SpeciesR, plants, parents, plantsi))) %&gt;% 
  mutate_if(is.character, as.factor) %&gt;% 
 group_by(SpeciesR, plants, plantsi) %&gt;% summarize_if(is.numeric, mean) 
#TODO temporarily got rid of parents since it was splitting multiple inflos on same plant
#TODO should take the mean by plant before most analyses

volhybn.mean.vols &lt;- volhybn.mean %&gt;% ungroup %&gt;% select_if(is.numeric)
set.seed(1)
mdshybn.mean &lt;- metaMDS(decostand(volhybn.mean.vols, method=&quot;hellinger&quot;),k=2,try=100, autotransform=F, trace=0)
mdshybn.mean</code></pre>
<pre><code>
Call:
metaMDS(comm = decostand(volhybn.mean.vols, method = &quot;hellinger&quot;),      k = 2, try = 100, autotransform = F, trace = 0) 

global Multidimensional Scaling using monoMDS

Data:     decostand(volhybn.mean.vols, method = &quot;hellinger&quot;) 
Distance: bray 

Dimensions: 2 
Stress:     0.1219329 
Stress type 1, weak ties
Best solution was repeated 1 time in 20 tries
The best solution was from try 9 (random start)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on &#39;decostand(volhybn.mean.vols, method = &quot;hellinger&quot;)&#39; </code></pre>
<pre class="r"><code>obj.mean &lt;- fortify(mdshybn.mean)
obj.mean$SpeciesR &lt;- factor(NA,levels=levels(volhybn.mean$SpeciesR)); obj.mean$SpeciesR[obj.mean$score==&quot;sites&quot;] &lt;-  volhybn.mean$SpeciesR
obj.mean$plants &lt;- factor(NA,levels=levels(volhybn.mean$plants)); obj.mean$plants[obj.mean$score==&quot;sites&quot;] &lt;-  volhybn.mean$plants
#obj.mean$parents &lt;- factor(NA,levels=levels(volhybn.mean$parents)); obj.mean$parents[obj.mean$score==&quot;sites&quot;] &lt;-  volhybn.mean$parents
obj.mean$occur &lt;- NA; obj.mean$occur[obj.mean$score==&quot;species&quot;] &lt;- colSums(pavolhyb[svhyb$DN==&quot;Night&quot;,])
obj.mean$ftotal &lt;- NA; obj.mean$ftotal[obj.mean$score==&quot;species&quot;] &lt;- colSums(fvolhyb[svhyb$DN==&quot;Night&quot;,])
obj.mean &lt;- obj.mean %&gt;% arrange(NMDS2, NMDS1)

(hybplotn.mean.spec &lt;- 
    ggplot(obj.mean, aes(x=NMDS1, y=NMDS2)) + 
    coord_fixed(xlim=range(obj.mean$NMDS1[obj.mean$score==&quot;sites&quot;])+c(-0.55,0.1), 
                ylim=range(obj.mean$NMDS2[obj.mean$score==&quot;sites&quot;])) + 
    theme_pubr()+
    scale_x_continuous(expand=c(0,0))+
    theme(legend.text = element_text(size=13)) + 
    guides(fill = guide_legend(override.aes = list(size=5)), color=guide_legend(override.aes=list(size=3)))+
    scale_fill_manual(&quot;&quot;, values=hybcolr, labels=hyblabs,  na.translate=F) +
      scale_color_manual(&quot;&quot;,breaks=c(&quot;cross&quot;,&quot;parents&quot;), labels=c(&quot;Cross&quot;,&quot;Clone&quot;), values=c(cross=&quot;grey90&quot;, parents=&quot;grey60&quot;)) +
    geom_path(data=obj.mean[obj.mean$score==&quot;sites&quot;,],aes(group=plants, color=&quot;cross&quot;), size=1) +
    #geom_path(data=obj.mean[obj.mean$score==&quot;sites&quot;,],aes(group=parents, color=&quot;parents&quot;), size=1) +
    geom_point(data=obj.mean[obj.mean$score==&quot;sites&quot;,], aes(fill=SpeciesR), shape=21, size=2.5, color=&quot;white&quot;) +
    geom_text(data=obj.mean[obj.mean$score==&quot;species&quot; &amp; obj.mean$ftotal&gt;1.5e4 &amp; obj.mean$occur&gt;nrow(volhybn)*0.20,], aes(label=label), color=&quot;black&quot;,  alpha=1, size=3.8) 
    ) </code></pre>
<p><img src="hybrids_cut_plots/2dnmdsnightmean-1.svg" width="1008" /></p>
</div>
</div>
<div id="variation-at-different-levels" class="section level1">
<h1>Variation at different levels</h1>
<div id="variation-among-infloresences-within-plants"
class="section level2">
<h2>Variation among infloresences within plants</h2>
<p>To measure between-trap variation, two traps were inserted into one
bag, for two bags enclosing two infloresences on one plant (four traps
total). Average them to get a dataset of unique infloresences.</p>
<pre class="r"><code>volhybn.inflo &lt;- volhybn %&gt;% mutate(Sample = svhybn$Sample) %&gt;% 
  left_join(dplyr::select(svhybn, c(Sample, SpeciesR, plants, parents, plantsi, Inflo, SampleDate))) %&gt;% 
  mutate_if(is.character, as.factor) %&gt;% 
 group_by(SpeciesR, plants, plantsi, Inflo, SampleDate) %&gt;% #Inflos are marked by a letter but those are reused arbitrarily  across dates
  summarize_if(is.numeric, mean)
volhybn.inflo.vols &lt;- volhybn.inflo %&gt;% ungroup %&gt;% select_if(is.numeric)

bd.plantsi.inflo &lt;-  betadisper(vegdist(decostand(volhybn.inflo.vols, method=&quot;hellinger&quot;), method=&quot;bray&quot;), 
                           group = volhybn.inflo$plantsi)
meandist.plantsi.inflo &lt;- bd.plantsi.inflo$group.distances %&gt;% enframe(name=&quot;plantsi&quot;, value=&quot;centroid_dist&quot;) %&gt;%
  left_join(count(svhybn, plantsi)) %&gt;% filter(n&gt;1)#plants with resamples
summary(meandist.plantsi.inflo$centroid_dist)</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0941  0.1036  0.1351  0.1653  0.1758  0.3835 </code></pre>
</div>
<div id="variation-among-plants-in-each-cross-type"
class="section level2">
<h2>Variation among plants in each cross type</h2>
<pre class="r"><code>#betadisper(vegdist(decostand(volhybn, method=&quot;hellinger&quot;), method=&quot;bray&quot;), group = specpn) #sample level
(bd.SpeciesR &lt;- betadisper(vegdist(decostand(volhybn.mean.vols, method=&quot;hellinger&quot;), method=&quot;bray&quot;), 
                           group = volhybn.mean$SpeciesR))</code></pre>
<pre><code>
    Homogeneity of multivariate dispersions

Call: betadisper(d = vegdist(decostand(volhybn.mean.vols, method =
&quot;hellinger&quot;), method = &quot;bray&quot;), group = volhybn.mean$SpeciesR)

No. of Positive Eigenvalues: 51
No. of Negative Eigenvalues: 45

Average distance to median:
 S. kaalae      K x H      H x K S. hookeri 
    0.1932     0.2096     0.2179     0.3445 

Eigenvalues for PCoA axes:
(Showing 8 of 96 eigenvalues)
 PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 
7.1191 2.2186 1.1110 0.8133 0.6306 0.5209 0.4597 0.3559 </code></pre>
<pre class="r"><code>anova(bd.SpeciesR)</code></pre>
<pre><code>Analysis of Variance Table

Response: Distances
          Df  Sum Sq  Mean Sq F value    Pr(&gt;F)    
Groups     3 0.43035 0.143451  25.425 4.236e-12 ***
Residuals 93 0.52472 0.005642                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>TukeyHSD(bd.SpeciesR)</code></pre>
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = distances ~ group, data = df)

$group
                            diff         lwr        upr     p adj
K x H-S. kaalae      0.016373023 -0.05014464 0.08289069 0.9174067
H x K-S. kaalae      0.024677537 -0.03050854 0.07986362 0.6472894
S. hookeri-S. kaalae 0.151314269  0.10218772 0.20044082 0.0000000
H x K-K x H          0.008304514 -0.06280586 0.07941489 0.9900399
S. hookeri-K x H     0.134941245  0.06842358 0.20145891 0.0000045
S. hookeri-H x K     0.126636732  0.07145065 0.18182281 0.0000002</code></pre>
<pre class="r"><code>tibble(group=bd.SpeciesR$group, distance = bd.SpeciesR$distances) %&gt;% 
  bind_rows(bd.plantsi.inflo$distances %&gt;% enframe(value=&quot;distance&quot;) %&gt;% filter(distance!=0) %&gt;% mutate(group=&quot;within&quot;)) %&gt;%
  mutate(group = fct_relevel(group, c(levels(sv$SpeciesR), &quot;within&quot;))) %&gt;% 
  ggplot(aes(x=group, y=distance, color=group)) +
  geom_boxplot(outlier.shape = NA) + geom_jitter(width=0.15, height=0) + geom_vline(xintercept = 4.5) + 
  scale_color_manual(values=hybcolr, guide=&quot;none&quot;) + 
  scale_y_continuous(limits=c(0,NA), expand = expansion(c(0,0.05))) + scale_x_discrete(labels=c(hyblabs, &quot;Within plant&quot;)) + 
  theme_classic() + theme(axis.title.x=element_blank(), axis.ticks.x=element_blank()) + labs(y=&quot;Bray-Curtis distance to centroid&quot;) </code></pre>
<p><img src="hybrids_cut_plots/amongplant-1.svg" width="480" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
